<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Content Security Policy Level 3 日本語訳</title>
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     -> <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure);  }
 *        .example::before { content: "Example " counter(example); }
 *        .issue::before   { content: "Issue "   counter(issue);   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

	div.head .logo {
		float: right;
		margin: 0;
	}

	@media screen {
		div.head .logo > a {
			display: inline-block;
			margin: 0.4rem 0 0.2rem .4rem;
		}

		div.head img[src*="logos/W3C"] {
			display: block;
			border: solid #1a5e9a;
			border-width: .65rem .7rem .6rem;
			border-radius: .4rem;
			background: #1a5e9a;
			color: white;
			font-weight: bold;
		}

		div.head a:hover > img[src*="logos/W3C"],
		div.head a:focus > img[src*="logos/W3C"] {
			background: #457cad;
			border-color: #457cad;
		}

		div.head a:active > img[src*="logos/W3C"] {
			background: #c00;
			border-color: #c00;
		}
	}


	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head > p:first-child > a {
		border: none;
		text-decoration: none;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue); } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example); } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		width: 100%;
		border: hidden;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1em;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-style:  italic; }
	.toc > li li li li    { font-style:  normal; }
	.toc > li li li li li { font-style:  italic;
	                        font-size:   85%;    }

	.toc > li             { margin: 1.5em 0;     }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2em;
	                        margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	:not(li) > .toc {
		margin-left: 5em;
	}

	.toc .secno {
		float: left;
		width: 4em;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; -webkit-columns: 15em; -moz-columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}

/******************************************************************************/
/*                                  Bikeshed                                  */
/******************************************************************************/

	/* Style for paragraphs I know are in MD-genned lists */
	/* This is a weird hack for me not yet following the commonmark spec
	   regarding paragraph and lists. */
	[data-md] > :first-child {
		margin-top: 0;
	}
	[data-md] > :last-child {
		margin-bottom: 0;
	}

/** Inline CSS fragments ******************************************************/

	.css.css, .property.property, .descriptor.descriptor {
		color: #005a9c;
		font-size: inherit;
		font-family: inherit;
	}
	.css::before, .property::before, .descriptor::before {
		content: "‘";
	}
	.css::after, .property::after, .descriptor::after {
		content: "’";
	}
	.property, .descriptor {
		/* Don't wrap property and descriptor names */
		white-space: nowrap;
	}
	.type { /* CSS value <type> */
		font-style: italic;
	}
	pre .property::before, pre .property::after {
		content: "";
	}

/** Autolinks produced using Bikeshed *****************************************/

	[data-link-type="property"]::before,
	[data-link-type="propdesc"]::before,
	[data-link-type="descriptor"]::before,
	[data-link-type="value"]::before,
	[data-link-type="function"]::before,
	[data-link-type="at-rule"]::before,
	[data-link-type="selector"]::before,
	[data-link-type="maybe"]::before {
		content: "‘";
	}
	[data-link-type="property"]::after,
	[data-link-type="propdesc"]::after,
	[data-link-type="descriptor"]::after,
	[data-link-type="value"]::after,
	[data-link-type="function"]::after,
	[data-link-type="at-rule"]::after,
	[data-link-type="selector"]::after,
	[data-link-type="maybe"]::after {
		content: "’";
	}

	[data-link-type].production::before,
	[data-link-type].production::after,
	.prod [data-link-type]::before,
	.prod [data-link-type]::after {
		content: "";
	}

	[data-link-type=element],
	[data-link-type=element-attr] {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
		font-size: .9em;
	}
	[data-link-type=element]::before { content: "<" }
	[data-link-type=element]::after  { content: ">" }

	[data-link-type=biblio] {
		white-space: pre;
	}

/** Self-Links ****************************************************************/
/* Auto-generated links from an element to its own anchor, for usability */

	.heading, .issue, .note, .example, li, dt {
		position: relative;
	}
	a.self-link {
		position: absolute;
		top: 0;
		left: calc(-1 * (3.5rem - 26px));
		width: calc(3.5rem - 26px);
		height: 2em;
		text-align: center;
		border: none;
		transition: opacity .2s;
		opacity: .5;
	}
	a.self-link:hover {
		opacity: 1;
	}
	.heading > a.self-link {
		font-size: 83%;
	}
	dfn > a.self-link {
		top: auto;
		left: auto;
		opacity: 0;
		width: 1.5em;
		height: 1.5em;
		background: gray;
		color: white;
		font-style: normal;
		transition: opacity .2s, background-color .2s, color .2s;
	}
	dfn:hover > a.self-link {
		opacity: 1;
	}
	dfn > a.self-link:hover {
		color: black;
	}

	a.self-link::before            { content: "¶"; }
	.heading > a.self-link::before { content: "§"; }
	dfn > a.self-link::before      { content: "#"; }

/** Counters ******************************************************************/
/* Adds the auto-genned issue/example counters,
   until Bikeshed fills in manual ones. */
	.issue:not(.no-marker)::before {
		content: "Issue " counter(issue);
	}

	.example:not(.no-marker)::before {
		content: "Example";
		content: "Example " counter(example);
	}
	.invalid.example:not(.no-marker)::before,
	.illegal.example:not(.no-marker)::before {
		content: "Invalid Example";
		content: "Invalid Example" counter(example);
	}



/********************************************
 Remember to remove the logo section when copypasting freshly.
 */
</style>
  <meta content="Bikeshed 1.0.0" name="generator">
<style>
  ul.toc ul ul ul {
    margin: 0 0 0 2em;
  }
  ul.toc ul ul ul span.secno {
    margin-left: -9em;
  }
</style>
<style>
        .dfn-panel {
            display: inline-block;
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel > span { display: list-item; list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: .5em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
 <body class="h-entry">
  <div>
   <p class="note" role="note">この文書は、<a href="https://w3c.github.io/webappsec-csp/" target="_blank">Content Security Policy Level 3</a> Editor's Draft （2016年2月29日版）の非公式な日本語訳です。正式な文書は英語版のみであることにご注意ください。詳しくは<a href="https://github.com/hashedhyphen/webappsec-specjp/blob/master/README.md">こちら</a>をご覧ください。</p>
  </div>
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Content Security Policy Level 3 日本語訳</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2016-02-29">29 February 2016</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/CSP3/">http://www.w3.org/TR/CSP3/</a>
     <dt>Version History:
     <dd><a href="https://github.com/w3c/webappsec-csp/commits/master/index.src.html">https://github.com/w3c/webappsec-csp/commits/master/index.src.html</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BCSP%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[CSP] <i data-lt="">… message topic …</i></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
     <dt>Participate:
     <dd><span><a href="https://github.com/w3c/webappsec-csp/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-csp/issues">open issues</a>)</span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2016 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>この仕様書では、Web ページから読込・実行が可能なリソースや、その Web ページに課すセキュリティポリシーを、開発者が制御できるようにする仕組みを定義します。</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> <strong>Changes to this document may be tracked at <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong> </p>
   <p> The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5BCSP%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “CSP” in the subject,
	preferably like this:
	“[CSP] <em>…summary of comment…</em>” </p>
   <p> This document was produced by the <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">導入</span></a>
     <ol class="toc">
      <li>
       <a href="#examples"><span class="secno">1.1</span> <span class="content">例</span></a>
       <ol class="toc">
        <li><a href="#example-basic"><span class="secno">1.1.1</span> <span class="content">Web ページの制御</span></a>
       </ol>
      <li><a href="#goals"><span class="secno">1.2</span> <span class="content">目的</span></a>
      <li><a href="#changes-from-level-2"><span class="secno">1.3</span> <span class="content">Level 2 からの変更点</span></a>
      <li><a href="#open-questions"><span class="secno">1.4</span> <span class="content">議論中の事項</span></a>
     </ol>
    <li>
     <a href="#framework"><span class="secno">2</span> <span class="content">枠組み</span></a>
     <ol class="toc">
      <li>
       <a href="#framework-policy"><span class="secno">2.1</span> <span class="content">ポリシー</span></a>
       <ol class="toc">
        <li><a href="#parse-serialized-policy"><span class="secno">2.1.1</span> <span class="content"> <var>serialized CSP</var> を <var>disposition</var> に従ってパースする </span></a>
        <li><a href="#parse-serialized-policy-list"><span class="secno">2.1.2</span> <span class="content"> serialized CSP の <var>list</var> を <var>disposition</var> に従ってパースする </span></a>
       </ol>
      <li>
       <a href="#framework-directives"><span class="secno">2.2</span> <span class="content">ディレクティブ</span></a>
       <ol class="toc">
        <li><a href="#framework-directive-source-list"><span class="secno">2.2.1</span> <span class="content">Source Lists</span></a>
       </ol>
      <li>
       <a href="#framework-violation"><span class="secno">2.3</span> <span class="content">Violations</span></a>
       <ol class="toc">
        <li><a href="#create-violation-for-global"><span class="secno">2.3.1</span> <span class="content"> <var>global</var>、<var>policy</var>、<var>directive</var> に対する violation オブジェクトの生成 </span></a>
        <li><a href="#create-violation-for-request"><span class="secno">2.3.2</span> <span class="content"> <var>request</var>、<var>policy</var>、<var>directive</var> に対する violation オブジェクトの生成 </span></a>
       </ol>
     </ol>
    <li>
     <a href="#policy-delivery"><span class="secno">3</span> <span class="content"> ポリシーの伝達 </span></a>
     <ol class="toc">
      <li><a href="#csp-header"><span class="secno">3.1</span> <span class="content"> <code>Content-Security-Policy</code> HTTP レスポンスヘッダフィールド </span></a>
      <li><a href="#cspro-header"><span class="secno">3.2</span> <span class="content"> <code>Content-Security-Policy-Report-Only</code> HTTP レスポンスヘッダフィールド </span></a>
      <li><a href="#meta-element"><span class="secno">3.3</span> <span class="content"> <code>&lt;meta></code> 要素 </span></a>
     </ol>
    <li>
     <a href="#integrations"><span class="secno">4</span> <span class="content">連携</span></a>
     <ol class="toc">
      <li>
       <a href="#fetch-integration"><span class="secno">4.1</span> <span class="content"> Fetch との連携 </span></a>
       <ol class="toc">
        <li><a href="#set-response-csp-list"><span class="secno">4.1.1</span> <span class="content"> <var>response</var> の <code>CSP list</code> を設定する </span></a>
        <li><a href="#report-for-request"><span class="secno">4.1.2</span> <span class="content"> <var>request</var> における Content Security Policy 違反を報告する </span></a>
        <li><a href="#should-block-request"><span class="secno">4.1.3</span> <span class="content"> <var>request</var> は Content Security Policy によってブロックされるべきか？ </span></a>
        <li><a href="#should-block-response"><span class="secno">4.1.4</span> <span class="content"> <var>request</var> に対する <var>response</var> は Content Security Policy によってブロックされるべきか？ </span></a>
       </ol>
      <li>
       <a href="#html-integration"><span class="secno">4.2</span> <span class="content"> HTML との連携 </span></a>
       <ol class="toc">
        <li><a href="#initialize-document-csp"><span class="secno">4.2.1</span> <span class="content"> <code>Document</code> の <code>CSP list</code> に対する初期化 </span></a>
        <li><a href="#initialize-global-object-csp"><span class="secno">4.2.2</span> <span class="content"> グローバルオブジェクトの <code>CSP list</code> に対する初期化 </span></a>
        <li><a href="#should-block-inline"><span class="secno">4.2.3</span> <span class="content"> <var>element</var> においてインラインの <var>type</var> に関する挙動は Content Security Policy によってブロックされるべきか？ </span></a>
       </ol>
     </ol>
    <li>
     <a href="#reporting"><span class="secno">5</span> <span class="content"> 報告 </span></a>
     <ol class="toc">
      <li><a href="#violation-events"><span class="secno">5.1</span> <span class="content"> Violation DOM イベント </span></a>
      <li><a href="#deprecated-serialize-violation"><span class="secno">5.2</span> <span class="content"> <var>violation</var> を廃止された方法でシリアライズしたものを取得する </span></a>
      <li><a href="#report-violation"><span class="secno">5.3</span> <span class="content"> <var>violation</var> を報告する </span></a>
     </ol>
    <li>
     <a href="#csp-directives"><span class="secno">6</span> <span class="content"> Content Security Policy のディレクティブ </span></a>
     <ol class="toc">
      <li>
       <a href="#directives-fetch"><span class="secno">6.1</span> <span class="content"> Fetch ディレクティブ群 </span></a>
       <ol class="toc">
        <li>
         <a href="#directive-child-src"><span class="secno">6.1.1</span> <span class="content"><code>child-src</code></span></a>
         <ol class="toc">
          <li><a href="#child-src-algorithms"><span class="secno">6.1.1.1</span> <span class="content">アルゴリズム</span></a>
         </ol>
        <li>
         <a href="#directive-connect-src"><span class="secno">6.1.2</span> <span class="content"><code>connect-src</code></span></a>
         <ol class="toc">
          <li><a href="#connect-src-algorithms"><span class="secno">6.1.2.1</span> <span class="content">アルゴリズム</span></a>
         </ol>
        <li>
         <a href="#directive-default-src"><span class="secno">6.1.3</span> <span class="content"><code>default-src</code></span></a>
         <ol class="toc">
          <li><a href="#default-src-algorithms"><span class="secno">6.1.3.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#directive-font-src"><span class="secno">6.1.4</span> <span class="content"><code>font-src</code></span></a>
         <ol class="toc">
          <li><a href="#font-src-algorithms"><span class="secno">6.1.4.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#directive-img-src"><span class="secno">6.1.5</span> <span class="content"><code>img-src</code></span></a>
         <ol class="toc">
          <li><a href="#img-src-algorithms"><span class="secno">6.1.5.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#directive-manifest-src"><span class="secno">6.1.6</span> <span class="content"><code>manifest-src</code></span></a>
         <ol class="toc">
          <li><a href="#manifest-src-algorithms"><span class="secno">6.1.6.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#directive-media-src"><span class="secno">6.1.7</span> <span class="content"><code>media-src</code></span></a>
         <ol class="toc">
          <li><a href="#media-src-algorithms"><span class="secno">6.1.7.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#directive-object-src"><span class="secno">6.1.8</span> <span class="content"><code>object-src</code></span></a>
         <ol class="toc">
          <li><a href="#object-src-algorithms"><span class="secno">6.1.8.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#directive-script-src"><span class="secno">6.1.9</span> <span class="content"><code>script-src</code></span></a>
         <ol class="toc">
          <li><a href="#script-src-algorithms"><span class="secno">6.1.9.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#directive-style-src"><span class="secno">6.1.10</span> <span class="content"><code>style-src</code></span></a>
         <ol class="toc">
          <li><a href="#style-src-algorithms"><span class="secno">6.1.10.1</span> <span class="content">Algorithms</span></a>
         </ol>
        <li>
         <a href="#fetch-directive-matching-url"><span class="secno">6.1.11</span> <span class="content">URL のマッチングアルゴリズム</span></a>
         <ol class="toc">
          <li><a href="#does-request-violate-policy"><span class="secno">6.1.11.1</span> <span class="content"> <var>request</var> は<var>policy</var> に違反するか？ </span></a>
          <li><a href="#match-url-to-source-list"><span class="secno">6.1.11.2</span> <span class="content"> <var>url</var> は <var>source list</var> にマッチするか？ </span></a>
          <li><a href="#match-url-to-source-expression"><span class="secno">6.1.11.3</span> <span class="content"> <var>redirect count</var> を持つ <var>origin</var> において <var>url</var> は <var>expression</var> にマッチするか？ </span></a>
          <li><a href="#effective-directive-for-a-request"><span class="secno">6.1.11.4</span> <span class="content"> <var>request</var> の effective directive を得る </span></a>
         </ol>
        <li>
         <a href="#fetch-directive-matching-element"><span class="secno">6.1.12</span> <span class="content">Element Matching Algorithms</span></a>
         <ol class="toc">
          <li><a href="#match-element-to-source-list"><span class="secno">6.1.12.1</span> <span class="content"> Does <var>element</var> match source <var>list</var>? </span></a>
         </ol>
       </ol>
      <li>
       <a href="#directives-reporting"><span class="secno">6.2</span> <span class="content"> Reporting Directives </span></a>
       <ol class="toc">
        <li><a href="#directive-report-uri"><span class="secno">6.2.1</span> <span class="content"><code>report-uri</code></span></a>
        <li><a href="#directive-report-to"><span class="secno">6.2.2</span> <span class="content"><code>report-to</code></span></a>
       </ol>
      <li><a href="#directives-elsewhere"><span class="secno">6.3</span> <span class="content"> 他の文書で定義されるディレクティブ </span></a>
     </ol>
    <li>
     <a href="#security-considerations"><span class="secno">7</span> <span class="content">セキュリティに関して考慮すべき事項</span></a>
     <ol class="toc">
      <li><a href="#security-nonces"><span class="secno">7.1</span> <span class="content">nonce の再利用</span></a>
     </ol>
    <li>
     <a href="#authoring-considerations"><span class="secno">8</span> <span class="content">利用に関して考慮すべき事項</span></a>
     <ol class="toc">
      <li><a href="#multiple-policies"><span class="secno">8.1</span> <span class="content"> 複数のポリシーによる影響 </span></a>
     </ol>
    <li>
     <a href="#implementation-considerations"><span class="secno">9</span> <span class="content">実装に関して考慮すべき事項</span></a>
     <ol class="toc">
      <li><a href="#extensions"><span class="secno">9.1</span> <span class="content">ベンダー独自の拡張機能やアドオン</span></a>
     </ol>
    <li>
     <a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA に関して考慮すべき事項</span></a>
     <ol class="toc">
      <li><a href="#iana-csp"><span class="secno">10.1</span> <span class="content"> Content-Security-Policy </span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">謝辞</span></a>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">導入</span><a class="self-link" href="#intro"></a></h2>
    <p><em>この章は非規範的です。</em></p>
    <p>この仕様書では Content Security Policy (CSP) を定義します。CSP とは、開発者が様々な方法でアプリケーションの影響範囲を限定できるツールであり、クロスサイトスクリプティングのようにコンテンツが注入される脆弱性のリスクを軽減し、アプリケーションが動作する権限を制限することができます。</p>
    <p>コンテンツが注入される脆弱性に対して、CSP を最前線の防御に用いることは想定していません。むしろ、CSP は多層防御の構成要素として用いるのが最も効果的です。CSP を導入することで、悪意あるコンテンツが注入された際の被害を軽減することは可能ですが、入力時のバリデーションと出力時エンコーディングを注意深く行うことには勝りません。</p>
    <p>この仕様書は Content Security Policy Level 2 の改訂版です。この改訂では、CSP・HTML・Fetch の三者における連携をより明確に説明すること、ならびにモジュールとしての拡張性に関する情報を明確に提供することが目的となっています。</p>
    <p>私たちが新しい機能を必要とした際、その上に機能を構築できるような安定した基盤を形成することがこの仕様書の理想です。</p>
    <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">例</span><a class="self-link" href="#examples"></a></h3>
    <h4 class="heading settled" data-level="1.1.1" id="example-basic"><span class="secno">1.1.1. </span><span class="content">Web ページの制御</span><a class="self-link" href="#example-basic"></a></h4>
    <div class="example" id="example-56a4987a">
     <a class="self-link" href="#example-56a4987a"></a> MegaCorp Inc. の開発者は、自身のサイトをクロスサイトスクリプティング攻撃から守りたいと考えています。このとき、スクリプトの読込と実行が可能なオリジンを信頼した CDN に限定することで、スクリプトが注入されるリスクを軽減できます。加えて、そのページのコンテキストにおいてプラグインを無効にしたい場合、以上の要件を実現するポリシーは次のようになります。
<pre>Content-Security-Policy: script-src https://cdn.example.com/scripts/; object-src 'none'
</pre>
    </div>
    <h3 class="heading settled" data-level="1.2" id="goals"><span class="secno">1.2. </span><span class="content">目的</span><a class="self-link" href="#goals"></a></h3>
    <p>Content Security Policy は以下を目的として設計されています。</p>
    <ol>
     <li data-md="">
      <p>以下の事柄を制御することができ、かつ粒度の高い方法を開発者に提供することで、コンテンツが注入される攻撃のリスクを軽減します。</p>
      <ul>
       <li data-md="">
        <p>指定した <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> や <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code> に対して、リクエストの発行・コンテンツへの埋込・実行が可能なリソース</p>
       <li data-md="">
        <p>インラインスクリプトの実行</p>
       <li data-md="">
        <p>（<code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a></code> や類似の構文を用いる）動的なコード実行</p>
       <li data-md="">
        <p>インラインスタイルを含むアプリケーション</p>
      </ul>
     <li data-md="">
      <p>指定したリソースの埋め込み先オリジンを制御でき、かつ粒度の高い方法を開発者に提供することで、悪意あるコンテキストにリソースを埋め込む必要がある攻撃（例えば <a data-link-type="biblio" href="#biblio-timing">[TIMING]</a> で説明されている "Pixel Perfect" 攻撃）のリスクを軽減します。</p>
     <li data-md="">
      <p>開発者がアプリケーションの動作権限を制限できるようなポリシーの枠組みを提供します。</p>
     <li data-md="">
      <p>本番環境で攻撃を受けている箇所を報告し、開発者が検知できるような仕組みを提供します。</p>
    </ol>
    <h3 class="heading settled" data-level="1.3" id="changes-from-level-2"><span class="secno">1.3. </span><span class="content">Level 2 からの変更点</span><a class="self-link" href="#changes-from-level-2"></a></h3>
    <p>この仕様書は Content Security Policy Level 2 の仕様 <a data-link-type="biblio" href="#biblio-csp2">[CSP2]</a> を発展させたものです。以下に変更点を概説します。</p>
    <ol>
     <li data-md="">
      <p><a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> の仕様を元にして CSP の仕様を基礎から書き直しました。このことにより、CSP の要請と制限を他の仕様（例えば Service Worker など）と組み合わせるのが容易になるはずです。</p>
     <li data-md="">
      <p>CSP Level 2 で廃止された <code>frame-src</code> ディレクティブが削除されました。</p>
     <li data-md="">
      <p>source expressions に安全でないスキームを指定した際、安全なスキームにもマッチするようになりました。すなわち、<code>http:</code> は <code>http: https:</code> と等価であり、<code>http://a.com</code> は <code>http://a.com https://a.com</code> と等価です。</p>
      <p>同様に、<code>http</code> スキームのページで <code>'self'</code> を指定した場合、そのページのオリジンにおける <code>https</code> と <code>wss</code> にもマッチするようになりました。</p>
     <li data-md="">
      <p>インラインのスクリプトとスタイルから生成された違反レポートは、ブロックされたリソースとして "<code>inline</code>" が報告されることになります。同様に、<code>eval()</code> の実行がブロックされた場合は、ブロックされたリソースとして "<code>eval</code>" が報告されます。</p>
     <li data-md="">
      <p>（コンテキストが読込可能なリソースではなく） <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> や <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code> に作用するディレクティブは <a data-link-type="biblio" href="#biblio-csp-document">[CSP-DOCUMENT]</a> モジュールに分離されました。このモジュールには <code>base-uri</code> と <code>form-action</code>、<code>frame-ancestors</code>、<code>plugin-types</code>、<code>sandbox</code> が含まれます。</p>
     <li data-md="">
      <p><code>manifest-src</code> ディレクティブが追加されました。</p>
     <li data-md="">
      <p><code>report-uri</code> ディレクティブが廃止され、新しいディレクティブとして <code>report-to</code> が推奨されるようになりました。この <code>report-to</code> ディレクティブは <a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a> を基盤として設計されています。</p>
    </ol>
    <h3 class="heading settled" data-level="1.4" id="open-questions"><span class="secno">1.4. </span><span class="content">議論中の事項</span><a class="self-link" href="#open-questions"></a></h3>
    <p class="issue" id="issue-beb745b1"><a class="self-link" href="#issue-beb745b1"></a> <code>frame-src</code> を本当に削除したほうがいいのでしょうか？Worker とフレームの脅威モデルは似ていますが、それらの上で実行できる内容は異なります。もしかすると、Worker と フレームのどちらか一方のみを許可するほうが良いのかもしれません。</p>
    <p class="issue" id="issue-ce23d45e"><a class="self-link" href="#issue-ce23d45e"></a> <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> の内側で <code>sandbox</code> を有効にできるのでしょうか？このサポートを打ち切った場合に考慮すべき脅威はまだ明確に分かっていません（今日現在、Chrome と Safari ではサポートされています）。</p>
    <p class="issue" id="issue-1dba5599"><a class="self-link" href="#issue-1dba5599"></a> 報告の際に値を取り除く必要はまだあるのでしょうか？ブロックされたリソースにおける元々の URL を用いることで、そのリスクはほとんど排除されたと考えています。つまり、スクリプトが DOM を走査しても、レポートの JSON に含まれている自分自身の情報は何も収集できないはずです。</p>
    <p class="issue" id="issue-39406a5f"><a class="self-link" href="#issue-39406a5f"></a> <a href="https://lists.w3.org/Archives/Public/public-webappsec/2016Feb/0048.html"><code>'unsafe-dynamic'</code></a> を追加すべきでしょうか？</p>
    <p class="issue" id="issue-88485c04"><a class="self-link" href="#issue-88485c04"></a> ハッシュ値によるインラインイベントハンドラのホワイトリスト化を可能にすべきでしょうか？ <a href="https://github.com/w3c/webappsec-csp/issues/13">&lt;https://github.com/w3c/webappsec-csp/issues/13></a></p>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="framework"><span class="secno">2. </span><span class="content">枠組み</span><a class="self-link" href="#framework"></a></h2>
    <h3 class="heading settled" data-level="2.1" id="framework-policy"><span class="secno">2.1. </span><span class="content">ポリシー</span><a class="self-link" href="#framework-policy"></a></h3>
    <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" data-local-lt="policies" data-lt="policy" id="policy">policy<span class="dfn-panel" data-deco=""><b><a href="#policy">#policy</a></b><b>Referenced in:</b><span><a href="#ref-for-policy-1">2.1.1.
    serialized CSP を disposition に従ってパースする </a> <a href="#ref-for-policy-2">(2)</a> <a href="#ref-for-policy-3">(3)</a></span><span><a href="#ref-for-policy-4">2.1.2.
    serialized CSP の list を disposition に従ってパースする </a></span><span><a href="#ref-for-policy-5">2.2. ディレクティブ</a> <a href="#ref-for-policy-6">(2)</a> <a href="#ref-for-policy-7">(3)</a> <a href="#ref-for-policy-8">(4)</a> <a href="#ref-for-policy-9">(5)</a></span><span><a href="#ref-for-policy-10">2.3. Violations</a> <a href="#ref-for-policy-11">(2)</a> <a href="#ref-for-policy-12">(3)</a></span><span><a href="#ref-for-policy-13">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-policy-14">2.3.2.
    request、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-policy-15">3.
    ポリシーの伝達 </a> <a href="#ref-for-policy-16">(2)</a></span><span><a href="#ref-for-policy-17">4.1.
    Fetch との連携 </a></span><span><a href="#ref-for-policy-18">4.2.
    HTML との連携 </a> <a href="#ref-for-policy-19">(2)</a> <a href="#ref-for-policy-20">(3)</a> <a href="#ref-for-policy-21">(4)</a> <a href="#ref-for-policy-22">(5)</a></span><span><a href="#ref-for-policy-23">4.2.1.
    Document の CSP list に対する初期化 </a></span><span><a href="#ref-for-policy-24">5.
    報告 </a> <a href="#ref-for-policy-25">(2)</a></span><span><a href="#ref-for-policy-26">6.1.2.1. アルゴリズム</a> <a href="#ref-for-policy-27">(2)</a></span><span><a href="#ref-for-policy-28">6.1.3.1. Algorithms</a> <a href="#ref-for-policy-29">(2)</a></span><span><a href="#ref-for-policy-30">6.1.4.1. Algorithms</a> <a href="#ref-for-policy-31">(2)</a></span><span><a href="#ref-for-policy-32">6.1.5.1. Algorithms</a> <a href="#ref-for-policy-33">(2)</a></span><span><a href="#ref-for-policy-34">6.1.6.1. Algorithms</a> <a href="#ref-for-policy-35">(2)</a></span><span><a href="#ref-for-policy-36">6.1.7.1. Algorithms</a> <a href="#ref-for-policy-37">(2)</a></span><span><a href="#ref-for-policy-38">6.1.8.1. Algorithms</a> <a href="#ref-for-policy-39">(2)</a></span><span><a href="#ref-for-policy-40">6.1.9.1. Algorithms</a> <a href="#ref-for-policy-41">(2)</a></span><span><a href="#ref-for-policy-42">6.1.10.1. Algorithms</a> <a href="#ref-for-policy-43">(2)</a></span><span><a href="#ref-for-policy-44">6.1.11.1.
    request はpolicy に違反するか？ </a></span><span><a href="#ref-for-policy-45">7.1. nonce の再利用</a></span><span><a href="#ref-for-policy-46">9.1. ベンダー独自の拡張機能やアドオン</a></span></span></dfn> とは、動作の許可・制限の集合を定義するものです。<a href="#initialize-global-object-csp">§4.2.2 グローバルオブジェクトの CSP list に対する初期化</a> で説明されているように、<code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/browsers.html#dom-window">Window</a></code> や <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a></code> に対して適用されることもあります。</p>
    <p>各ポリシーには対応する <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-lt="directive set" data-noexport="" id="policy-directive-set">directive set<span class="dfn-panel" data-deco=""><b><a href="#policy-directive-set">#policy-directive-set</a></b><b>Referenced in:</b><span><a href="#ref-for-policy-directive-set-1">2.1.1.
    serialized CSP を disposition に従ってパースする </a> <a href="#ref-for-policy-directive-set-2">(2)</a> <a href="#ref-for-policy-directive-set-3">(3)</a> <a href="#ref-for-policy-directive-set-4">(4)</a></span><span><a href="#ref-for-policy-directive-set-5">2.1.2.
    serialized CSP の list を disposition に従ってパースする </a></span><span><a href="#ref-for-policy-directive-set-6">5.3.
    violation を報告する </a> <a href="#ref-for-policy-directive-set-7">(2)</a> <a href="#ref-for-policy-directive-set-8">(3)</a></span></span></dfn> が存在します。<dfn data-dfn-for="policy" data-dfn-type="dfn" data-noexport="" id="policy-directive-set0">directive set<a class="self-link" href="#policy-directive-set0"></a></dfn> とは、ポリシー適用時の結果を定義した <a data-link-type="dfn" href="#directives" id="ref-for-directives-1">directive</a> の集合です。</p>
    <p>各ポリシーには対応する <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-lt="disposition" data-noexport="" id="policy-disposition">disposition<span class="dfn-panel" data-deco=""><b><a href="#policy-disposition">#policy-disposition</a></b><b>Referenced in:</b><span><a href="#ref-for-policy-disposition-1">2.1.1.
    serialized CSP を disposition に従ってパースする </a> <a href="#ref-for-policy-disposition-2">(2)</a></span><span><a href="#ref-for-policy-disposition-3">2.1.2.
    serialized CSP の list を disposition に従ってパースする </a></span><span><a href="#ref-for-policy-disposition-4">4.1.2.
    request における Content Security Policy 違反を報告する </a></span><span><a href="#ref-for-policy-disposition-5">4.1.3.
    request は Content Security Policy によってブロックされるべきか？ </a></span><span><a href="#ref-for-policy-disposition-6">4.1.4.
    request に対する response は Content Security Policy によってブロックされるべきか？ </a> <a href="#ref-for-policy-disposition-7">(2)</a></span><span><a href="#ref-for-policy-disposition-8">4.2.3.
    element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？ </a></span></span></dfn> が存在し、"<code>enforce</code>" または "<code>report</code>" の値を持ちます。</p>
    <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" data-lt="serialized CSP" id="serialized-csp">serialized CSP<span class="dfn-panel" data-deco=""><b><a href="#serialized-csp">#serialized-csp</a></b><b>Referenced in:</b><span><a href="#ref-for-serialized-csp-1">2.1.1.
    serialized CSP を disposition に従ってパースする </a></span><span><a href="#ref-for-serialized-csp-2">2.1.2.
    serialized CSP の list を disposition に従ってパースする </a></span><span><a href="#ref-for-serialized-csp-3">2.2.1. Source Lists</a></span><span><a href="#ref-for-serialized-csp-4">3.
    ポリシーの伝達 </a></span><span><a href="#ref-for-serialized-csp-5">3.1.
    Content-Security-Policy HTTP レスポンスヘッダフィールド </a></span><span><a href="#ref-for-serialized-csp-6">3.2.
    Content-Security-Policy-Report-Only HTTP レスポンスヘッダフィールド </a></span><span><a href="#ref-for-serialized-csp-7">4.1.1.
    response の CSP list を設定する </a></span><span><a href="#ref-for-serialized-csp-8">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span></span></dfn> とは、シリアライズされたディレクティブをセミコロン区切りで並べた ASCII 文字列です。<a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a> の ABNF 文法を用いると以下のように表現されます。</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="serialized-policy" id="grammardef-serialized-policy">serialized-policy<span class="dfn-panel" data-deco=""><b><a href="#grammardef-serialized-policy">#grammardef-serialized-policy</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-serialized-policy-1">3.1.
    Content-Security-Policy HTTP レスポンスヘッダフィールド
  </a></span><span><a href="#ref-for-grammardef-serialized-policy-2">3.2.
    Content-Security-Policy-Report-Only HTTP レスポンスヘッダフィールド
  </a></span></span></dfn> = <a data-link-type="grammar" href="#grammardef-serialized-directive" id="ref-for-grammardef-serialized-directive-1">serialized-directive</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> ";" [ <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> <a data-link-type="grammar" href="#grammardef-serialized-directive" id="ref-for-grammardef-serialized-directive-2">serialized-directive</a> ] )
                    ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> は RFC 7230 の 3.2.3 項で定義されています。
</pre>
    <h4 class="heading settled dfn-paneled" data-algorithm="serialized CSP を disposition に従ってパースする" data-dfn-type="dfn" data-level="2.1.1" data-lt="parse a serialized CSP" data-noexport="" id="parse-serialized-policy"><span class="secno">2.1.1. </span><span class="content"> <var>serialized CSP</var> を <var>disposition</var> に従ってパースする </span><span class="dfn-panel" data-deco=""><b><a href="#parse-serialized-policy">#parse-serialized-policy</a></b><b>Referenced in:</b><span><a href="#ref-for-parse-serialized-policy-1">2.1.2.
    serialized CSP の list を disposition に従ってパースする </a></span><span><a href="#ref-for-parse-serialized-policy-2">3.1.
    Content-Security-Policy HTTP レスポンスヘッダフィールド </a></span><span><a href="#ref-for-parse-serialized-policy-3">3.2.
    Content-Security-Policy-Report-Only HTTP レスポンスヘッダフィールド </a></span><span><a href="#ref-for-parse-serialized-policy-4">4.1.
    Fetch との連携 </a></span></span></h4>
    <p><a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-1">serialized CSP</a> (<var>serialized CSP</var>) と <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-1">disposition</a> (<var>disposition</var>) に対して、このアルゴリズムは <a data-link-type="dfn" href="#policy" id="ref-for-policy-1">policy</a> オブジェクトを返します。文字列をパースできなかった場合、空の <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-1">directive set</a> が含まれた <a data-link-type="dfn" href="#policy" id="ref-for-policy-2">policy</a> が返されます。</p>
    <ol>
     <li data-md="">
      <p>空の <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-2">directive set</a> と <var>disposition</var> の <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-2">disposition</a> を持った <a data-link-type="dfn" href="#policy" id="ref-for-policy-3">policy</a> を <var>policy</var> に代入します。</p>
     <li data-md="">
      <p><var>serialized CSP</var> を U+003B SEMICOLON (<code>;</code>) で <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">厳格に分割し</a>、その結果に含まれる各 <var>token</var> に対して以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>token</var> から <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace">Strip leading and trailing whitespace</a> します。</p>
       <li data-md="">
        <p>ここで <var>token</var> が空文字列だった場合、残りの副手続きをスキップし、次の要素の処理に移ります。</p>
       <li data-md="">
        <p><var>token</var> から <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#space-characters">space characters</a> 以外の<a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters">文字を集めた</a>結果を <var>directive name</var> に代入します。</p>
       <li data-md="">
        <p>ここで、<var>directive name</var> と等しい <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name-1">name</a> を持つ <a data-link-type="dfn" href="#directives" id="ref-for-directives-2">directive</a> が <var>policy</var> の <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-3">directive set</a> に既に存在した場合、残りの副手続きをスキップし、次の要素の処理に移ります。</p>
        <p>ユーザエージェントはディレクティブが無視された旨を開発者に通知すべきです（SHOULD）。例えば、コンソールに警告を出すのが適切かもしれません。</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-spaces"><var>token</var> をスペースで分割</a>した結果を <var>directive value</var> に代入します。</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name-2">name</a> として <var>directive name</var> を、また <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-1">value</a> として <var>directive value</var> を持った新しい <a data-link-type="dfn" href="#directives" id="ref-for-directives-3">directive</a> を <var>directive</var> に代入します。</p>
       <li data-md="">
        <p><var>directive</var> を <var>policy</var> の <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-4">directive set</a> に追加します。</p>
      </ol>
     <li data-md="">
      <p><var>policy</var> を返します。</p>
    </ol>
    <h4 class="heading settled" data-algorithm="serialized CSP の list を disposition に従ってパースする" data-level="2.1.2" id="parse-serialized-policy-list"><span class="secno">2.1.2. </span><span class="content"> serialized CSP の <var>list</var> を <var>disposition</var> に従ってパースする </span><a class="self-link" href="#parse-serialized-policy-list"></a></h4>
    <p>複数の <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-2">serialized CSP</a> をカンマ区切りで並べた文字列 (<var>list</var>) と、<a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-3">disposition</a> (<var>disposition</var>) とに対して、以下のアルゴリズムは <a data-link-type="dfn" href="#policy" id="ref-for-policy-4">policy</a> のリストを返します。</p>
    <ol>
     <li data-md="">
      <p>空のリストを <var>policies</var> に代入します。</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-commas"><var>list</var> をカンマで分割</a>し、その結果に含まれる各 <var>token</var> に対して以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><a href="#parse-serialized-policy" id="ref-for-parse-serialized-policy-1">§2.1.1 serialized CSP を disposition に従ってパースする</a> に <var>token</var> と <var>disposition</var> を適用させた結果を <var>policy</var> に代入します。</p>
       <li data-md="">
        <p>ここで <var>policy</var> の <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-5">directive set</a> が空だった場合、残りの副手続きをスキップし、次の要素の処理に移ります。</p>
       <li data-md="">
        <p><var>policy</var> を <var>policies</var> に追加します。</p>
      </ol>
     <li data-md="">
      <p><var>policies</var> を返します。</p>
    </ol>
    <h3 class="heading settled" data-level="2.2" id="framework-directives"><span class="secno">2.2. </span><span class="content">ディレクティブ</span><a class="self-link" href="#framework-directives"></a></h3>
    <p><a data-link-type="dfn" href="#policy" id="ref-for-policy-5">Policies</a> には <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="directives" data-noexport="" id="directives">directives<span class="dfn-panel" data-deco=""><b><a href="#directives">#directives</a></b><b>Referenced in:</b><span><a href="#ref-for-directives-1">2.1. ポリシー</a></span><span><a href="#ref-for-directives-2">2.1.1.
    serialized CSP を disposition に従ってパースする </a> <a href="#ref-for-directives-3">(2)</a></span><span><a href="#ref-for-directives-4">2.2. ディレクティブ</a> <a href="#ref-for-directives-5">(2)</a></span><span><a href="#ref-for-directives-6">2.2.1. Source Lists</a></span><span><a href="#ref-for-directives-7">2.3. Violations</a></span><span><a href="#ref-for-directives-8">4.1.
    Fetch との連携 </a></span><span><a href="#ref-for-directives-9">5.3.
    violation を報告する </a> <a href="#ref-for-directives-10">(2)</a> <a href="#ref-for-directives-11">(3)</a></span><span><a href="#ref-for-directives-12">6.
    Content Security Policy のディレクティブ </a></span><span><a href="#ref-for-directives-13">6.1.3.1. Algorithms</a> <a href="#ref-for-directives-14">(2)</a></span></span></dfn> の集合が含まれており、各ディレクティブは動作を制御します。この仕様書で定義されるディレクティブは <a href="#csp-directives">§6 Content Security Policy のディレクティブ</a> で説明されています。</p>
    <p>各 <a data-link-type="dfn" href="#directives" id="ref-for-directives-4">directive</a> は <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-lt="name" data-noexport="" id="directive-name">name<span class="dfn-panel" data-deco=""><b><a href="#directive-name">#directive-name</a></b><b>Referenced in:</b><span><a href="#ref-for-directive-name-1">2.1.1.
    serialized CSP を disposition に従ってパースする </a> <a href="#ref-for-directive-name-2">(2)</a></span><span><a href="#ref-for-directive-name-3">2.2. ディレクティブ</a></span><span><a href="#ref-for-directive-name-4">6.1.3.1. Algorithms</a> <a href="#ref-for-directive-name-5">(2)</a></span><span><a href="#ref-for-directive-name-6">6.1.11.4.
    request の effective directive を得る </a></span></span></dfn> と <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-lt="value" data-noexport="" id="directive-value">value<span class="dfn-panel" data-deco=""><b><a href="#directive-value">#directive-value</a></b><b>Referenced in:</b><span><a href="#ref-for-directive-value-1">2.1.1.
    serialized CSP を disposition に従ってパースする </a></span><span><a href="#ref-for-directive-value-2">2.2. ディレクティブ</a> <a href="#ref-for-directive-value-3">(2)</a></span><span><a href="#ref-for-directive-value-4">2.2.1. Source Lists</a></span><span><a href="#ref-for-directive-value-5">5.3.
    violation を報告する </a> <a href="#ref-for-directive-value-6">(2)</a></span><span><a href="#ref-for-directive-value-7">6.1.2.1. アルゴリズム</a> <a href="#ref-for-directive-value-8">(2)</a></span><span><a href="#ref-for-directive-value-9">6.1.3.1. Algorithms</a> <a href="#ref-for-directive-value-10">(2)</a></span><span><a href="#ref-for-directive-value-11">6.1.4.1. Algorithms</a> <a href="#ref-for-directive-value-12">(2)</a></span><span><a href="#ref-for-directive-value-13">6.1.5.1. Algorithms</a> <a href="#ref-for-directive-value-14">(2)</a></span><span><a href="#ref-for-directive-value-15">6.1.6.1. Algorithms</a> <a href="#ref-for-directive-value-16">(2)</a></span><span><a href="#ref-for-directive-value-17">6.1.7.1. Algorithms</a> <a href="#ref-for-directive-value-18">(2)</a></span><span><a href="#ref-for-directive-value-19">6.1.8.1. Algorithms</a> <a href="#ref-for-directive-value-20">(2)</a></span><span><a href="#ref-for-directive-value-21">6.1.9.1. Algorithms</a> <a href="#ref-for-directive-value-22">(2)</a> <a href="#ref-for-directive-value-23">(3)</a></span><span><a href="#ref-for-directive-value-24">6.1.10.1. Algorithms</a> <a href="#ref-for-directive-value-25">(2)</a> <a href="#ref-for-directive-value-26">(3)</a></span></span></dfn> の組です。<a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name-3">name</a> は空ではない文字列であり、<a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-2">value</a> は空でない文字列の集合です。<a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-3">value</a> は空であってもよいです（MAY）。</p>
    <p><dfn data-dfn-type="dfn" data-noexport="" id="serialized-directive">serialized directive<a class="self-link" href="#serialized-directive"></a></dfn> は、空白で区切られた一つ以上のトークンからなる ASCII 文字列であり、<a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a> の ABNF を用いると以下のように表現されます</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="serialized-directive" id="grammardef-serialized-directive">serialized-directive<span class="dfn-panel" data-deco=""><b><a href="#grammardef-serialized-directive">#grammardef-serialized-directive</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-serialized-directive-1">2.1. ポリシー</a> <a href="#ref-for-grammardef-serialized-directive-2">(2)</a></span></span></dfn> = <a data-link-type="grammar" href="#grammardef-directive-name" id="ref-for-grammardef-directive-name-1">directive-name</a> [ <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="#grammardef-directive-value" id="ref-for-grammardef-directive-value-1">directive-value</a> ]
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="directive-name" id="grammardef-directive-name">directive-name<span class="dfn-panel" data-deco=""><b><a href="#grammardef-directive-name">#grammardef-directive-name</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-directive-name-1">2.2. ディレクティブ</a></span></span></dfn>       = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "-" )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="directive-value" id="grammardef-directive-value">directive-value<span class="dfn-panel" data-deco=""><b><a href="#grammardef-directive-value">#grammardef-directive-value</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-directive-value-1">2.2. ディレクティブ</a></span></span></dfn>      = *( %x09 / %x20-%x2B / %x2D-%x3A / %x3C-%7E )
                       ; ディレクティブの値には空白と <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">VCHAR</a> 文字を含めることができます。
                       ; ただし、";" と "," は除きます。

; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> は RFC 7230 の 3.2.3 項で定義されています。
; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a>、<a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a>、<a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">VCHAR</a> は RFC 5234 の付録 B.1 で定義されています。
</pre>
    <p><a data-link-type="dfn" href="#directives" id="ref-for-directives-5">Directives</a> に関連するアルゴリズムは以下の 5 つです。</p>
    <ol>
     <li data-md="">
      <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-lt="pre-request check" data-noexport="" id="directive-pre-request-check">pre-request check<span class="dfn-panel" data-deco=""><b><a href="#directive-pre-request-check">#directive-pre-request-check</a></b><b>Referenced in:</b><span><a href="#ref-for-directive-pre-request-check-1">6.1.1.1. アルゴリズム</a></span><span><a href="#ref-for-directive-pre-request-check-2">6.1.2.1. アルゴリズム</a></span><span><a href="#ref-for-directive-pre-request-check-3">6.1.3.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-4">6.1.4.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-5">6.1.5.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-6">6.1.6.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-7">6.1.7.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-8">6.1.8.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-9">6.1.9.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-10">6.1.10.1. Algorithms</a></span><span><a href="#ref-for-directive-pre-request-check-11">6.1.11.1.
    request はpolicy に違反するか？ </a></span><span><a href="#ref-for-directive-pre-request-check-12">6.3.
    他の文書で定義されるディレクティブ </a></span></span></dfn> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> と <a data-link-type="dfn" href="#policy" id="ref-for-policy-6">policy</a> を引数に取り、<a href="#should-block-request">§4.1.3 request は Content Security Policy によってブロックされるべきか？</a> の中で実行されるアルゴリズムです。実行結果として "<code>Allowed</code>" またはその他の指定された値を返します。</p>
     <li data-md="">
      <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-lt="post-request check" data-noexport="" id="directive-post-request-check">post-request check<span class="dfn-panel" data-deco=""><b><a href="#directive-post-request-check">#directive-post-request-check</a></b><b>Referenced in:</b><span><a href="#ref-for-directive-post-request-check-1">4.1.4.
    request に対する response は Content Security Policy によってブロックされるべきか？ </a></span><span><a href="#ref-for-directive-post-request-check-2">6.1.1.1. アルゴリズム</a></span><span><a href="#ref-for-directive-post-request-check-3">6.1.2.1. アルゴリズム</a></span><span><a href="#ref-for-directive-post-request-check-4">6.1.3.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-5">6.1.4.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-6">6.1.5.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-7">6.1.6.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-8">6.1.7.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-9">6.1.8.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-10">6.1.9.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-11">6.1.10.1. Algorithms</a></span><span><a href="#ref-for-directive-post-request-check-12">6.3.
    他の文書で定義されるディレクティブ </a></span></span></dfn> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> と <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>、そして <a data-link-type="dfn" href="#policy" id="ref-for-policy-7">policy</a> とを引数に取り、<a href="#should-block-response">§4.1.4 request に対する response は Content Security Policy によってブロックされるべきか？</a> の中で実行されるアルゴリズムです。実行結果として "<code>Allowed</code>" またはその他の指定された値を返します。</p>
     <li data-md="">
      <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-lt="response check" data-noexport="" id="directive-response-check">response check<span class="dfn-panel" data-deco=""><b><a href="#directive-response-check">#directive-response-check</a></b><b>Referenced in:</b><span><a href="#ref-for-directive-response-check-1">4.1.4.
    request に対する response は Content Security Policy によってブロックされるべきか？ </a></span></span></dfn> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> と <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>、そして <a data-link-type="dfn" href="#policy" id="ref-for-policy-8">policy</a> とを引数に取り、<a href="#should-block-response">§4.1.4 request に対する response は Content Security Policy によってブロックされるべきか？</a> の中で実行されるアルゴリズムです。実行結果として "<code>Allowed</code>" またはその他の値を定義に従って返します。<a href="#should-block-response">§4.1.4 request に対する response は Content Security Policy によってブロックされるべきか？</a> の中で実行されるアルゴリズムです。実行結果として "<code>Allowed</code>" またはその他の指定された値を返します。</p>
     <li data-md="">
      <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-lt="inline check" data-noexport="" id="directive-inline-check">inline check<span class="dfn-panel" data-deco=""><b><a href="#directive-inline-check">#directive-inline-check</a></b><b>Referenced in:</b><span><a href="#ref-for-directive-inline-check-1">4.2.3.
    element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？ </a></span><span><a href="#ref-for-directive-inline-check-2">6.1.9.1. Algorithms</a></span><span><a href="#ref-for-directive-inline-check-3">6.1.10.1. Algorithms</a></span></span></dfn> は <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> と type string を引数に取り、<a href="#should-block-inline">§4.2.3 element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？</a> 　の中で実行されるアルゴリズムです。実行結果として "<code>Allowed</code>" またはその他の指定された値を返します。</p>
     <li data-md="">
      <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-lt="initialization" data-noexport="" id="directive-initialization">initialization<span class="dfn-panel" data-deco=""><b><a href="#directive-initialization">#directive-initialization</a></b><b>Referenced in:</b><span><a href="#ref-for-directive-initialization-1">4.2.1.
    Document の CSP list に対する初期化 </a></span><span><a href="#ref-for-directive-initialization-2">6.1.9.1. Algorithms</a></span><span><a href="#ref-for-directive-initialization-3">6.1.10.1. Algorithms</a></span><span><a href="#ref-for-directive-initialization-4">6.3.
    他の文書で定義されるディレクティブ </a></span></span></dfn> は <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> または <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> と、<a data-link-type="dfn">responce</a>、そして <a data-link-type="dfn" href="#policy" id="ref-for-policy-9">policy</a> との 3 つの引数を取り、<a href="#initialize-document-csp">§4.2.1 Document の CSP list に対する初期化</a> の中で実行されるアルゴリズムです。特に指定がない限り、実行結果で値が返されることはありません。</p>
    </ol>
    <h4 class="heading settled" data-level="2.2.1" id="framework-directive-source-list"><span class="secno">2.2.1. </span><span class="content">Source Lists</span><a class="self-link" href="#framework-directive-source-list"></a></h4>
    <p><a data-link-type="dfn" href="#directives" id="ref-for-directives-6">directives</a> における <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-4">values</a> の多くは <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="source lists" data-noexport="" id="source-lists">source lists<span class="dfn-panel" data-deco=""><b><a href="#source-lists">#source-lists</a></b><b>Referenced in:</b><span><a href="#ref-for-source-lists-1">6.1.1. child-src</a></span><span><a href="#ref-for-source-lists-2">6.1.2. connect-src</a></span><span><a href="#ref-for-source-lists-3">6.1.3. default-src</a></span><span><a href="#ref-for-source-lists-4">6.1.4. font-src</a></span><span><a href="#ref-for-source-lists-5">6.1.5. img-src</a></span><span><a href="#ref-for-source-lists-6">6.1.6. manifest-src</a></span><span><a href="#ref-for-source-lists-7">6.1.7. media-src</a></span><span><a href="#ref-for-source-lists-8">6.1.8. object-src</a></span><span><a href="#ref-for-source-lists-9">6.1.11.2.
    url は source list にマッチするか？ </a></span><span><a href="#ref-for-source-lists-10">6.1.12.1.
    Does element match source list? </a></span></span></dfn> から構成されます。source list とは、読み込まれるコンテンツ、埋め込み・実行の可能性があるコンテンツを特定するトークンの集合です。これらのトークンは、以下に列挙した <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="source expression" data-noexport="" id="source-expression">source expression<span class="dfn-panel" data-deco=""><b><a href="#source-expression">#source-expression</a></b><b>Referenced in:</b><span><a href="#ref-for-source-expression-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-source-expression-2">6.1.11.3.
    redirect count を持つ origin において url は expression にマッチするか？ </a></span><span><a href="#ref-for-source-expression-3">6.1.12.1.
    Does element match source list? </a></span></span></dfn> の種類のうち、いずれか 1 つを示します。</p>
    <ol>
     <li data-md="">
      <p><a data-link-type="grammar" href="#grammardef-none" id="ref-for-grammardef-none-1"><code>'none'</code></a> や <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-1"><code>'self'</code></a> といったキーワード（要素を持たないものと、その時点における URL のオリジンとにそれぞれマッチします）</p>
     <li data-md="">
      <p><code>https://example.com/path/to/file.js</code> のようにシリアライズされた URL （特定のファイルにマッチします）または <code>https://example.com/</code> のようにシリアライズされた URL （そのオリジン上のすべてにマッチします）</p>
     <li data-md="">
      <p><code>https:</code> のようなスキーム（特定のスキームを持つ任意のリソースにマッチします）</p>
     <li data-md="">
      <p><code>example.com</code> のようなホスト名（スキームに関係なく、そのホスト上にある任意のリソースにマッチします）または <code>*.example.com</code> のようなホスト（スキームに関係なく、そのホスト上やサブドメイン上にある任意のリソースにマッチします（さらにそのサブドメインについても同様です））</p>
     <li data-md="">
      <p><code>'nonce-qwertyu12345'</code> のような nonces （ページにおける特定の要素にマッチします）</p>
     <li data-md="">
      <p><code>'sha256-abcd...'</code> のようなダイジェスト（ページにおける特定の要素にマッチします）</p>
    </ol>
    <p><dfn data-dfn-type="dfn" data-noexport="" id="serialized-source-list">serialized source list<a class="self-link" href="#serialized-source-list"></a></dfn> とは、<a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression-1">source expressions</a> を空白区切りで並べた ASCII 文字列であり、<a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a> の ABNF を用いると以下のように表現されます。</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="serialized-source-list" id="grammardef-serialized-source-list">serialized-source-list<span class="dfn-panel" data-deco=""><b><a href="#grammardef-serialized-source-list">#grammardef-serialized-source-list</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-serialized-source-list-1">6.1.1. child-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-2">6.1.2. connect-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-3">6.1.3. default-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-4">6.1.4. font-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-5">6.1.5. img-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-6">6.1.6. manifest-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-7">6.1.7. media-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-8">6.1.8. object-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-9">6.1.9. script-src</a></span><span><a href="#ref-for-grammardef-serialized-source-list-10">6.1.10. style-src</a></span></span></dfn> = ( <a data-link-type="grammar" href="#grammardef-source-expression" id="ref-for-grammardef-source-expression-1">source-expression</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="#grammardef-source-expression" id="ref-for-grammardef-source-expression-2">source-expression</a> ) ) / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="&apos;none&apos;" id="grammardef-none">'none'<span class="dfn-panel" data-deco=""><b><a href="#grammardef-none">#grammardef-none</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-none-1">2.2.1. Source Lists</a></span></span></dfn>"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="source-expression" id="grammardef-source-expression">source-expression<span class="dfn-panel" data-deco=""><b><a href="#grammardef-source-expression">#grammardef-source-expression</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-source-expression-1">2.2.1. Source Lists</a> <a href="#ref-for-grammardef-source-expression-2">(2)</a></span></span></dfn>      = <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source-1">scheme-source</a> / <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source-1">host-source</a> / <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source-1">keyword-source</a>
                         / <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source-1">nonce-source</a> / <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source-1">hash-source</a>

; スキーム:
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="scheme-source" id="grammardef-scheme-source">scheme-source<span class="dfn-panel" data-deco=""><b><a href="#grammardef-scheme-source">#grammardef-scheme-source</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-scheme-source-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-scheme-source-2">6.1.11.3.
    redirect count を持つ origin において url は expression にマッチするか？
  </a> <a href="#ref-for-grammardef-scheme-source-3">(2)</a></span></span></dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a> ":"
                ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a> は RFC 3986 の 3.1 節で定義されています。

; ホスト: "example.com" / "*.example.com" / "https://*.example.com:12/path/to/file.js"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="host-source" id="grammardef-host-source">host-source<span class="dfn-panel" data-deco=""><b><a href="#grammardef-host-source">#grammardef-host-source</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-host-source-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-host-source-2">6.1.11.3.
    redirect count を持つ origin において url は expression にマッチするか？
  </a> <a href="#ref-for-grammardef-host-source-3">(2)</a> <a href="#ref-for-grammardef-host-source-4">(3)</a></span></span></dfn> = [ <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part-1">scheme-part</a> "://" ] <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part-1">host-part</a> [ <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part-1">port-part</a> ] [ <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part-1">path-part</a> ]
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="scheme-part" id="grammardef-scheme-part">scheme-part<span class="dfn-panel" data-deco=""><b><a href="#grammardef-scheme-part">#grammardef-scheme-part</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-scheme-part-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-scheme-part-2">6.1.11.3.
    redirect count を持つ origin において url は expression にマッチするか？
  </a> <a href="#ref-for-grammardef-scheme-part-3">(2)</a> <a href="#ref-for-grammardef-scheme-part-4">(3)</a> <a href="#ref-for-grammardef-scheme-part-5">(4)</a> <a href="#ref-for-grammardef-scheme-part-6">(5)</a> <a href="#ref-for-grammardef-scheme-part-7">(6)</a></span></span></dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a>
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="host-part" id="grammardef-host-part">host-part<span class="dfn-panel" data-deco=""><b><a href="#grammardef-host-part">#grammardef-host-part</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-host-part-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-host-part-2">6.1.11.3.
    redirect count を持つ origin において url は expression にマッチするか？
  </a> <a href="#ref-for-grammardef-host-part-3">(2)</a> <a href="#ref-for-grammardef-host-part-4">(3)</a> <a href="#ref-for-grammardef-host-part-5">(4)</a> <a href="#ref-for-grammardef-host-part-6">(5)</a></span></span></dfn>   = "*" / [ "*." ] 1*<a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char-1">host-char</a> *( "." 1*<a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char-2">host-char</a> )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="host-char" id="grammardef-host-char">host-char<span class="dfn-panel" data-deco=""><b><a href="#grammardef-host-char">#grammardef-host-char</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-host-char-1">2.2.1. Source Lists</a> <a href="#ref-for-grammardef-host-char-2">(2)</a> <a href="#ref-for-grammardef-host-char-3">(3)</a></span></span></dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "-"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="port-part" id="grammardef-port-part">port-part<span class="dfn-panel" data-deco=""><b><a href="#grammardef-port-part">#grammardef-port-part</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-port-part-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-port-part-2">6.1.11.3.
    redirect count を持つ origin において url は expression にマッチするか？
  </a> <a href="#ref-for-grammardef-port-part-3">(2)</a> <a href="#ref-for-grammardef-port-part-4">(3)</a></span></span></dfn>   = ":" ( 1*<a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "*" )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="path-part" id="grammardef-path-part">path-part<span class="dfn-panel" data-deco=""><b><a href="#grammardef-path-part">#grammardef-path-part</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-path-part-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-path-part-2">6.1.11.3.
    redirect count を持つ origin において url は expression にマッチするか？
  </a> <a href="#ref-for-grammardef-path-part-3">(2)</a> <a href="#ref-for-grammardef-path-part-4">(3)</a></span></span></dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a>
              ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a> は RFC 3986 の 3.3 節で定義されています。

; キーワード:
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="keyword-source" id="grammardef-keyword-source">keyword-source<span class="dfn-panel" data-deco=""><b><a href="#grammardef-keyword-source">#grammardef-keyword-source</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-keyword-source-1">2.2.1. Source Lists</a></span></span></dfn> = "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="&apos;self&apos;" id="grammardef-self">'self'<span class="dfn-panel" data-deco=""><b><a href="#grammardef-self">#grammardef-self</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-self-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-self-2">6.1.3. default-src</a> <a href="#ref-for-grammardef-self-3">(2)</a> <a href="#ref-for-grammardef-self-4">(3)</a> <a href="#ref-for-grammardef-self-5">(4)</a> <a href="#ref-for-grammardef-self-6">(5)</a> <a href="#ref-for-grammardef-self-7">(6)</a> <a href="#ref-for-grammardef-self-8">(7)</a> <a href="#ref-for-grammardef-self-9">(8)</a> <a href="#ref-for-grammardef-self-10">(9)</a> <a href="#ref-for-grammardef-self-11">(10)</a> <a href="#ref-for-grammardef-self-12">(11)</a> <a href="#ref-for-grammardef-self-13">(12)</a> <a href="#ref-for-grammardef-self-14">(13)</a> <a href="#ref-for-grammardef-self-15">(14)</a> <a href="#ref-for-grammardef-self-16">(15)</a> <a href="#ref-for-grammardef-self-17">(16)</a> <a href="#ref-for-grammardef-self-18">(17)</a> <a href="#ref-for-grammardef-self-19">(18)</a> <a href="#ref-for-grammardef-self-20">(19)</a></span></span></dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="&apos;unsafe-inline&apos;" id="grammardef-unsafe-inline">'unsafe-inline'<span class="dfn-panel" data-deco=""><b><a href="#grammardef-unsafe-inline">#grammardef-unsafe-inline</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-unsafe-inline-1">6.
    Content Security Policy のディレクティブ
  </a></span><span><a href="#ref-for-grammardef-unsafe-inline-2">7.1. nonce の再利用</a> <a href="#ref-for-grammardef-unsafe-inline-3">(2)</a></span></span></dfn>" / "<dfn data-dfn-type="grammar" data-export="" id="grammardef-unsafe-eval">'unsafe-eval'<a class="self-link" href="#grammardef-unsafe-eval"></a></dfn>"

; Nonces: 'nonce-[ここに nonce 値が入ります]'
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="nonce-source" id="grammardef-nonce-source">nonce-source<span class="dfn-panel" data-deco=""><b><a href="#grammardef-nonce-source">#grammardef-nonce-source</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-nonce-source-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-nonce-source-2">6.1.9. script-src</a></span><span><a href="#ref-for-grammardef-nonce-source-3">6.1.10. style-src</a></span><span><a href="#ref-for-grammardef-nonce-source-4">6.1.12.1.
    Does element match source list?
  </a> <a href="#ref-for-grammardef-nonce-source-5">(2)</a></span><span><a href="#ref-for-grammardef-nonce-source-6">7.1. nonce の再利用</a></span></span></dfn>  = "'nonce-" <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value-1">base64-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="base64-value" id="grammardef-base64-value">base64-value<span class="dfn-panel" data-deco=""><b><a href="#grammardef-base64-value">#grammardef-base64-value</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-base64-value-1">2.2.1. Source Lists</a> <a href="#ref-for-grammardef-base64-value-2">(2)</a></span><span><a href="#ref-for-grammardef-base64-value-3">6.1.12.1.
    Does element match source list?
  </a> <a href="#ref-for-grammardef-base64-value-4">(2)</a></span></span></dfn>  = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "+" / "/" / "-" / "_" )*2( "=" )

; ダイジェスト: 'sha256-[digest goes here]'
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="hash-source" id="grammardef-hash-source">hash-source<span class="dfn-panel" data-deco=""><b><a href="#grammardef-hash-source">#grammardef-hash-source</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-hash-source-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-hash-source-2">6.1.9. script-src</a></span><span><a href="#ref-for-grammardef-hash-source-3">6.1.10. style-src</a></span><span><a href="#ref-for-grammardef-hash-source-4">6.1.12.1.
    Does element match source list?
  </a> <a href="#ref-for-grammardef-hash-source-5">(2)</a></span></span></dfn>    = "'" <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm-1">hash-algorithm</a> "-" <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value-2">base64-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export="" data-lt="hash-algorithm" id="grammardef-hash-algorithm">hash-algorithm<span class="dfn-panel" data-deco=""><b><a href="#grammardef-hash-algorithm">#grammardef-hash-algorithm</a></b><b>Referenced in:</b><span><a href="#ref-for-grammardef-hash-algorithm-1">2.2.1. Source Lists</a></span><span><a href="#ref-for-grammardef-hash-algorithm-2">6.1.12.1.
    Does element match source list?
  </a> <a href="#ref-for-grammardef-hash-algorithm-3">(2)</a> <a href="#ref-for-grammardef-hash-algorithm-4">(3)</a></span></span></dfn> = "sha256" / "sha384" / "sha512"
</pre>
    <p><a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char-3">host-char</a> の項では、意図的に ASCII 文字のみが許されています。従って、国際化ドメイン名は <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-3">serialized CSP</a> の中に直接含めることはできず、その代わりに Punycode で事前にエンコードしなければなりません（MUST）。例えば、<code>üüüüüü.de</code> というドメイン名は <code>xn--tdaaaaaa.de</code> と表記されなければなりません（MUST）。</p>
    <p class="note" role="note">Note: IP アドレスも上記の文法に適合しますが、source expression の中で用いて実際に URL とマッチするのは <code>127.0.0.1</code> のみです（詳しくは <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> を参照してください）。IP アドレスに関するセキュリティの問題点はまだ明確になっていませんが、管理者は可能な限りホスト名を用いるべきです。</p>
    <p><a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> のアルゴリズムが <code>Matches</code> を返した場合、その <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> は <dfn data-dfn-type="dfn" data-noexport="" id="matches-a-source-list">matches a source list<a class="self-link" href="#matches-a-source-list"></a></dfn> といいます。</p>
    <h3 class="heading settled" data-level="2.3" id="framework-violation"><span class="secno">2.3. </span><span class="content">Violations</span><a class="self-link" href="#framework-violation"></a></h3>
    <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="violation" data-noexport="" id="violation">violation<span class="dfn-panel" data-deco=""><b><a href="#violation">#violation</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-1">2.3. Violations</a> <a href="#ref-for-violation-2">(2)</a> <a href="#ref-for-violation-3">(3)</a> <a href="#ref-for-violation-4">(4)</a> <a href="#ref-for-violation-5">(5)</a> <a href="#ref-for-violation-6">(6)</a> <a href="#ref-for-violation-7">(7)</a> <a href="#ref-for-violation-8">(8)</a> <a href="#ref-for-violation-9">(9)</a> <a href="#ref-for-violation-10">(10)</a></span><span><a href="#ref-for-violation-11">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a> <a href="#ref-for-violation-12">(2)</a></span><span><a href="#ref-for-violation-13">2.3.2.
    request、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-14">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-15">5.3.
    violation を報告する </a> <a href="#ref-for-violation-16">(2)</a></span><span><a href="#ref-for-violation-17">6.2.
    Reporting Directives </a></span></span></dfn> とは、<a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> に対する <a data-link-type="dfn" href="#policy" id="ref-for-policy-10">policies</a> の制約に反したアクションやリソースを表現するものです。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-1">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="global object" data-noexport="" id="violation-global-object">global object<span class="dfn-panel" data-deco=""><b><a href="#violation-global-object">#violation-global-object</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-global-object-1">2.3. Violations</a></span><span><a href="#ref-for-violation-global-object-2">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a> <a href="#ref-for-violation-global-object-3">(2)</a></span><span><a href="#ref-for-violation-global-object-4">5.3.
    violation を報告する </a> <a href="#ref-for-violation-global-object-5">(2)</a> <a href="#ref-for-violation-global-object-6">(3)</a> <a href="#ref-for-violation-global-object-7">(4)</a></span></span></dfn> を持っており、違反が行われた <a data-link-type="dfn" href="#policy" id="ref-for-policy-11">policy</a> に対応する <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> がこれに相当します。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-2">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="url" data-noexport="" id="violation-url">url<span class="dfn-panel" data-deco=""><b><a href="#violation-url">#violation-url</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-url-1">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-url-2">5.3.
    violation を報告する </a> <a href="#ref-for-violation-url-3">(2)</a></span></span></dfn> を持っており、<a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object-1">global object</a> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> がこれに相当します。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-3">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="status" data-noexport="" id="violation-status">status<span class="dfn-panel" data-deco=""><b><a href="#violation-status">#violation-status</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-status-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-status-2">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-status-3">5.3.
    violation を報告する </a></span></span></dfn> を持っており、グローバルオブジェクトが生成されたリソースについて、このリソースの HTTP ステータスコードを表す非負整数で表現されます。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-4">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="resource" data-noexport="" id="violation-resource">resource<span class="dfn-panel" data-deco=""><b><a href="#violation-resource">#violation-resource</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-resource-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-resource-2">2.3.2.
    request、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-resource-3">4.2.3.
    element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？ </a></span><span><a href="#ref-for-violation-resource-4">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-resource-5">5.3.
    violation を報告する </a></span></span></dfn> を持っており、<code>null</code>、"<code>inline</code>"、"<code>eval</code>"、または <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> のいずれかで、ポリシーに違反したリソースを表現します。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-5">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="referrer" data-noexport="" id="violation-referrer">referrer<span class="dfn-panel" data-deco=""><b><a href="#violation-referrer">#violation-referrer</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-referrer-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-referrer-2">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-referrer-3">5.3.
    violation を報告する </a></span></span></dfn> を持っており、<code>null</code> または <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> のどちらかで、違反されたポリシーのリソースに対するリファラを表現します。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-6">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="policy" data-noexport="" id="violation-policy">policy<span class="dfn-panel" data-deco=""><b><a href="#violation-policy">#violation-policy</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-policy-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-policy-2">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-policy-3">5.3.
    violation を報告する </a> <a href="#ref-for-violation-policy-4">(2)</a> <a href="#ref-for-violation-policy-5">(3)</a> <a href="#ref-for-violation-policy-6">(4)</a> <a href="#ref-for-violation-policy-7">(5)</a></span></span></dfn> を持っており、違反が行われた <a data-link-type="dfn" href="#policy" id="ref-for-policy-12">policy</a> がこれに相当します。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-7">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="effective directive" data-noexport="" id="violation-effective-directive">effective directive<span class="dfn-panel" data-deco=""><b><a href="#violation-effective-directive">#violation-effective-directive</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-effective-directive-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-effective-directive-2">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a> <a href="#ref-for-violation-effective-directive-3">(2)</a></span><span><a href="#ref-for-violation-effective-directive-4">5.3.
    violation を報告する </a> <a href="#ref-for-violation-effective-directive-5">(2)</a></span></span></dfn> を持っており、空でない文字列として、違反の対象となった制限を指定した <a data-link-type="dfn" href="#directives" id="ref-for-directives-7">directive</a> を表現します。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-8">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="source file" data-noexport="" id="violation-source-file">source file<span class="dfn-panel" data-deco=""><b><a href="#violation-source-file">#violation-source-file</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-source-file-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-source-file-2">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a> <a href="#ref-for-violation-source-file-3">(2)</a></span><span><a href="#ref-for-violation-source-file-4">5.3.
    violation を報告する </a></span></span></dfn> を持っており、<code>null</code> または <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> で表現されます。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-9">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="line number" data-noexport="" id="violation-line-number">line number<span class="dfn-panel" data-deco=""><b><a href="#violation-line-number">#violation-line-number</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-line-number-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-line-number-2">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-line-number-3">5.3.
    violation を報告する </a></span></span></dfn> を持っており、負でない整数値で表現されます。</p>
    <p>各 <a data-link-type="dfn" href="#violation" id="ref-for-violation-10">violation</a> は <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-lt="column number" data-noexport="" id="violation-column-number">column number<span class="dfn-panel" data-deco=""><b><a href="#violation-column-number">#violation-column-number</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-column-number-1">2.3.1.
    global、policy、directive に対する violation オブジェクトの生成 </a></span><span><a href="#ref-for-violation-column-number-2">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-violation-column-number-3">5.3.
    violation を報告する </a></span></span></dfn> を持っており、負でない整数値で表現されます。</p>
    <h4 class="heading settled" data-algorithm="global、policy、directive に対する violation オブジェクトの生成" data-level="2.3.1" id="create-violation-for-global"><span class="secno">2.3.1. </span><span class="content"> <var>global</var>、<var>policy</var>、<var>directive</var> に対する violation オブジェクトの生成 </span><a class="self-link" href="#create-violation-for-global"></a></h4>
    <p>ある <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> (<var>global</var>) と <a data-link-type="dfn" href="#policy" id="ref-for-policy-13">policy</a> (<var>policy</var>)、 文字列 (<var>directive</var>) に対し、以下のアルゴリズムは新しい <a data-link-type="dfn" href="#violation" id="ref-for-violation-11">violation</a> オブジェクト を生成し、初期値をそれぞれ設定します。</p>
    <ol>
     <li data-md="">
      <p><a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object-2">global object</a> に <var>global</var> を、<a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy-1">policy</a> に <var>policy</var> を、<a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive-1">effective directive</a> に <var>directive</var> を、<a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource-1">resource</a> に <code>null</code> をそれぞれセットした新しい <a data-link-type="dfn" href="#violation" id="ref-for-violation-12">violation</a> を <var>violation</var> に代入します。</p>
     <li data-md="">
      <p>ここで、ユーザエージェントがスクリプトを実行中であり、かつ <var>global</var> からソースファイルの URL や行数、列数を読み出せる場合、それらに従って <var>violation</var> の <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file-1">source file</a> と <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number-1">line number</a>、<a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number-1">column number</a> を設定します。</p>
      <p class="issue" id="issue-0e2d0de4"><a class="self-link" href="#issue-0e2d0de4"></a> このような処理は他でも行われているでしょうか？この処理 は <a data-link-type="biblio" href="#biblio-es2015">[ES2015]</a>　で効果的に用いられていますが、それ以外の例をまだ知りません。</p>
     <li data-md="">
      <p>ここで <var>global</var> が <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/browsers.html#dom-window">Window</a></code> オブジェクトであった場合、<var>global</var> における <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/browsers.html#dom-document-2">document</a></code> の <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#dom-document-referrer">referrer</a></code> を <var>violation</var> の <a data-link-type="dfn" href="#violation-referrer" id="ref-for-violation-referrer-1">referrer</a> に代入します。</p>
     <li data-md="">
      <p><var>violation</var> の <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object-3">global object</a> に対応するリソースの HTTP ステータスコードを <var>violation</var> の <a data-link-type="dfn" href="#violation-status" id="ref-for-violation-status-1">status</a> に代入します。</p>
      <p class="issue" id="issue-6510dc05"><a class="self-link" href="#issue-6510dc05"></a> ステータスコードを正確に得るにはどうすれば良いのでしょうか？実際、このステータスコードはどこにも保存されません。</p>
     <li data-md="">
      <p><var>violation</var> を返します。</p>
    </ol>
    <h4 class="heading settled" data-algorithm="request、policy、directive に対する violation オブジェクトの生成" data-level="2.3.2" id="create-violation-for-request"><span class="secno">2.3.2. </span><span class="content"> <var>request</var>、<var>policy</var>、<var>directive</var> に対する violation オブジェクトの生成 </span><a class="self-link" href="#create-violation-for-request"></a></h4>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) と <a data-link-type="dfn" href="#policy" id="ref-for-policy-14">policy</a> (<var>policy</var>)、そして文字列 (<var>directive</var>) に対し、以下のアルゴリズムは新しい <a data-link-type="dfn" href="#violation" id="ref-for-violation-13">violation</a> オブジェクトを生成し、初期値をそれぞれ設定します。</p>
    <ol>
     <li data-md="">
      <p><var>request</var> における <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-global-object">global object</a> と <var>policy</var>、<var>directive</var> に対して <a href="#create-violation-for-global">§2.3.1 global、policy、directive に対する violation オブジェクトの生成</a> を実行し、その結果を <var>violation</var> に代入します。</p>
     <li data-md="">
      <p><var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> を <var>violation</var> の <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource-2">resource</a> に代入します。</p>
      <p class="note" role="note">Note: ここで用いるのは <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> であり、<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url">current url</a> では <em>ありません</em>。なぜなら後者には、リダイレクト先かつアクセスされてはならない（MUST NOT）ページに関する情報が含まれている可能性があるからです。</p>
     <li data-md="">
      <p><var>violation</var> を返します。</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="policy-delivery"><span class="secno">3. </span><span class="content"> ポリシーの伝達 </span><a class="self-link" href="#policy-delivery"></a></h2>
    <p>フィールド値に <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-4">serialized CSP</a> を持つ HTTP レスポンスヘッダを利用し、サーバは指定した <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource representation</a> に対する <a data-link-type="dfn" href="#policy" id="ref-for-policy-15">policy</a> を宣言してもよいです（MAY）。この仕組みは <a href="#csp-header">§3.1 Content-Security-Policy HTTP レスポンスヘッダフィールド</a> と <a href="#cspro-header">§3.2 Content-Security-Policy-Report-Only HTTP レスポンスヘッダフィールド</a> で詳しく定義されており、Fetch や HTML との併用については <a href="#fetch-integration">§4.1 Fetch との連携</a> と <a href="#html-integration">§4.2 HTML との連携</a> で詳しく説明されています。</p>
    <p>また、<a href="#meta-element">§3.3 &lt;meta> 要素</a> で説明されているように、<code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素の <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a></code> 属性を HTML ドキュメント中に用いて <a data-link-type="dfn" href="#policy" id="ref-for-policy-16">policy</a> を宣言してもよいでしょう。</p>
    <h3 class="heading settled" data-level="3.1" id="csp-header"><span class="secno">3.1. </span><span class="content"> <code>Content-Security-Policy</code> HTTP レスポンスヘッダフィールド </span><a class="self-link" href="#csp-header"></a></h3>
    <p>サーバからクライアントへポリシーを伝達する仕組みとしては、<dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="Content-Security-Policy" data-noexport="" id="content-security-policy"><code>Content-Security-Policy</code><span class="dfn-panel" data-deco=""><b><a href="#content-security-policy">#content-security-policy</a></b><b>Referenced in:</b><span><a href="#ref-for-content-security-policy-1">3.1.
    Content-Security-Policy HTTP レスポンスヘッダフィールド </a></span><span><a href="#ref-for-content-security-policy-2">6.1.3. default-src</a> <a href="#ref-for-content-security-policy-3">(2)</a> <a href="#ref-for-content-security-policy-4">(3)</a> <a href="#ref-for-content-security-policy-5">(4)</a></span><span><a href="#ref-for-content-security-policy-6">6.2.1. report-uri</a></span></span></dfn> HTTP レスポンスヘッダフィールドを用いることが望まれます。ヘッダの値は <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a> の ABNF で以下のように表現されます。</p>
<pre>Content-Security-Policy = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy-1">serialized-policy</a>
</pre>
    <div class="example" id="example-d17cc188">
     <a class="self-link" href="#example-d17cc188"></a>
<pre><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy-1">Content-Security-Policy</a>: script-src 'self';
                         report-to /csp-reporting-endpoint
</pre>
    </div>
    <p>同じリソースを指す異なる <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">representations</a> について、サーバはそれぞれ異なる <code>Content-Security-Policy</code> ヘッダフィールド値を送信してもよいです（MAY）。</p>
    <p>1 つの <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource representation</a> について、サーバは "<code>Content-Security-Policy</code>" という名前の HTTP レスポンスヘッダフィールドを 2 つ以上送信するべきではありません（SHOULD NOT）。</p>
    <p><code>Content-Security-Policy</code> ヘッダフィールドを受信したユーザエージェントは、フィールドに含まれている <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-5">serialized CSP</a> のそれぞれを <a data-link-type="dfn" href="#parse-serialized-policy" id="ref-for-parse-serialized-policy-2">parse</a> し、かつ <a data-link-type="dfn" href="#enforced" id="ref-for-enforced-1">enforce</a> しなければなりません（MUST）。これについては <a href="#fetch-integration">§4.1 Fetch との連携</a> と <a href="#html-integration">§4.2 HTML との連携</a> で説明されています。</p>
    <h3 class="heading settled" data-level="3.2" id="cspro-header"><span class="secno">3.2. </span><span class="content"> <code>Content-Security-Policy-Report-Only</code> HTTP レスポンスヘッダフィールド </span><a class="self-link" href="#cspro-header"></a></h3>
    <p>Web 開発者がポリシーの影響範囲を（実際に適用するのではなく）モニタリングしたい場合、<dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="Content-Security-Policy-Report-Only" data-noexport="" id="content-security-policy-report-only"><code>Content-Security-Policy-Report-Only</code><span class="dfn-panel" data-deco=""><b><a href="#content-security-policy-report-only">#content-security-policy-report-only</a></b><b>Referenced in:</b><span><a href="#ref-for-content-security-policy-report-only-1">3.2.
    Content-Security-Policy-Report-Only HTTP レスポンスヘッダフィールド </a> <a href="#ref-for-content-security-policy-report-only-2">(2)</a></span><span><a href="#ref-for-content-security-policy-report-only-3">3.3.
    &lt;meta> 要素 </a></span></span></dfn> HTTP レスポンスヘッダフィールドを用いて実験することができます。ヘッダの値は <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a> の ABNF で以下のように表現されます。</p>
<pre>Content-Security-Policy-Report-Only = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy-2">serialized-policy</a>
</pre>
    <p>Web 開発者はこのヘッダフィールドを用いることで、実験を繰り返しつつセキュリティポリシーを組み立てることができます。つまり、サイトの動作を入念に設計した状態で report-only ポリシーをデプロイし、その結果を違反レポートとして検証することで、サイトの動作に自信を持ってから実際にポリシーを適用することができます。</p>
    <div class="example" id="example-913cb678">
     <a class="self-link" href="#example-913cb678"></a>
<pre><a data-link-type="dfn" href="#content-security-policy-report-only" id="ref-for-content-security-policy-report-only-1">Content-Security-Policy-Report-Only</a>: script-src 'self';
                                     report-to /csp-reporting-endpoint
</pre>
    </div>
    <p>同じリソースを指す異なる <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">representations</a> について、サーバはそれぞれ異なる <code>Content-Security-Policy-Report-Only</code> ヘッダフィールド値を送信してもよいです（MAY）。</p>
    <p>1 つの <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource representation</a> について、サーバは "<code>Content-Security-Policy-Report-Only</code>" という名前の HTTP レスポンスヘッダフィールドを 2 つ以上送信するべきではありません（SHOULD NOT）。</p>
    <p><code>Content-Security-Policy-Report-Only</code> ヘッダフィールドを受信したユーザエージェントは、フィールドに含まれている <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-6">serialized CSP</a> のそれぞれを <a data-link-type="dfn" href="#parse-serialized-policy" id="ref-for-parse-serialized-policy-3">parse</a> し、かつ <a data-link-type="dfn" href="#monitored" id="ref-for-monitored-1">monitor</a> しなければなりません（MUST）。これについては <a href="#fetch-integration">§4.1 Fetch との連携</a> と <a href="#html-integration">§4.2 HTML との連携</a> で説明されています。</p>
    <p class="note" role="note">Note: <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素における <a data-link-type="dfn" href="#content-security-policy-report-only" id="ref-for-content-security-policy-report-only-2"><code>Content-Security-Policy-Report-Only</code></a> ヘッダはサポートされて<strong>いません</strong>。</p>
    <h3 class="heading settled" data-level="3.3" id="meta-element"><span class="secno">3.3. </span><span class="content"> <code>&lt;meta></code> 要素 </span><a class="self-link" href="#meta-element"></a></h3>
    <p>"<code>Content-Security-Policy</code>" に対して <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> な文字列を <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a></code> 属性値に持つ HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素について、<code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> はこの要素を 1 つ以上用いてポリシーを伝達してもよいです（MAY）。具体例を以下に示します。</p>
    <div class="example" id="example-cff5e786">
     <a class="self-link" href="#example-cff5e786"></a>
<pre>&lt;meta http-equiv="Content-Security-Policy" content="script-src 'self'">
</pre>
    </div>
    <p>実装に関する詳細は、HTML 仕様の <a data-link-type="dfn" href="https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy"><code>Content-Security-Policy</code> <code>http-equiv</code> processing instructions</a> <a data-link-type="biblio" href="#biblio-html">[HTML]</a> を参照してください。</p>
    <p class="note" role="note">Note: <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素における <a data-link-type="dfn" href="#content-security-policy-report-only" id="ref-for-content-security-policy-report-only-3"><code>Content-Security-Policy-Report-Only</code></a> ヘッダはサポートされて<em>いません</em>。また、<code>report-uri</code>、<code>frame-ancestors</code>、<code>sandbox</code> 各ディレクティブも <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素内ではサポートされていません。</p>
    <p class="issue" id="issue-44b673d0"><a class="self-link" href="#issue-44b673d0"></a> 制限を緩めて <code>sandbox</code> も利用可にできるでしょうか？</p>
    <p>Web 開発者は、できるだけドキュメントの先頭近くに <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素を書くように<em>強く推奨されます</em>。なぜなら、<code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素内で指定されたポリシーは、その書かれた位置より前のコンテンツには適用されないからです。特に、<code>Link</code> HTTP レスポンスヘッダフィールドを使って読込・先読みされるリソース、また <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素で伝達されたポリシーより前に位置する <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a></code> 要素や <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> 要素で読込・先読みされるリソースについて、これらがブロックの対象とならないことに注意してください。</p>
    <p class="note" role="note">Note: あるポリシーが <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素内で指定されており、かつ保護されたリソースに対するアクティブなポリシーが他にもあった場合、後者のポリシーを指定した位置に関係なく、両方のポリシーが同時に適用されます。複数ポリシーの適用時における一般的な影響については <a href="#multiple-policies">§8.1 複数のポリシーによる影響</a> で説明されています。</p>
    <p class="note" role="note">Note: <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素がパースされた後に <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a></code> 属性値を変更した場合、この変更は無視されます。</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="integrations"><span class="secno">4. </span><span class="content">連携</span><a class="self-link" href="#integrations"></a></h2>
    <p><em>この章は非規範的です。</em></p>
    <p>この仕様書で定義されるアルゴリズムには、機能実装を目的として他の仕様書で利用されるものがあります。このような連携を明らかにするため以下に概要を説明しますが、それら外部の仕様書は規範的な文書であり、詳細はその仕様書で確認すべきものです。</p>
    <h3 class="heading settled" data-level="4.1" id="fetch-integration"><span class="secno">4.1. </span><span class="content"> Fetch との連携 </span><a class="self-link" href="#fetch-integration"></a></h3>
    <p>リソースを読み込む様々な方法は、多くの <a data-link-type="dfn" href="#directives" id="ref-for-directives-8">directives</a> によって制御されます。この仕様書で提供するアルゴリズムにより、特定の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a>に対するブロック・許可の判断、または特定の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> を <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error">network error</a> で置き換える判断を Fetch が行えるようになります。</p>
    <ol>
     <li data-md="">
      <p><a href="#should-block-request">§4.1.3 request は Content Security Policy によってブロックされるべきか？</a> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch">Main Fetch</a> アルゴリズム中のステップ #4 で呼び出されます。</p>
     <li data-md="">
      <p><a href="#should-block-response">§4.1.4 request に対する response は Content Security Policy によってブロックされるべきか？</a> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch">Main Fetch</a> アルゴリズム中のステップ #12 で呼び出されます。</p>
    </ol>
    <p><a data-link-type="dfn" href="#policy" id="ref-for-policy-17">policy</a> は <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> に適用されるのが通常ですが、<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> の内容を必要とするディレクティブを処理するため、ユーザエージェントは HTTP レスポンスヘッダフィールドで伝達されてきたすべてのポリシーについて、<a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> を生成する前に <a data-link-type="dfn" href="#parse-serialized-policy" id="ref-for-parse-serialized-policy-4">parse</a> する必要があります。そのため、</p>
    <ol>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> を持ちます。<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> とは、<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> で伝達されたすべてのポリシーオブジェクトを含むものです。</p>
     <li data-md="">
      <p><a href="#set-response-csp-list">§4.1.1 response の CSP list を設定する</a> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-fetch">HTTP fetch</a> と <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-network-fetch">HTTP-network fetch</a> アルゴリズムの中で呼び出されます。</p>
      <p class="note" role="note">Note: この 2 つの呼び出しについては、どのように <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> を生成したかに関係なく、<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> がセットされていることを保障すべきです。（<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-network-fetch">HTTP-network fetch</a> を用いて）ネットワークに接続した場合、<code>Set-Cookie</code> ヘッダを処理する前にポリシーをパースします。（<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-fetch">HTTP fetch</a> を用いて）Service Worker からレスポンスを受けた場合、そのレスポンスを呼び出し元に返す前に <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> を処理します。</p>
    </ol>
    <h4 class="heading settled" data-algorithm="response の CSP list を設定する" data-level="4.1.1" id="set-response-csp-list"><span class="secno">4.1.1. </span><span class="content"> <var>response</var> の <code>CSP list</code> を設定する </span><a class="self-link" href="#set-response-csp-list"></a></h4>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>) に対して、このアルゴリズムは <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-7">serialized CSP</a> を値に持つ <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> を評価し、その結果に基づいて <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> を以下のように設定します。</p>
    <ol>
     <li data-md="">
      <p>空のリストを <var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> に代入します。</p>
     <li data-md="">
      <p>disposition を "<code>enforce</code>" とし、<var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> における <code>Content-Security-Policy</code> を <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-parse">parsing</a> した結果に <a href="#parse-serialized-policy-list">§2.1.2 serialized CSP の list を disposition に従ってパースする</a> を適用した結果を <var>policies</var> に代入します。</p>
     <li data-md="">
      <p>disposition を "<code>report</code>" とし、<var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> における <code>Content-Security-Policy-Report-Only</code> を <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-parse">parsing</a> し、その結果について <a href="#parse-serialized-policy-list">§2.1.2 serialized CSP の list を disposition に従ってパースする</a> を適用した結果を <var>policies</var> に追加します。</p>
     <li data-md="">
      <p><var>policies</var> に含まれる要素 <var>policy</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> に <var>policy</var> を挿入します。</p>
      </ol>
    </ol>
    <h4 class="heading settled" data-algorithm="request における Content Security Policy 違反を報告する" data-level="4.1.2" id="report-for-request"><span class="secno">4.1.2. </span><span class="content"> <var>request</var> における Content Security Policy 違反を報告する </span><a class="self-link" href="#report-for-request"></a></h4>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) に対して、このアルゴリズムは <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a> の "report only" ポリシーに基づいて違反を報告します。</p>
    <ol>
     <li data-md="">
      <p><var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a> が持つ <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> の <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list-1">CSP list</a> を <var>CSP list</var> に代入します。</p>
     <li data-md="">
      <p><var>CSP list</var> に含まれる要素 <var>policy</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで <var>policy</var> の <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-4">disposition</a> が "<code>enforce</code>" だった場合、以降の処理を飛ばして次の <var>policy</var> に移ります。</p>
       <li data-md="">
        <p><var>request</var> と <var>policy</var> に対して <a href="#does-request-violate-policy">§6.1.11.1 request はpolicy に違反するか？</a> を適用した結果を <var>violates</var> に代入します。</p>
       <li data-md="">
        <p>ここで <var>violates</var> が "<code>Does Not Violate</code>" でなかった場合、<var>request</var> と <var>policy</var> と <var>violates</var> に対して <a href="#create-violation-for-request">§2.3.2 request、policy、directive に対する violation オブジェクトの生成</a> を適用し、その結果に対して <a href="#report-violation">§5.3 violation を報告する</a> を適用します。</p>
      </ol>
    </ol>
    <h4 class="heading settled" data-algorithm="request は Content Security Policy によってブロックされるべきか？" data-level="4.1.3" id="should-block-request"><span class="secno">4.1.3. </span><span class="content"> <var>request</var> は Content Security Policy によってブロックされるべきか？ </span><a class="self-link" href="#should-block-request"></a></h4>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) に対し、このアルゴリズムは <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a> における Content Security Policy に基づいて <code>Blocked</code> または <code>Allowed</code> のどちらかを返します。</p>
    <ol>
     <li data-md="">
      <p><var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a> が持つ <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> の <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list-2">CSP list</a> を <var>CSP list</var> に代入します。</p>
     <li data-md="">
      <p><var>result</var> に "<code>Allowed</code>" を代入します。</p>
     <li data-md="">
      <p><var>CSP list</var> に含まれる要素 <var>policy</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで <var>policy</var> の <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-5">disposition</a> が "<code>report</code>" だった場合、以降の処理を飛ばして次の <var>policy</var> に移ります。</p>
       <li data-md="">
        <p><var>request</var> と <var>policy</var> に対して <a href="#does-request-violate-policy">§6.1.11.1 request はpolicy に違反するか？</a> を適用した結果を <var>violates</var> に代入します。</p>
       <li data-md="">
        <p>ここで <var>violates</var> が "<code>Does Not Violate</code>" ではなかった場合、以下を実行します。</p>
        <ol>
         <li data-md="">
          <p><var>request</var> と <var>policy</var> と <var>violates</var> に対して <a href="#report-violation">§5.3 violation を報告する</a> を実行します。</p>
         <li data-md="">
          <p><var>result</var> に "<code>Blocked</code>" を代入します。</p>
        </ol>
      </ol>
     <li data-md="">
      <p><var>result</var> を返します。</p>
    </ol>
    <h4 class="heading settled" data-algorithm="request に対する response は Content Security Policy によってブロックされるべきか？" data-level="4.1.4" id="should-block-response"><span class="secno">4.1.4. </span><span class="content"> <var>request</var> に対する <var>response</var> は Content Security Policy によってブロックされるべきか？ </span><a class="self-link" href="#should-block-response"></a></h4>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>) と a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) に対し、このアルゴリズムは <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a> における Content Security Policy に基づいて <code>Blocked</code> または <code>Allowed</code> のどちらかを返します。</p>
    <ol>
     <li data-md="">
      <p><var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a> が持つ <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> の <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list-3">CSP list</a> を <var>CSP list</var> に代入します。</p>
     <li data-md="">
      <p><var>result</var> に "<code>Allowed</code>" を代入します。</p>
     <li data-md="">
      <p><var>CSP list</var> に含まれる要素 <var>policy</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>policy</var> に含まれる要素 <var>directive</var> のそれぞれについて以下を実行します。</p>
        <ol>
         <li data-md="">
          <p>ここで <var>directive</var> の <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-1">post-request check</a> を実行し、その結果が "<code>Blocked</code>" だった場合、以下を実行します。</p>
          <ol>
           <li data-md="">
            <p><var>request</var> と <var>policy</var> と <var>directive</var> に対して <a href="#create-violation-for-request">§2.3.2 request、policy、directive に対する violation オブジェクトの生成</a> を適用し、その結果をもとに <a href="#report-violation">§5.3 violation を報告する</a> を実行します。</p>
           <li data-md="">
            <p>ここで <var>policy</var> の <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-6">disposition</a> が "<code>enforce</code>" だった場合、<var>result</var> に "<code>Blocked</code>" を代入します。</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: この箇所では、ページがレスポンスを読み込み可能であることを検証しています。すなわち、ページの CSP に違反したファイルを Service Worker が差し替えていない場合などを想定したものです。</p>
     <li data-md="">
      <p><var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> に含まれる要素 <var>policy</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>policy</var> に含まれる要素 <var>directive</var> のそれぞれについて以下を実行します。</p>
        <ol>
         <li data-md="">
          <p>ここで <var>request</var> と <var>response</var> と <var>policy</var> に対して <var>directive</var> の <a data-link-type="dfn" href="#directive-response-check" id="ref-for-directive-response-check-1">response check</a> を適用し、その結果が "<code>Blocked</code>" だった場合、以下を実行します。</p>
          <ol>
           <li data-md="">
            <p><var>request</var> と <var>policy</var> と <var>directive</var> に対して <a href="#create-violation-for-request">§2.3.2 request、policy、directive に対する violation オブジェクトの生成</a> を適用し、その結果をもとに <a href="#report-violation">§5.3 violation を報告する</a> を実行します。</p>
           <li data-md="">
            <p>ここで <var>policy</var> の <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-7">disposition</a> が "<code>enforce</code>" だった場合、<var>result</var> に "<code>Blocked</code>" を代入します。</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: この箇所では、レスポンスと一緒に伝達されてきたポリシーをもとに、そのレスポンスは読み込むべきものかどうかを判断しています。</p>
     <li data-md="">
      <p><var>result</var> を返します。</p>
    </ol>
    <h3 class="heading settled" data-level="4.2" id="html-integration"><span class="secno">4.2. </span><span class="content"> HTML との連携 </span><a class="self-link" href="#html-integration"></a></h3>
    <ol>
     <li data-md="">
      <p><code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> オブジェクトと <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a></code> オブジェクトは <dfn class="dfn-paneled" data-dfn-for="global object" data-dfn-type="dfn" data-lt="CSP list" data-noexport="" id="global-object-csp-list">CSP list<span class="dfn-panel" data-deco=""><b><a href="#global-object-csp-list">#global-object-csp-list</a></b><b>Referenced in:</b><span><a href="#ref-for-global-object-csp-list-1">4.1.2.
    request における Content Security Policy 違反を報告する </a></span><span><a href="#ref-for-global-object-csp-list-2">4.1.3.
    request は Content Security Policy によってブロックされるべきか？ </a></span><span><a href="#ref-for-global-object-csp-list-3">4.1.4.
    request に対する response は Content Security Policy によってブロックされるべきか？ </a></span><span><a href="#ref-for-global-object-csp-list-4">4.2.
    HTML との連携 </a></span><span><a href="#ref-for-global-object-csp-list-5">4.2.2.
    グローバルオブジェクトの CSP list に対する初期化 </a> <a href="#ref-for-global-object-csp-list-6">(2)</a></span><span><a href="#ref-for-global-object-csp-list-7">4.2.3.
    element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？ </a></span></span></dfn> を持ちます。この CSP list は、そのコンテキストでアクティブな <a data-link-type="dfn" href="#policy" id="ref-for-policy-18">policy</a> オブジェクトすべてを含むリストです。特に指定のない限り、このリストが空になることはなく、アルゴリズム <a href="#initialize-global-object-csp">§4.2.2 グローバルオブジェクトの CSP list に対する初期化</a> によって初期化されます。</p>
     <li data-md="">
      <p>ある <a data-link-type="dfn" href="#policy" id="ref-for-policy-19">policy</a> が <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> の <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list-4">CSP list</a> に挿入されると、その <a data-link-type="dfn" href="#policy" id="ref-for-policy-20">policy</a> は <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> に対して <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="enforced" data-noexport="" id="enforced">enforced<span class="dfn-panel" data-deco=""><b><a href="#enforced">#enforced</a></b><b>Referenced in:</b><span><a href="#ref-for-enforced-1">3.1.
    Content-Security-Policy HTTP レスポンスヘッダフィールド </a></span><span><a href="#ref-for-enforced-2">4.2.
    HTML との連携 </a></span></span></dfn> されるか <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="monitored" data-noexport="" id="monitored">monitored<span class="dfn-panel" data-deco=""><b><a href="#monitored">#monitored</a></b><b>Referenced in:</b><span><a href="#ref-for-monitored-1">3.2.
    Content-Security-Policy-Report-Only HTTP レスポンスヘッダフィールド </a></span></span></dfn> されます。</p>
     <li data-md="">
      <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> に対する <a data-link-type="dfn" href="#policy" id="ref-for-policy-21">policy</a> オブジェクトの集合を、新しく生成した <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> と関連付けるため、アルゴリズム <a href="#initialize-global-object-csp">§4.2.2 グローバルオブジェクトの CSP list に対する初期化</a> は <a data-link-type="dfn" href="https://html.spec.whatwg.org/#initialising-a-new-document-object">initialising a new <code>Document</code> object</a> と <a data-link-type="dfn" href="https://html.spec.whatwg.org/#run-a-worker">run a worker</a> のアルゴリズム中で呼び出されます。</p>
      <p class="issue" id="issue-ba1e08e5"><a class="self-link" href="#issue-ba1e08e5"></a> W3C’s HTML で定義されるアルゴリズム "creating a new <code>Document</code> object" は、Fetch との相性が良くありません。</p>
      <p class="issue" id="issue-dd85eabd"><a class="self-link" href="#issue-dd85eabd"></a> ここで、"document を生成する際に用いられたリソースの <code>CSP list</code> を <code>Window</code> オブジェクトの <code>CSP list</code> に代入する" といったモンキーパッチが必要です。</p>
     <li data-md="">
      <p>インラインのスクリプト・スタイルを実行・レンダリングしてもよいかを判断するため、アルゴリズム <a href="#should-block-inline">§4.2.3 element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？</a> は <a data-link-type="dfn" href="http://www.w3.org/TR/html5/scripting-1.html#prepare-a-script">prepare a script</a> と <a data-link-type="dfn" href="https://html.spec.whatwg.org/#update-a-style-block">update a <code>style</code> block</a> のアルゴリズム中で呼び出されます。</p>
      <p class="issue" id="issue-f87a8865"><a class="self-link" href="#issue-f87a8865"></a> アルゴリズム <a data-link-type="dfn" href="https://html.spec.whatwg.org/#update-a-style-block">update a <code>style</code> block</a> は W3C’s HTML には存在しません。</p>
      <p class="issue" id="issue-d00ffd43"><a class="self-link" href="#issue-d00ffd43"></a> <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> と <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a></code> の <code>nonce</code> 属性が WHATWG’s HTML に追加されました（<a href="https://github.com/whatwg/html/commit/882803c4cc8fba2fa5472b76f628d95cc82c421d">whatwg/html@882803c</a>）。しかし、まだ W3C’s HTML には追加されていません。</p>
      <p class="issue" id="issue-5cab039f"><a class="self-link" href="#issue-5cab039f"></a> <a href="#should-block-inline">§4.2.3 element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？</a> のフックが WHATWG’s HTML に追加されました（<a href="https://github.com/whatwg/html/commit/ee3486eb129bc350b5ca684d0c91dff23453ac1a">whatwg/html@ee3486e</a>）。しかし、まだ W3C’s HTML には追加されていません。</p>
     <li data-md="">
      <p>アルゴリズム <a href="#should-block-inline">§4.2.3 element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？</a> は、インラインのイベントハンドラ（<code>onclick</code> など）や、インラインの <code>style</code> 属性を処理する過程で呼び出され、これらを実行・レンダリングしてもよいかを判断するのに用いられます。</p>
      <p class="issue" id="issue-64efaac2"><a class="self-link" href="#issue-64efaac2"></a> このフックは現在 WHATWG’s HTML で検討中です。 <a href="https://github.com/WHATWG/html/issues/384">&lt;https://github.com/WHATWG/html/issues/384></a></p>
     <li data-md="">
      <p><a data-link-type="dfn" href="#policy" id="ref-for-policy-22">policies</a> は <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> 要素中の <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a></code> を処理する過程で <a data-link-type="dfn" href="#enforced" id="ref-for-enforced-2">enforced</a> されます。</p>
      <p class="issue" id="issue-689f5c62"><a class="self-link" href="#issue-689f5c62"></a> この処理は WHATWG’s HTML に追加されました（<a href="https://github.com/whatwg/html/commit/5064a629f22bef29839ab4dc6f1ceef17f010bc5">whatwg/html@5064a62</a>）。しかし、まだ W3C’s HTML には追加されていません。</p>
     <li data-md="">
      <p>ある <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> の <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="embedding document" data-noexport="" id="embedding-document">embedding document<span class="dfn-panel" data-deco=""><b><a href="#embedding-document">#embedding-document</a></b><b>Referenced in:</b><span><a href="#ref-for-embedding-document-1">4.2.1.
    Document の CSP list に対する初期化 </a> <a href="#ref-for-embedding-document-2">(2)</a></span><span><a href="#ref-for-embedding-document-3">4.2.2.
    グローバルオブジェクトの CSP list に対する初期化 </a></span></span></dfn> とは、その <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#browsing-context">browsing context</a> が<a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#browsing-context-nested-through">ネストされている</a> <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> です。</p>
    </ol>
    <h4 class="heading settled" data-algorithm="Document の CSP list に対する初期化" data-level="4.2.1" id="initialize-document-csp"><span class="secno">4.2.1. </span><span class="content"> <code>Document</code> の <code>CSP list</code> に対する初期化 </span><a class="self-link" href="#initialize-document-csp"></a></h4>
    <p>ある <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> (<var>document</var>) と <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>) に対し、ユーザエージェントは <var>document</var> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a> を初期化するために以下の処理を実行します。</p>
    <ol>
     <li data-md="">
      <p>ここで <var>response</var> における <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a> だった場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>documents</var> に空リストを代入します。</p>
       <li data-md="">
        <p>ここで <var>document</var> が <a data-link-type="dfn" href="#embedding-document" id="ref-for-embedding-document-1">embedding document</a> (<var>embedding</var>) を持っていた場合、その <var>embedding</var> を <var>documents</var> に追加します。</p>
       <li data-md="">
        <p>ここで <var>document</var> が <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#opener-browsing-context">opener browsing context</a> を持っていた場合、そのブラウジングコンテキストの <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#active-document">active document</a> を <var>documents</var> に追加します。</p>
       <li data-md="">
        <p><var>documents</var> に含まれる各要素 <var>doc</var> のそれぞれについて以下を実行します。</p>
        <ol>
         <li data-md="">
          <p><var>doc</var> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a> に含まれる <var>policy</var> のそれぞれについて以下を実行します。</p>
          <ol>
           <li data-md="">
            <p><var>policy</var> に対するエイリアスを <var>document</var> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a> に挿入します。</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a> には <code>about:</code> も含まれているため、<a data-link-type="dfn" href="#embedding-document" id="ref-for-embedding-document-2">embedding document</a> の有するポリシーのうち、<a data-link-type="dfn" href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe <code>srcdoc</code> <code>Document</code></a> に対するポリシーのエイリアスが挿入されます。</p>
      <p class="note" role="note">Note: このアルゴリズムは、ページが制御するコンテンツ（<code>blob:</code> リソースや <code>document.write()</code>）を含むフレームを埋め込んだり、またはコンテンツを含む新しいウィンドウを開いたりしても、そのページが自身の <a data-link-type="dfn" href="#policy" id="ref-for-policy-23">policy</a> を回避できないことを保障するために実行されます。</p>
     <li data-md="">
      <p><var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> に含まれる <var>policy</var> について、それぞれの <var>policy</var> を <var>document</var> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a> に挿入します。</p>
     <li data-md="">
      <p><var>document</var> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a> に含まれる <var>policy</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>policy</var> に含まれる <var>directive</var> のそれぞれについて以下を実行します。</p>
        <ol>
         <li data-md="">
          <p><var>document</var> と <var>response</var> に対して <var>directive</var> の <a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization-1">initialization</a> アルゴリズムを実行します。</p>
        </ol>
      </ol>
    </ol>
    <h4 class="heading settled" data-algorithm="グローバルオブジェクトの CSP list に対する初期化" data-level="4.2.2" id="initialize-global-object-csp"><span class="secno">4.2.2. </span><span class="content"> グローバルオブジェクトの <code>CSP list</code> に対する初期化 </span><a class="self-link" href="#initialize-global-object-csp"></a></h4>
    <p>ある <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> (<var>global</var>) と <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>) に対し、ユーザエージェントは <var>global</var> の <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list-5">CSP list</a> を初期化するために以下の処理を実行します。</p>
    <ol>
     <li data-md="">
      <p>ここで <var>response</var> における <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a> だった場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>documents</var> に空リストを代入します。</p>
       <li data-md="">
        <p><var>global</var> に含まれる <a data-link-type="dfn" href="https://html.spec.whatwg.org/#the-workers-documents">document</a> のそれぞれを <var>documents</var> に追加します。</p>
       <li data-md="">
        <p><var>documents</var> に含まれる要素 <var>document</var> のそれぞれについて以下を実行します。</p>
        <ol>
         <li data-md="">
          <p><var>document</var> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> が有する <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list-6">CSP list</a> に含まれる要素 <var>policy</var> のそれぞれについて以下を実行します。</p>
          <ol>
           <li data-md="">
            <p><var>policy</var> に対するエイリアスを <var>global</var> の a for="global object">CSP list に挿入します。</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a> には <code>about:</code> も含まれているため、<a data-link-type="dfn" href="#embedding-document" id="ref-for-embedding-document-3">embedding document</a> の有するポリシーのうち、<a data-link-type="dfn" href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe <code>srcdoc</code> <code>Document</code></a> に対するポリシーのエイリアスが挿入されます。</p>
     <li data-md="">
      <p><var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> に含まれる <var>policy</var> について、それぞれの <var>policy</var> を <var>global</var> の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a> に挿入します。</p>
    </ol>
    <h4 class="heading settled" data-algorithm="element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？" data-level="4.2.3" id="should-block-inline"><span class="secno">4.2.3. </span><span class="content"> <var>element</var> においてインラインの <var>type</var> に関する挙動は Content Security Policy によってブロックされるべきか？ </span><a class="self-link" href="#should-block-inline"></a></h4>
    <p>ある <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>) と文字列 (<var>type</var>) に対するこのアルゴリズムは、（スクリプト実行、スタイル適用、イベントハンドラなどといった）特定の挙動に関するインライン定義を、その要素に与えることが許されていれば "Allowed" を返し、そうでなければ "Blocked" を返します。</p>
    <ol>
     <li data-md="">
      <p><var>result</var> に "<code>Allowed</code>" を代入します。</p>
     <li data-md="">
      <p><var>element</var> の <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> が持つ <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> の <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list-7">CSP list</a> に含まれる要素 <var>policy</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>policy</var> に含まれる <var>directive</var> のそれぞれについて以下を実行します。</p>
        <ol>
         <li data-md="">
          <p>ここで <var>element</var> と <var>type</var> に対して <var>directive</var> の <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check-1">inline check</a> を実行した結果が "<code>Allowed</code>" だった場合、以下の処理を飛ばして次の <var>directive</var> に移ります。</p>
         <li data-md="">
          <p>"<code>Allowed</code>" ではなく、かつ <var>type</var> が "<code>style</code>" か "<code>style-attribute</code>" のどちらかである、または "<code>script-src</code>" 以外である場合、<a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a> と <var>policy</var> と "<code>style-src</code>" に対して <a href="#create-violation-for-global">§2.3.1 global、policy、directive に対する violation オブジェクトの生成</a> を適用し、その結果を <var>violation</var> に代入します。</p>
         <li data-md="">
          <p><var>violation</var> の <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource-3">resource</a> に "<code>inline</code>" を代入します。</p>
         <li data-md="">
          <p><var>violation</var> に対して <a href="#report-violation">§5.3 violation を報告する</a> を適用します。</p>
         <li data-md="">
          <p>ここで <var>policy</var> の <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition-8">disposition</a> が "<code>enforce</code>" だった場合、<var>result</var> に "<code>Blocked</code>" を代入します。</p>
        </ol>
      </ol>
     <li data-md="">
      <p><var>result</var> を返します。</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="reporting"><span class="secno">5. </span><span class="content"> 報告 </span><a class="self-link" href="#reporting"></a></h2>
    <p>1 つ以上の <a data-link-type="dfn" href="#policy" id="ref-for-policy-24">policy</a> のディレクティブが違反を受けた際、<dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="violation report" data-noexport="" id="violation-report">violation report<span class="dfn-panel" data-deco=""><b><a href="#violation-report">#violation-report</a></b><b>Referenced in:</b><span><a href="#ref-for-violation-report-1">6.2.1. report-uri</a></span></span></dfn> を作成して <a data-link-type="dfn" href="#policy" id="ref-for-policy-25">policy</a> における reporting endpoint に送信することができます。</p>
    <h3 class="heading settled" data-level="5.1" id="violation-events"><span class="secno">5.1. </span><span class="content"> Violation DOM イベント </span><a class="self-link" href="#violation-events"></a></h3>
<pre class="idl def">[<dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="constructor" data-export="" data-lt="SecurityPolicyViolationEvent(type, eventInitDict)|SecurityPolicyViolationEvent(type)" id="dom-securitypolicyviolationevent-securitypolicyviolationevent">Constructor<a class="self-link" href="#dom-securitypolicyviolationevent-securitypolicyviolationevent"></a></dfn>(DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict)" data-dfn-type="argument" data-export="" id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type">type<a class="self-link" href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type"></a></dfn>, optional <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit" id="ref-for-dictdef-securitypolicyviolationeventinit-1">SecurityPolicyViolationEventInit</a> <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict)" data-dfn-type="argument" data-export="" id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict">eventInitDict<a class="self-link" href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict"></a></dfn>)]
interface <a class="idl-code" data-link-type="interface" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent-1">SecurityPolicyViolationEvent</a> : <a data-link-type="idl-name">Event</a> {
    readonly    attribute DOMString      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="documentURI" data-readonly="" data-type="DOMString      " id="dom-securitypolicyviolationevent-documenturi">documentURI<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-documenturi">#dom-securitypolicyviolationevent-documenturi</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-documenturi-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
    readonly    attribute DOMString      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="referrer" data-readonly="" data-type="DOMString      " id="dom-securitypolicyviolationevent-referrer">referrer<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-referrer">#dom-securitypolicyviolationevent-referrer</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-referrer-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
    readonly    attribute DOMString      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="blockedURI" data-readonly="" data-type="DOMString      " id="dom-securitypolicyviolationevent-blockeduri">blockedURI<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-blockeduri">#dom-securitypolicyviolationevent-blockeduri</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-blockeduri-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
    readonly    attribute DOMString      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="violatedDirective" data-readonly="" data-type="DOMString      " id="dom-securitypolicyviolationevent-violateddirective">violatedDirective<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-violateddirective">#dom-securitypolicyviolationevent-violateddirective</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-violateddirective-1">5.3.
    violation を報告する
  </a> <a href="#ref-for-dom-securitypolicyviolationevent-violateddirective-2">(2)</a></span></span></dfn>;
    readonly    attribute DOMString      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="effectiveDirective" data-readonly="" data-type="DOMString      " id="dom-securitypolicyviolationevent-effectivedirective">effectiveDirective<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-effectivedirective">#dom-securitypolicyviolationevent-effectivedirective</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-effectivedirective-1">5.3.
    violation を報告する
  </a> <a href="#ref-for-dom-securitypolicyviolationevent-effectivedirective-2">(2)</a></span></span></dfn>;
    readonly    attribute DOMString      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="originalPolicy" data-readonly="" data-type="DOMString      " id="dom-securitypolicyviolationevent-originalpolicy">originalPolicy<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-originalpolicy">#dom-securitypolicyviolationevent-originalpolicy</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-originalpolicy-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
    readonly    attribute DOMString      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="sourceFile" data-readonly="" data-type="DOMString      " id="dom-securitypolicyviolationevent-sourcefile">sourceFile<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-sourcefile">#dom-securitypolicyviolationevent-sourcefile</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-sourcefile-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
    readonly    attribute unsigned short <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="statusCode" data-readonly="" data-type="unsigned short " id="dom-securitypolicyviolationevent-statuscode">statusCode<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-statuscode">#dom-securitypolicyviolationevent-statuscode</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-statuscode-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
    readonly    attribute long           <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="lineNumber" data-readonly="" data-type="long           " id="dom-securitypolicyviolationevent-linenumber">lineNumber<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-linenumber">#dom-securitypolicyviolationevent-linenumber</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-linenumber-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
    readonly    attribute long           <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-lt="columnNumber" data-readonly="" data-type="long           " id="dom-securitypolicyviolationevent-columnnumber">columnNumber<span class="dfn-panel" data-deco=""><b><a href="#dom-securitypolicyviolationevent-columnnumber">#dom-securitypolicyviolationevent-columnnumber</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-securitypolicyviolationevent-columnnumber-1">5.3.
    violation を報告する
  </a></span></span></dfn>;
};

dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="SecurityPolicyViolationEventInit" id="dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit<span class="dfn-panel" data-deco=""><b><a href="#dictdef-securitypolicyviolationeventinit">#dictdef-securitypolicyviolationeventinit</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-securitypolicyviolationeventinit-1">5.1.
    Violation DOM イベント
  </a></span></span></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a> {
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-documenturi">documentURI<a class="self-link" href="#dom-securitypolicyviolationeventinit-documenturi"></a></dfn>;
    DOMString      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString      " id="dom-securitypolicyviolationeventinit-referrer">referrer<a class="self-link" href="#dom-securitypolicyviolationeventinit-referrer"></a></dfn>;
    DOMString      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString      " id="dom-securitypolicyviolationeventinit-blockeduri">blockedURI<a class="self-link" href="#dom-securitypolicyviolationeventinit-blockeduri"></a></dfn>;
    DOMString      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString      " id="dom-securitypolicyviolationeventinit-violateddirective">violatedDirective<a class="self-link" href="#dom-securitypolicyviolationeventinit-violateddirective"></a></dfn>;
    DOMString      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString      " id="dom-securitypolicyviolationeventinit-effectivedirective">effectiveDirective<a class="self-link" href="#dom-securitypolicyviolationeventinit-effectivedirective"></a></dfn>;
    DOMString      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString      " id="dom-securitypolicyviolationeventinit-originalpolicy">originalPolicy<a class="self-link" href="#dom-securitypolicyviolationeventinit-originalpolicy"></a></dfn>;
    DOMString      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString      " id="dom-securitypolicyviolationeventinit-sourcefile">sourceFile<a class="self-link" href="#dom-securitypolicyviolationeventinit-sourcefile"></a></dfn>;
    unsigned short <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="unsigned short " id="dom-securitypolicyviolationeventinit-statuscode">statusCode<a class="self-link" href="#dom-securitypolicyviolationeventinit-statuscode"></a></dfn>;
    long           <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="long           " id="dom-securitypolicyviolationeventinit-linenumber">lineNumber<a class="self-link" href="#dom-securitypolicyviolationeventinit-linenumber"></a></dfn>;
    long           <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="long           " id="dom-securitypolicyviolationeventinit-columnnumber">columnNumber<a class="self-link" href="#dom-securitypolicyviolationeventinit-columnnumber"></a></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="5.2" id="deprecated-serialize-violation"><span class="secno">5.2. </span><span class="content"> <var>violation</var> を廃止された方法でシリアライズしたものを取得する </span><a class="self-link" href="#deprecated-serialize-violation"></a></h3>
    <p>ある <a data-link-type="dfn" href="#violation" id="ref-for-violation-14">violation</a> (<var>violation</var>) に対して、このアルゴリズムは JSON 文字列で表現された violation を返します。この JSON テキストは、廃止された <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri-1"><code>report-uri</code></a> ディレクティブに指定する reporting endpoint への送信に適しています。</p>
    <ol>
     <li data-md="">
      <p>以下に従ってプロパティを初期化した JavaScript オブジェクトを新しく作成し、それを <var>object</var> に代入します。</p>
      <dl>
       <dt data-md="">
        <p>"<code>document-uri</code>"</p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url-1">url</a> について、<code>exclude fragment</code> フラグをセットした状態で <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> を実行し、その結果を格納します。</p>
       <dt data-md="">
        <p>"<code>referrer</code>"</p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-referrer" id="ref-for-violation-referrer-2">referrer</a> について、<code>exclude fragment</code> フラグをセットした状態で <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> を実行し、その結果を格納します。</p>
       <dt data-md="">
        <p>"<code>blocked-uri</code>"</p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource-4">resource</a> について、<code>exclude fragment</code> フラグをセットした状態で <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> を実行し、その結果を格納します。</p>
       <dt data-md="">
        <p>"<code>effective-directive</code>"</p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive-2">effective directive</a> を格納します。</p>
       <dt data-md="">
        <p>"<code>violated-directive</code>"</p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive-3">effective directive</a> を格納します。</p>
       <dt data-md="">
        <p>"<code>original-policy</code>"</p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy-2">policy</a> における <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp-8">serialization</a> を格納します。</p>
       <dt data-md="">
        <p>"<code>status-code</code>"</p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-status" id="ref-for-violation-status-2">status</a> を格納します。</p>
      </dl>
     <li data-md="">
      <p>ここで <var>violation</var> の <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file-2">source file</a> が <code>null</code> ではなかった場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file-3">source file</a> について、<code>exclude fragment</code> フラグをセットした状態で <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> を実行し、その結果を <var>object</var> の "<code>source-file</code>" プロパティに代入します。</p>
       <li data-md="">
        <p><var>object</var> の "<code>line-number</code>" プロパティに <var>violation</var> の <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number-2">line number</a> を代入します。</p>
       <li data-md="">
        <p><var>object</var> の "<code>column-number</code>" プロパティに <var>violation</var> の <a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number-2">column number</a> を代入します。</p>
      </ol>
     <li data-md="">
      <p><var>object</var> に <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-json.stringify">JSON.stringify()</a></code> を実行した結果を返します。</p>
    </ol>
    <h3 class="heading settled" data-level="5.3" id="report-violation"><span class="secno">5.3. </span><span class="content"> <var>violation</var> を報告する </span><a class="self-link" href="#report-violation"></a></h3>
    <p>ある <a data-link-type="dfn" href="#violation" id="ref-for-violation-15">violation</a> (<var>violation</var>) に対するこのアルゴリズムは、<var>violation</var> の <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy-3">policy</a> で指定したエンドポイントに <a data-link-type="dfn" href="#violation" id="ref-for-violation-16">violation</a> を報告し、<var>violation</var> の <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object-4">global object</a> における <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="SecurityPolicyViolationEvent" id="securitypolicyviolationevent">SecurityPolicyViolationEvent<span class="dfn-panel" data-deco=""><b><a href="#securitypolicyviolationevent">#securitypolicyviolationevent</a></b><b>Referenced in:</b><span><a href="#ref-for-securitypolicyviolationevent-1">5.1.
    Violation DOM イベント </a></span><span><a href="#ref-for-securitypolicyviolationevent-2">5.3.
    violation を報告する </a></span></span></dfn> を発火させます。</p>
    <ol>
     <li data-md="">
      <p>以下のように属性値を初期化した <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent-2">SecurityPolicyViolationEvent</a></code> インターフェイスを用いて、<code>securitypolicyviolation</code> という名前の <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-trusted">trusted</a> イベントを <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-fire">fire</a> します。</p>
      <dl>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-documenturi" id="ref-for-dom-securitypolicyviolationevent-documenturi-1">documentURI</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url-2">url</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-referrer" id="ref-for-dom-securitypolicyviolationevent-referrer-1">referrer</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-referrer" id="ref-for-violation-referrer-3">referrer</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-blockeduri" id="ref-for-dom-securitypolicyviolationevent-blockeduri-1">blockedURI</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource-5">resource</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective-1">effectiveDirective</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive-4">effective directive</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-violateddirective" id="ref-for-dom-securitypolicyviolationevent-violateddirective-1">violatedDirective</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive-5">effective directive</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-originalpolicy" id="ref-for-dom-securitypolicyviolationevent-originalpolicy-1">originalPolicy</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy-4">policy</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sourcefile" id="ref-for-dom-securitypolicyviolationevent-sourcefile-1">sourceFile</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file-4">source file</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-statuscode" id="ref-for-dom-securitypolicyviolationevent-statuscode-1">statusCode</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-status" id="ref-for-violation-status-3">status</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-linenumber" id="ref-for-dom-securitypolicyviolationevent-linenumber-1">lineNumber</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number-3">line number</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-columnnumber" id="ref-for-dom-securitypolicyviolationevent-columnnumber-1">columnNumber</a></code></p>
       <dd data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number-3">column number</a></p>
      </dl>
      <p class="note" role="note">Note: <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective-2">effectiveDirective</a></code> と <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-violateddirective" id="ref-for-dom-securitypolicyviolationevent-violateddirective-2">violatedDirective</a></code> には同じ値が格納されます。これは後方互換性が保たれるよう意図したものです。</p>
     <li data-md="">
      <p>ここで <var>violation</var> の <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy-5">policy</a> における <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-6">directive set</a> に "<a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri-2"><code>report-uri</code></a>" という <a data-link-type="dfn" href="#directives" id="ref-for-directives-9">directive</a> (<var>directive</var>) が含まれていた場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで <var>violation</var> の <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy-6">policy</a> における <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-7">directive set</a> に "<a data-link-type="dfn" href="#report-to" id="ref-for-report-to-1"><code>report-to</code></a>" という <a data-link-type="dfn" href="#directives" id="ref-for-directives-10">directive</a> が含まれていた場合、残りの副手続きを飛ばします。</p>
       <li data-md="">
        <p><var>directive</var> の <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-5">value</a> に対して <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser">URL parser</a> を適用した結果を <var>endpoint</var> に代入します。</p>
       <li data-md="">
        <p>ここで <var>endpoint</var> が有効な URL でなかった場合、残りの副手続きを飛ばします。</p>
       <li data-md="">
        <p>新しい <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> を以下に従って初期化し、<var>request</var> に代入します。</p>
        <dl>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method">method</a></p>
         <dd data-md="">
          <p>"<code>POST</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a></p>
         <dd data-md="">
          <p><var>violation</var> の <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url-3">url</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin">origin</a></p>
         <dd data-md="">
          <p><var>violation</var> の <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object-5">global object</a> における <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window">window</a></p>
         <dd data-md="">
          <p>"<code>no-window</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a></p>
         <dd data-md="">
          <p><var>violation</var> の <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object-6">global object</a> における <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings object</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a></p>
         <dd data-md="">
          <p>""</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a></p>
         <dd data-md="">
          <p>""</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a></p>
         <dd data-md="">
          <p>""</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-cache-mode">cache mode</a></p>
         <dd data-md="">
          <p>"<code>no-cache</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode">credentials mode</a></p>
         <dd data-md="">
          <p>"<code>same-origin</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list">header list</a></p>
         <dd data-md="">
          <p>名前を "<code>Content-Type</code>"、値を "<code>application/csp-report</code>" とした単一のヘッダを含む <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list">header list</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body">body</a></p>
         <dd data-md="">
          <p><var>violation</var> に <a href="#deprecated-serialize-violation">§5.2 violation を廃止された方法でシリアライズしたものを取得する</a> を適用した結果</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode">redirect mode</a></p>
         <dd data-md="">
          <p>"<code>error</code>"</p>
        </dl>
       <li data-md="">
        <p><var>request</var> を <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch">fetch</a> します。ここでの実行結果は無視されます。</p>
      </ol>
      <p class="note" role="note">Note: この箇所はすべて廃止されたものと考えるべきです。ここでは 1 つの violation につき 1 つのリクエストを送信しており、単純にスケールできません。この箇所の動作をユーザエージェントから削除できる状態になれば廃止されることになります。</p>
      <p class="note" role="note">Note: <code>report-uri</code> は <code>report-to</code> が無い場合のみ有効になります。すなわち後者は前者を上書きするため、この新しい仕組みをサポートしていないブラウザへの後方互換性が保たれます。</p>
     <li data-md="">
      <p>ここで <var>violation</var> の <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy-7">policy</a> における <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set-8">directive set</a> に "<a data-link-type="dfn" href="#report-to" id="ref-for-report-to-2"><code>report-to</code></a>" という <a data-link-type="dfn" href="#directives" id="ref-for-directives-11">directive</a> (<var>directive</var>) が含まれていた場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>directive</var> の <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-6">value</a> を <var>group</var> に代入します。</p>
       <li data-md="">
        <p><var>violation</var> の <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object-7">global object</a> における <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings object</a> を <var>settings object</var> に代入します。</p>
       <li data-md="">
        <p><a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a> の <a data-link-type="dfn" href="https://mikewest.github.io/error-reporting/#queue-report">Queue <var>data</var> as <var>type</var> for <var>endpoint group</var> on <var>settings</var></a> アルゴリズムに以下の引数を与えて実行します。</p>
        <dl>
         <dt data-md="">
          <p><var>data</var></p>
         <dd data-md="">
          <p><var>violation</var></p>
         <dt data-md="">
          <p><var>type</var></p>
         <dd data-md="">
          <p>"CSP"</p>
         <dt data-md="">
          <p><var>endpoint group</var></p>
         <dd data-md="">
          <p><var>group</var></p>
         <dt data-md="">
          <p><var>settings</var></p>
         <dd data-md="">
          <p><var>settings object</var></p>
        </dl>
      </ol>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="csp-directives"><span class="secno">6. </span><span class="content"> Content Security Policy のディレクティブ </span><a class="self-link" href="#csp-directives"></a></h2>
    <p>この仕様書では <a data-link-type="dfn" href="#directives" id="ref-for-directives-12">directives</a> の種類が数多く定義されています。これらのディレクティブを用いることで、Web サイトの動作を開発者が制御できるようになります。この文書では、リソースの取得を制御するディレクティブ（<a href="#directives-fetch">§6.1 Fetch ディレクティブ群</a>）と、報告を制御するディレクティブ（<a href="#directives-reporting">§6.2 Reporting Directives</a>）が定義されます。これらのディレクティブは Content Security Policy の核を形成するものであり、他のディレクティブはモジュールとして付随文書で定義されます（使用例は <a href="#directives-elsewhere">§6.3 他の文書で定義されるディレクティブ</a> を参照してください）。</p>
    <p>クロスサイトスクリプティング攻撃のリスクを軽減するため、Web 開発者はスクリプトやプラグインの読込元を制限するディレクティブを含めるべきです（SHOULD）。これは以下のディレクティブを指定することで実現できます。</p>
    <ul>
     <li data-md="">
      <p><a data-link-type="dfn" href="#script-src" id="ref-for-script-src-1">script-src</a> と <a data-link-type="dfn" href="#object-src" id="ref-for-object-src-1">object-src</a> ディレクティブの両方、または</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="#default-src" id="ref-for-default-src-1">default-src</a> ディレクティブ</p>
    </ul>
    <p>どちらの場合でも、開発者はポリシーの中に <a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline-1"><code>'unsafe-inline'</code></a> や <code>data:</code> を有効な読込元に含めるべきではありません（SHOULD NOT）。これらを指定すると、XSS 攻撃によってコードが直接ドキュメントの中に差し込まれる隙が生まれるため、どちらも全く使用しないことがベストです。</p>
    <h3 class="heading settled" data-level="6.1" id="directives-fetch"><span class="secno">6.1. </span><span class="content"> Fetch ディレクティブ群 </span><a class="self-link" href="#directives-fetch"></a></h3>
    <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="Fetch directives" data-noexport="" id="fetch-directives">Fetch directives<span class="dfn-panel" data-deco=""><b><a href="#fetch-directives">#fetch-directives</a></b><b>Referenced in:</b><span><a href="#ref-for-fetch-directives-1">6.1.3. default-src</a> <a href="#ref-for-fetch-directives-2">(2)</a></span><span><a href="#ref-for-fetch-directives-3">6.1.11.4.
    request の effective directive を得る </a></span></span></dfn> を用いると、ポリシーを適用させたいリソースの種類を指定したうえで、そのリソースの読込元を制御することができます。例えば <a data-link-type="dfn" href="#script-src" id="ref-for-script-src-2">script-src</a> を用いた場合、ページ上で実行可能なスクリプトについて、信頼できる読込元をホワイトリスト化することができます。一方 <a data-link-type="dfn" href="#font-src" id="ref-for-font-src-1">font-src</a> を用いた場合は、Web フォントの読込元を制御することができます。</p>
    <h4 class="heading settled" data-level="6.1.1" id="directive-child-src"><span class="secno">6.1.1. </span><span class="content"><code>child-src</code></span><a class="self-link" href="#directive-child-src"></a></h4>
    <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="child-src" data-noexport="" id="child-src">child-src<span class="dfn-panel" data-deco=""><b><a href="#child-src">#child-src</a></b><b>Referenced in:</b><span><a href="#ref-for-child-src-1">6.1.1. child-src</a></span><span><a href="#ref-for-child-src-2">6.1.3. default-src</a> <a href="#ref-for-child-src-3">(2)</a></span></span></dfn> ディレクティブを用いると、<a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing contexts</a> （<code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a></code> や <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#frame">frame</a></code> によるナビゲーションなど）の生成を制御したり、Worker の実行されるコンテキストを制御することができます。このディレクティブの名前と値に関する構文は、以下の ABNF で表現されます。</p>
<pre>directive-name  = "child-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-1">serialized-source-list</a>
</pre>
    <p>このディレクティブは、フレームや Worker を生成する <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> を制御します。より形式的に言えば、<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> は以下の種類のうちどれか一つに分類されます。</p>
    <ul>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> が "<code>document</code>" であり、かつその <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context">target browsing context</a> が <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing
 context</a>（<code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a></code> や <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#frame">frame</a></code> 要素の中にデータを読み込むリクエストなど）であるもの</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> が "<code>serviceworker</code>"、"<code>sharedworker</code>"、"<code>worker</code>" のいずれかであるもの（これらは各々 <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/service-workers/#service-worker-interface">ServiceWorker</a></code>、<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker">SharedWorker</a></code>、<code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code> における <a data-link-type="dfn" href="https://html.spec.whatwg.org/#run-a-worker">run a worker</a> アルゴリズムに適用されます）</p>
    </ul>
    <div class="example" id="example-0322d4bb">
     <a class="self-link" href="#example-0322d4bb"></a> 次の Content Security Policy が適用される Web ページを考えます。
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#child-src" id="ref-for-child-src-1">child-src</a> https://example.com/
</pre>
     <p>以下のコードによって生じた通信は、指定されている URL が <code>child-src</code> の <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-1">source list</a> にマッチしないため、すべてネットワークエラーが返されます。</p>
<pre>&lt;iframe src="https://not-example.com">&lt;/iframe>
&lt;script>
  var blockedWorker = new Worker("data:application/javascript,...");
&lt;/script>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.1.1" id="child-src-algorithms"><span class="secno">6.1.1.1. </span><span class="content">アルゴリズム</span><a class="self-link" href="#child-src-algorithms"></a></h5>
    <p>このディレクティブの <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-1">pre-request check</a> は次の通りです。</p>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) に対して以下を実行します。</p>
    <p class="issue" id="issue-95f2d23a"><a class="self-link" href="#issue-95f2d23a"></a> TODO.</p>
    <p>このディレクティブの <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-2">post-request check</a> は次の通りです。</p>
    <p class="issue" id="issue-95f2d23a0"><a class="self-link" href="#issue-95f2d23a0"></a> TODO.</p>
    <h4 class="heading settled" data-level="6.1.2" id="directive-connect-src"><span class="secno">6.1.2. </span><span class="content"><code>connect-src</code></span><a class="self-link" href="#directive-connect-src"></a></h4>
    <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="connect-src" data-noexport="" id="connect-src">connect-src<span class="dfn-panel" data-deco=""><b><a href="#connect-src">#connect-src</a></b><b>Referenced in:</b><span><a href="#ref-for-connect-src-1">6.1.2. connect-src</a></span><span><a href="#ref-for-connect-src-2">6.1.3. default-src</a> <a href="#ref-for-connect-src-3">(2)</a></span></span></dfn> ディレクティブを用いると、スクリプトのインターフェイスを利用して読み込む URL を制御することができます。このディレクティブの名前と値に関する構文は、以下の ABNF で表現されます。</p>
<pre>directive-name  = "connect-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-2">serialized-source-list</a>
</pre>
    <p>このディレクティブでは、他のオリジンとデータを送受信する <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> を制御します。この <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> は、<code>fetch()</code> や <a data-link-type="biblio" href="#biblio-xhr">[XHR]</a>、<a data-link-type="biblio" href="#biblio-eventsource">[EVENTSOURCE]</a>、<a data-link-type="biblio" href="#biblio-beacon">[BEACON]</a>、そして <code><a data-link-type="element" href="http://www.w3.org/TR/html5/text-level-semantics.html#the-a-element">a</a></code> 要素の <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/#ping">ping</a></code> 属性といった API を経由して生成されるものです。<em>加えて</em>、技術的には Fetch と異なるものの、<code>connect-src</code> ディレクティブは WebSocket <a data-link-type="biblio" href="#biblio-websockets">[WEBSOCKETS]</a> の接続も制御します。</p>
    <div class="example" id="example-0e1bac72">
     <a class="self-link" href="#example-0e1bac72"></a> JavaScript においては、外部のサーバと直接に接続してデータを送受信できる仕組みがいくつか用意されています。プッシュ通知を受信できるようにサーバとの通信を管理する <code>EventSource</code>、ブラウザとサーバとの間に双方向の通信路を確立する <code>WebSockets</code>、そしてユーザに代わって任意の HTTP リクエストを生成する <code>XMLHttpRequest</code> といった具合です。こういった強力な API によって利便性が向上する一方、データを窃取する巧妙な手法も編み出されています。
     <p><code>connect-src</code> ディレクティブを用いることで、こういった類の接続先を信頼できるオリジンのみに制限することができます。このディレクティブに関しては、必要な source expressions を定義してポリシーを送信するのは単純な作業で済みます。例として、接続先を <code>https://example.com</code> のみに限定したい場合は、次のようなヘッダを送信することになります。</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src-1">connect-src</a> https://example.com/
</pre>
     <p>以下のコードを用いて接続を試みると、<code>connect-src</code> の <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-2">source list</a> と URL がマッチしないため、すべてネットワークエラーが返されます。</p>
<pre>&lt;a ping="https://not-example.com">...
&lt;script>
  var xhr = new XMLHttpRequest();
  xhr.open('GET', 'https://not-example.com/');
  xhr.send();

  var ws = new WebSocket("https://not-example.com/");

  var es = new EventSource("https://not-example.com/");

  navigator.sendBeacon("https://not-example.com/", { ... });
&lt;/script>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.2.1" id="connect-src-algorithms"><span class="secno">6.1.2.1. </span><span class="content">アルゴリズム</span><a class="self-link" href="#connect-src-algorithms"></a></h5>
    <p>このディレクティブにおける <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-2">pre-request check</a> は以下の通りです。</p>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) と <a data-link-type="dfn" href="#policy" id="ref-for-policy-26">policy</a> (<var>policy</var>) に対して、以下を実行します。</p>
    <ol>
     <li data-md="">
      <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> が "<code>fetch</code>" だった場合、または <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> が "" かつ <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> が "<code>subresource</code>" だった場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> とディレクティブの <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-7">value</a> に対して <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> を適用し、その実行結果が "<code>Does Not Match</code>" だった場合、"<code>Blocked</code>" を返します。</p>
      </ol>
     <li data-md="">
      <p>"<code>Allowed</code>" を返します。</p>
    </ol>
    <p>このディレクティブにおける <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-3">post-request check</a> は以下の通りです。</p>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) と <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>) と <a data-link-type="dfn" href="#policy" id="ref-for-policy-27">policy</a> (<var>policy</var>) に対して、以下を実行します。</p>
    <ol>
     <li data-md="">
      <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> が "<code>fetch</code>" だった場合、または <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> が "" かつ <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> が "<code>subresource</code>" だった場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで <var>response</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> とディレクティブの <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-8">value</a> に対して <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> を適用し、その実行結果が "<code>Does Not Match</code>" だった場合、"<code>Blocked</code>" を返します。</p>
      </ol>
     <li data-md="">
      <p>"<code>Allowed</code>" を返します。</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.3" id="directive-default-src"><span class="secno">6.1.3. </span><span class="content"><code>default-src</code></span><a class="self-link" href="#directive-default-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="default-src" data-noexport="" id="default-src">default-src<span class="dfn-panel" data-deco=""><b><a href="#default-src">#default-src</a></b><b>Referenced in:</b><span><a href="#ref-for-default-src-1">6.
    Content Security Policy のディレクティブ </a></span><span><a href="#ref-for-default-src-2">6.1.3. default-src</a> <a href="#ref-for-default-src-3">(2)</a> <a href="#ref-for-default-src-4">(3)</a></span></span></dfn> directive serves as a fallback for the other <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives-1">fetch directives</a>. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "default-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-3">serialized-source-list</a>
</pre>
    <p>If a <a data-link-type="dfn" href="#default-src" id="ref-for-default-src-2">default-src</a> directive is present in a policy, its value will be
  used as the policy’s default source list. That is, given <code>default-src 'none'; script-src 'self'</code>, script requests will use <code>'self'</code> as the <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-3">source
  list</a> to match against. Other requests will use <code>'none'</code>. This is spelled
  out in more detail in the <a href="#should-block-request">§4.1.3 request は Content Security Policy によってブロックされるべきか？</a> and <a href="#should-block-response">§4.1.4 request に対する response は Content Security Policy によってブロックされるべきか？</a> algorithms.</p>
    <div class="example" id="example-0f144ac9">
     <a class="self-link" href="#example-0f144ac9"></a> The following header:
<pre><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy-2">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src-3">default-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-2">'self'</a>
</pre>
     <p>will have the same behavior as the following header:</p>
<pre><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy-3">Content-Security-Policy</a>: <a data-link-type="dfn" href="#child-src" id="ref-for-child-src-2">child-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-3">'self'</a>;
                         <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src-2">connect-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-4">'self'</a>;
                         <a data-link-type="dfn" href="#font-src" id="ref-for-font-src-2">font-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-5">'self'</a>;
                         <a data-link-type="dfn" href="#img-src" id="ref-for-img-src-1">img-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-6">'self'</a>;
                         <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src-1">manifest-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-7">'self'</a>;
                         <a data-link-type="dfn" href="#media-src" id="ref-for-media-src-1">media-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-8">'self'</a>;
                         <a data-link-type="dfn" href="#object-src" id="ref-for-object-src-2">object-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-9">'self'</a>;
                         <a data-link-type="dfn" href="#script-src" id="ref-for-script-src-3">script-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-10">'self'</a>;
                         <a data-link-type="dfn" href="#style-src" id="ref-for-style-src-1">style-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-11">'self'</a>
</pre>
     <p>That is, when <code>default-src</code> is set, every <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives-2">fetch directive</a> that isn’t
    explicitly set will fall back to the value <code>default-src</code> specifies.</p>
    </div>
    <div class="example" id="example-dd396889">
     <a class="self-link" href="#example-dd396889"></a> There is no inheritance. If a <code>script-src</code> directive is explicitly
    specified, for example, then the value of <code>default-src</code> has no influence on
    script requests. That is, the following header:
<pre><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy-4">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src-4">default-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-12">'self'</a>; <a data-link-type="dfn" href="#script-src" id="ref-for-script-src-4">script-src</a> https://example.com
</pre>
     <p>will have the same behavior as the following header:</p>
<pre><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy-5">Content-Security-Policy</a>: <a data-link-type="dfn" href="#child-src" id="ref-for-child-src-3">child-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-13">'self'</a>;
                         <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src-3">connect-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-14">'self'</a>;
                         <a data-link-type="dfn" href="#font-src" id="ref-for-font-src-3">font-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-15">'self'</a>;
                         <a data-link-type="dfn" href="#img-src" id="ref-for-img-src-2">img-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-16">'self'</a>;
                         <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src-2">manifest-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-17">'self'</a>;
                         <a data-link-type="dfn" href="#media-src" id="ref-for-media-src-2">media-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-18">'self'</a>;
                         <a data-link-type="dfn" href="#object-src" id="ref-for-object-src-3">object-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-19">'self'</a>;
                         <a data-link-type="dfn" href="#script-src" id="ref-for-script-src-5">script-src</a> https://example.com;
                         <a data-link-type="dfn" href="#style-src" id="ref-for-style-src-2">style-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self-20">'self'</a>
</pre>
     <p>Given this behavior, one good way to build a policy for a site would be to
    begin with a <code>default-src</code> of <code>'none'</code>, and to build up a policy from there
    which allowed only those resource types which are necessary for the
    particular page the policy will apply to.</p>
    </div>
    <h5 class="heading settled" data-level="6.1.3.1" id="default-src-algorithms"><span class="secno">6.1.3.1. </span><span class="content">Algorithms</span><a class="self-link" href="#default-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-3">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-28">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§6.1.11.4 request の effective directive を得る</a> on <var>request</var>.</p>
     <li data-md="">
      <p>If <var>name</var> is <code>null</code>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If <var>policy</var> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives-13">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name-4">name</a> is <var>name</var>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-9">value</a> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-4">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-29">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§6.1.11.4 request の effective directive を得る</a> on <var>request</var>.</p>
     <li data-md="">
      <p>If <var>name</var> is <code>null</code>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If <var>policy</var> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives-14">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name-5">name</a> is <var>name</var>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-10">value</a> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.4" id="directive-font-src"><span class="secno">6.1.4. </span><span class="content"><code>font-src</code></span><a class="self-link" href="#directive-font-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="font-src" data-noexport="" id="font-src">font-src<span class="dfn-panel" data-deco=""><b><a href="#font-src">#font-src</a></b><b>Referenced in:</b><span><a href="#ref-for-font-src-1">6.1.
    Fetch ディレクティブ群 </a></span><span><a href="#ref-for-font-src-2">6.1.3. default-src</a> <a href="#ref-for-font-src-3">(2)</a></span><span><a href="#ref-for-font-src-4">6.1.4. font-src</a></span></span></dfn> directive restricts the URLs from which font resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "font-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-4">serialized-source-list</a>
</pre>
    <div class="example" id="example-38056220">
     <a class="self-link" href="#example-38056220"></a> Given a page with the following Content Security Policy:
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#font-src" id="ref-for-font-src-4">font-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>font-src</code>'s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-4">source list</a>:</p>
<pre>&lt;style>
  @font-face {
    font-family: "Example Font";
    src: url("https://not-example.com/font");
  }
  body {
    font-family: "Example Font";
  }
&lt;/style>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.4.1" id="font-src-algorithms"><span class="secno">6.1.4.1. </span><span class="content">Algorithms</span><a class="self-link" href="#font-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-4">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-30">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>font</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-11">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-5">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-31">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>font</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-12">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.5" id="directive-img-src"><span class="secno">6.1.5. </span><span class="content"><code>img-src</code></span><a class="self-link" href="#directive-img-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="img-src" data-noexport="" id="img-src">img-src<span class="dfn-panel" data-deco=""><b><a href="#img-src">#img-src</a></b><b>Referenced in:</b><span><a href="#ref-for-img-src-1">6.1.3. default-src</a> <a href="#ref-for-img-src-2">(2)</a></span><span><a href="#ref-for-img-src-3">6.1.5. img-src</a></span></span></dfn> directive restricts the URLs from which image resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "img-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-5">serialized-source-list</a>
</pre>
    <p>This directive controls <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> which load images. More formally, this
  includes <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>image</code>" <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>.</p>
    <div class="example" id="example-8e5ffeae">
     <a class="self-link" href="#example-8e5ffeae"></a> Given a page with the following Content Security Policy:
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#img-src" id="ref-for-img-src-3">img-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>img-src</code>'s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-5">source list</a>:</p>
<pre>&lt;img src="https://not-example.com/img">
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.5.1" id="img-src-algorithms"><span class="secno">6.1.5.1. </span><span class="content">Algorithms</span><a class="self-link" href="#img-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-5">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-32">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>image</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-13">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-6">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-33">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>image</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-14">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.6" id="directive-manifest-src"><span class="secno">6.1.6. </span><span class="content"><code>manifest-src</code></span><a class="self-link" href="#directive-manifest-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="manifest-src" data-noexport="" id="manifest-src">manifest-src<span class="dfn-panel" data-deco=""><b><a href="#manifest-src">#manifest-src</a></b><b>Referenced in:</b><span><a href="#ref-for-manifest-src-1">6.1.3. default-src</a> <a href="#ref-for-manifest-src-2">(2)</a></span><span><a href="#ref-for-manifest-src-3">6.1.6. manifest-src</a></span></span></dfn> directive restricts the URLs from which application
  manifests may be loaded <a data-link-type="biblio" href="#biblio-appmanifest">[APPMANIFEST]</a>. The syntax for the directive’s name
  and value is described by the following ABNF:</p>
<pre>directive-name  = "manifest-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-6">serialized-source-list</a>
</pre>
    <div class="example" id="example-165f453d">
     <a class="self-link" href="#example-165f453d"></a> Given a page with the following Content Security Policy:
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src-3">manifest-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>manifest-src</code>'s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-6">source list</a>:</p>
<pre>&lt;link rel="manifest" href="https://not-example.com/manifest">
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.6.1" id="manifest-src-algorithms"><span class="secno">6.1.6.1. </span><span class="content">Algorithms</span><a class="self-link" href="#manifest-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-6">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-34">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is "<code>manifest</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-15">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-7">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-35">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is "<code>manifest</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-16">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.7" id="directive-media-src"><span class="secno">6.1.7. </span><span class="content"><code>media-src</code></span><a class="self-link" href="#directive-media-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="media-src" data-noexport="" id="media-src">media-src<span class="dfn-panel" data-deco=""><b><a href="#media-src">#media-src</a></b><b>Referenced in:</b><span><a href="#ref-for-media-src-1">6.1.3. default-src</a> <a href="#ref-for-media-src-2">(2)</a></span><span><a href="#ref-for-media-src-3">6.1.7. media-src</a></span></span></dfn> directive restricts the URLs from which video, audio,
  and associated text track resources may be loaded. The syntax for the
  directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "media-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-7">serialized-source-list</a>
</pre>
    <div class="example" id="example-557d9dba">
     <a class="self-link" href="#example-557d9dba"></a> Given a page with the following Content Security Policy:
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#media-src" id="ref-for-media-src-3">media-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>media-src</code>'s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-7">source list</a>:</p>
<pre>&lt;audio src="https://not-example.com/audio">&lt;/audio>
&lt;video src="https://not-example.com/video">
    &lt;track kind="subtitles" src="https://not-example.com/subtitles">
&lt;/video>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.7.1" id="media-src-algorithms"><span class="secno">6.1.7.1. </span><span class="content">Algorithms</span><a class="self-link" href="#media-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-7">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-36">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is one of "<code>audio</code>", "<code>video</code>",
  or "<code>track</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-17">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-8">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-37">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is one of "<code>audio</code>", "<code>video</code>",
  or "<code>track</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-18">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.8" id="directive-object-src"><span class="secno">6.1.8. </span><span class="content"><code>object-src</code></span><a class="self-link" href="#directive-object-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="object-src" data-noexport="" id="object-src">object-src<span class="dfn-panel" data-deco=""><b><a href="#object-src">#object-src</a></b><b>Referenced in:</b><span><a href="#ref-for-object-src-1">6.
    Content Security Policy のディレクティブ </a></span><span><a href="#ref-for-object-src-2">6.1.3. default-src</a> <a href="#ref-for-object-src-3">(2)</a></span><span><a href="#ref-for-object-src-4">6.1.8. object-src</a></span></span></dfn> directive restricts the URLs from which plugin
  content may be loaded. The syntax for the directive’s name and value is
  described by the following ABNF:</p>
<pre>directive-name  = "object-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-8">serialized-source-list</a>
</pre>
    <div class="example" id="example-3469e20e">
     <a class="self-link" href="#example-3469e20e"></a> Given a page with the following Content Security Policy:
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#object-src" id="ref-for-object-src-4">object-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>object-src</code>'s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-8">source list</a>:</p>
<pre>&lt;embed src="https://not-example.com/flash">&lt;/embed>
&lt;object data="https://not-example.com/flash">&lt;/object>
&lt;applet archive="https://not-example.com/flash">&lt;/applet>
</pre>
    </div>
    <p>If plugin content is loaded without an associated URL (perhaps an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a></code> element lacks a <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/embedded-content.html#attr-object-data">data</a></code> attribute, but loads some default plugin based
  on the specified <code>type</code>), it MUST be blocked if <code>object-src</code>'s value is <code>'none'</code>, but will otherwise be allowed.</p>
    <p class="note" role="note">Note: The <code>object-src</code> directive acts upon any request made on behalf of
  an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element">embed</a></code>, or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element">applet</a></code> element. This includes requests
  which would populate the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing context</a> generated by the
  former two (also including navigations). This is true even when the data is
  semantically equivalent to content which would otherwise be restricted by
  another directive, such as an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a></code> element with a <code>text/html</code> MIME
  type.</p>
    <h5 class="heading settled" data-level="6.1.8.1" id="object-src-algorithms"><span class="secno">6.1.8.1. </span><span class="content">Algorithms</span><a class="self-link" href="#object-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-8">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-38">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>unknown</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-19">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-9">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-39">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>unknown</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-20">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.9" id="directive-script-src"><span class="secno">6.1.9. </span><span class="content"><code>script-src</code></span><a class="self-link" href="#directive-script-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="script-src" data-noexport="" id="script-src">script-src<span class="dfn-panel" data-deco=""><b><a href="#script-src">#script-src</a></b><b>Referenced in:</b><span><a href="#ref-for-script-src-1">6.
    Content Security Policy のディレクティブ </a></span><span><a href="#ref-for-script-src-2">6.1.
    Fetch ディレクティブ群 </a></span><span><a href="#ref-for-script-src-3">6.1.3. default-src</a> <a href="#ref-for-script-src-4">(2)</a> <a href="#ref-for-script-src-5">(3)</a></span></span></dfn> directive restricts the locations from which scripts
  may be executed. This includes not only URLs loaded directly into <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> elements, but also things like inline script blocks and XSLT stylesheets <a data-link-type="biblio" href="#biblio-xslt">[XSLT]</a> which can trigger script execution. The syntax for the directive’s
  name and value is described by the following ABNF:</p>
<pre>directive-name  = "script-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-9">serialized-source-list</a>
</pre>
    <p>The <code>script-src</code> directive governs four things:</p>
    <ol>
     <li data-md="">
      <p>Script <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> MUST pass through <a href="#should-block-request">§4.1.3 request は Content Security Policy によってブロックされるべきか？</a>.</p>
     <li data-md="">
      <p>Script <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">responses</a> MUST pass through <a href="#should-block-response">§4.1.4 request に対する response は Content Security Policy によってブロックされるべきか？</a>.</p>
     <li data-md="">
      <p>Inline <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> blocks MUST pass through <a href="#should-block-inline">§4.2.3 element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？</a>. Their
  behavior will be blocked unless every policy allows inline script, either
  implicitly by not specifying a <code>script-src</code> (or <code>default-src</code>) directive,
  or explicitly, by whitelisting "<code>unsafe-inline</code>", a <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source-2">nonce-source</a> or a <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source-2">hash-source</a> that matches
  the inline block.</p>
     <li data-md="">
      <p>The following JavaScript execution sinks are gated on the "<code>unsafe-eval</code>"
  source expression:</p>
      <ul>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a></code></p>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-function-objects">Function()</a></code></p>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-settimeout">setTimeout()</a></code> with an initial argument which is not callable.</p>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-setinterval">setInterval()</a></code> with an initial argument which is not callable.</p>
      </ul>
      <p class="note" role="note">Note: If a user agent implements non-standard sinks like <code>setImmediate()</code> or <code>execScript()</code>, they SHOULD also be gated on "<code>unsafe-eval</code>".</p>
    </ol>
    <h5 class="heading settled" data-level="6.1.9.1" id="script-src-algorithms"><span class="secno">6.1.9.1. </span><span class="content">Algorithms</span><a class="self-link" href="#script-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-9">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-40">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>script</code>", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>subresource</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-21">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-10">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-41">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>script</code>", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>subresource</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-22">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check-2">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>) and a string (<var>type</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>type</var> is "<code>script</code>" or "<code>script attribute</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-element-to-source-list">§6.1.12.1 Does element match source list?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-23">value</a>, and <var>type</var> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization-2">initialization</a> algorithm is as follows:</p>
    <p class="issue" id="issue-2b1bf0aa"><a class="self-link" href="#issue-2b1bf0aa"></a> Do something interesting to the execution context in order to lock down <code>eval()</code>, et al. I don’t think ECMA gives us any hooks here, so let’s work
  with them to put something reasonable together.</p>
    <h4 class="heading settled" data-level="6.1.10" id="directive-style-src"><span class="secno">6.1.10. </span><span class="content"><code>style-src</code></span><a class="self-link" href="#directive-style-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="style-src" data-noexport="" id="style-src">style-src<span class="dfn-panel" data-deco=""><b><a href="#style-src">#style-src</a></b><b>Referenced in:</b><span><a href="#ref-for-style-src-1">6.1.3. default-src</a> <a href="#ref-for-style-src-2">(2)</a></span></span></dfn> directive restricts the locations from which style
  may be applied to a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>. The syntax for the directive’s name and
  value is described by the following ABNF:</p>
<pre>directive-name  = "style-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list-10">serialized-source-list</a>
</pre>
    <p>The <code>style-src</code> directive governs several things:</p>
    <ol>
     <li data-md="">
      <p>Style <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> MUST pass through <a href="#should-block-request">§4.1.3 request は Content Security Policy によってブロックされるべきか？</a>. This
  includes:</p>
      <ol>
       <li data-md="">
        <p>Stylesheet requests originating from a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a></code> element.</p>
       <li data-md="">
        <p>Stylesheet requests originating from the <a class="css" data-link-type="at-rule" href="https://drafts.csswg.org/css-cascade-4/#at-ruledef-import"><code>@import</code></a> rule.</p>
       <li data-md="">
        <p>Stylesheet requests originating from a <code>Link</code> HTTP response header
  field <a data-link-type="biblio" href="#biblio-rfc5988">[RFC5988]</a>.</p>
      </ol>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">Responses</a> to style requests MUST pass through <a href="#should-block-response">§4.1.4 request に対する response は Content Security Policy によってブロックされるべきか？</a>.</p>
     <li data-md="">
      <p>Inline <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a></code> blocks MUST pass through <a href="#should-block-inline">§4.2.3 element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？</a>. The
  styles will be blocked unless every policy allows inline style, either
  implicitly by not specifying a <code>script-src</code> (or <code>default-src</code>) directive,
  or explicitly, by whitelisting "<code>unsafe-inline</code>", a <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source-3">nonce-source</a> or a <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source-3">hash-source</a> that matches
  the inline block.</p>
     <li data-md="">
      <p>The following CSS algorithms are gated on the <code>unsafe-eval</code> source
  expression:</p>
      <ol>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#insert-a-css-rule">insert a CSS rule</a></p>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#parse-a-css-rule">parse a CSS rule</a>,</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#parse-a-css-declaration-block">parse a CSS declaration block</a></p>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#parse-a-group-of-selectors">parse a group of selectors</a></p>
      </ol>
      <p>This would include, for example, all invocations of CSSOM’s various <code>cssText</code> setters and <code>insertRule</code> methods <a data-link-type="biblio" href="#biblio-cssom">[CSSOM]</a> <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>.</p>
      <p class="issue" id="issue-ba1a0a35"><a class="self-link" href="#issue-ba1a0a35"></a> This needs to be better explained.</p>
    </ol>
    <h5 class="heading settled" data-level="6.1.10.1" id="style-src-algorithms"><span class="secno">6.1.10.1. </span><span class="content">Algorithms</span><a class="self-link" href="#style-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-10">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-42">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>style</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-24">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-11">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy" id="ref-for-policy-43">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>style</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 url は source list にマッチするか？</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-25">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check-3">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>) and a string (<var>type</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>type</var> is "<code>style</code>" or "<code>style attribute</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-element-to-source-list">§6.1.12.1 Does element match source list?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value-26">value</a>, and <var>type</var> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization-3">initialization</a> algorithm is as follows:</p>
    <p class="issue" id="issue-eba1ebc1"><a class="self-link" href="#issue-eba1ebc1"></a> Do something interesting to the execution context in order to lock down
  interesting CSSOM algorithms. I don’t think CSSOM gives us any hooks here, so
  let’s work with them to put something reasonable together.</p>
    <h4 class="heading settled" data-level="6.1.11" id="fetch-directive-matching-url"><span class="secno">6.1.11. </span><span class="content">URL のマッチングアルゴリズム</span><a class="self-link" href="#fetch-directive-matching-url"></a></h4>
    <h5 class="heading settled" data-algorithm="request はpolicy に違反するか？" data-level="6.1.11.1" id="does-request-violate-policy"><span class="secno">6.1.11.1. </span><span class="content"> <var>request</var> は<var>policy</var> に違反するか？ </span><a class="self-link" href="#does-request-violate-policy"></a></h5>
    <p>ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) と <a data-link-type="dfn" href="#policy" id="ref-for-policy-44">policy</a> (<var>policy</var>) に対し、このアルゴリズムはリクエストによって違反を受けたポリシーを返し、違反を受けたポリシーがなければ "<code>Does Not Violate</code>" を返します。</p>
    <ol>
     <li data-md="">
      <p><var>violates</var> に "<code>Does Not Violate</code>" を代入します。</p>
     <li data-md="">
      <p><var>policy</var> に含まれる <var>directive</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p><var>request</var> と <var>policy</var> に対して <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-11">pre-request check</a> を実行し、その結果を <var>result</var> に代入します。</p>
       <li data-md="">
        <p>ここで <var>result</var> が "<code>Blocked</code>" だった場合、<var>violates</var> に <var>directive</var> を代入します。</p>
      </ol>
     <li data-md="">
      <p><var>violates</var> を返します。</p>
    </ol>
    <h5 class="heading settled" data-algorithm="url は source list にマッチするか？" data-level="6.1.11.2" id="match-url-to-source-list"><span class="secno">6.1.11.2. </span><span class="content"> <var>url</var> は <var>source list</var> にマッチするか？ </span><a class="self-link" href="#match-url-to-source-list"></a></h5>
    <p>ある <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> (<var>url</var>) と <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-9">source list</a> (<var>source list</var>) に対するこのアルゴリズムは、<var>source list</var> に含まれる source expressions の 1 つ以上に URL がマッチすれば "<code>Matches</code>" を返し、それ以外の場合は "<code>Does Not Match</code>" を返します。</p>
    <ol>
     <li data-md="">
      <p>ここで <var>source list</var> が <code>null</code> だった場合、"<code>Matches</code>" を返します。</p>
     <li data-md="">
      <p>ここで、文字列 "<code>'none'</code>" に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> する単一の要素が <var>source list</var> に含まれていた場合、"<code>Does Not Match</code>" を返します。</p>
     <li data-md="">
      <p><var>source list</var> に含まれる要素 <var>expression</var> のそれぞれについて以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで <var>url</var> と <var>expression</var> に対して <a href="#match-url-to-source-expression">§6.1.11.3 redirect count を持つ origin において url は expression にマッチするか？</a> を適用し、その実行結果が "<code>Matches</code>" であれば "<code>Matches</code>" を返します。</p>
      </ol>
     <li data-md="">
      <p>"<code>Does Not Match</code>" を返します。</p>
    </ol>
    <h5 class="heading settled" data-algorithm="redirect count を持つ origin において url は expression にマッチするか？" data-level="6.1.11.3" id="match-url-to-source-expression"><span class="secno">6.1.11.3. </span><span class="content"> <var>redirect count</var> を持つ <var>origin</var> において <var>url</var> は <var>expression</var> にマッチするか？ </span><a class="self-link" href="#match-url-to-source-expression"></a></h5>
    <p>ある <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> (<var>url</var>) と <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression-2">source expression</a> (<var>expression</var>) と <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a> (<var>origin</var>) と数値 (<var>redirect count</var>) に対し、このアルゴリズムは <var>url</var> が <var>expression</var> にマッチすれば "<code>Matches</code>" を返し、それ以外の場合は "<code>Does Not Match</code>" を返します。</p>
    <p class="note" role="note">Note: <var>origin</var> とは、<var>expression</var> が相対的に解決されるべきリソースの <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a> です。例えば、"<code>'self'</code>" はコンテキストによって別々の意味を持つことになります。</p>
    <ol>
     <li data-md="">
      <p>ここで <var>expression</var> が文字列 "*" であり、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a> ではない場合、"<code>Matches</code>" を返します。</p>
     <li data-md="">
      <p>ここで <var>expression</var> が <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source-2"><code>scheme-source</code></a> または <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source-2"><code>host-source</code></a> の文法に一致する場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで、<var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> する <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part-2"><code>scheme-part</code></a> を <var>expression</var> が持たず、かつ以下の条件をいずれも満たさない場合、"<code>Does Not Match</code>" を返します。</p>
        <ol>
         <li data-md="">
          <p><var>expression</var> の <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part-3"><code>scheme-part</code></a> が "<code>http</code>" に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> し、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>https</code>" である</p>
         <li data-md="">
          <p><var>expression</var> の <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part-4"><code>scheme-part</code></a> が "<code>ws</code>" に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> し、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>wss</code>" である</p>
        </ol>
       <li data-md="">
        <p>ここで <var>expression</var> が <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source-3"><code>scheme-source</code></a> の文法に一致する場合、"<code>Matches</code>" を返します。</p>
      </ol>
      <p class="note" role="note">Note: この処理が鍵となり、<code>script-src http:</code> が <code>script-src http: https:</code> と等しく、<code>script-src http://example.com/</code> が <code>script-src http://example.com https://example.com</code> と等しくなります。つまり、明示的に書かれた安全でない式を、安全な式へ自動変換することが常に可能となります。</p>
     <li data-md="">
      <p>ここで <var>expression</var> が <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source-3"><code>host-source</code></a> の文法に一致する場合、以下を実行します。</p>
      <ol>
       <li data-md="">
        <p>ここで <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> が <code>null</code> である場合、"<code>Does Not Match</code>" を返します。</p>
       <li data-md="">
        <p>ここで <var>expression</var> に <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part-5"><code>scheme-part</code></a> がなく、かつ以下の条件をいずれも満たさない場合に "<code>Does Not Match</code>" を返します。</p>
        <ol>
         <li data-md="">
          <p><var>origin</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> に等しい</p>
         <li data-md="">
          <p><var>origin</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>http</code>" であり、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>https</code>"、"<code>ws</code>"、"<code>wss</code>" のいずれかである</p>
         <li data-md="">
          <p><var>origin</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>https</code>" であり、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>wss</code>" である</p>
        </ol>
        <p class="note" role="note">Note: 先程の <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part-6"><code>scheme-part</code></a> に関する処理と同様に、source expression がスキームを持たない <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source-4"><code>host-source</code></a> であれば、安全なスキームへ自動変換することが可能です。</p>
       <li data-md="">
        <p>ここで <var>expression</var> の <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part-2"><code>host-part</code></a> における先頭文字が U+002A ASTERISK 文字 (<code>*</code>) だった場合、以下を実行します。</p>
        <ol>
         <li data-md="">
          <p><var>expression</var> から先頭の "<code>*</code>" を取り除いた結果を <var>remaining</var> に代入します。</p>
         <li data-md="">
          <p>ここで（先頭に U+002E FULL STOP 文字 (<code>.</code>) を含む）<var>remaining</var> が、<var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> における最右端の文字列に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> する場合、"<code>Does Not Match</code>" を返します。</p>
        </ol>
       <li data-md="">
        <p>ここで <var>expression</var> の <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part-3"><code>host-part</code></a> における先頭文字が U+002A ASTERISK 文字 (<code>*</code>) ではなく、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> が <var>expression</var> の <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part-4"><code>host-part</code></a> に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> しない場合、"<code>Does Not Match</code>" を返します。</p>
       <li data-md="">
        <p>ここで <var>expression</var> の <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part-5"><code>host-part</code></a> が <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.2.2">IPv4address</a> の文法 <a data-link-type="biblio" href="#biblio-rfc3986">[RFC3986]</a> に一致し、かつ "<code>127.0.0.1</code>" ではない場合、または <var>expression</var> の <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part-6"><code>host-part</code></a> が <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-ipv6">IPv6 address</a> の文法に一致する場合、"<code>Does Not Match</code>" を返します。</p>
        <p class="note" role="note">Note: 将来の仕様では、利用の度合いと要望に応じて IPv6 と IPv4 のアドレスリテラルが使えるようになるかもしれません。とはいえ、名前ベースのホストと比較して IP アドレスのセキュリティ特性は弱いため、Web サイトの管理者は可能な限り後者を用いることが推奨されます。</p>
       <li data-md="">
        <p>ここで <var>expression</var> に <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part-2"><code>port-part</code></a> が含まれておらず、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-port">port</a></code> が <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> に対する <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port">default port</a> ではない場合、"<code>Does Not Match</code>" を返します。</p>
       <li data-md="">
        <p>ここで <var>expression</var> に <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part-3"><code>port-part</code></a> が含まれる場合、以下を実行します。</p>
        <ol>
         <li data-md="">
          <p>ここで <var>expression</var> の <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part-4"><code>port-part</code></a> が "<code>*</code>" ではなく、かつ <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-port">port</a></code> に等しくなければ "<code>Does Not Match</code>" を返します。</p>
        </ol>
       <li data-md="">
        <p>ここで <var>expression</var> に空でない <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part-2"><code>path-part</code></a> が含まれており、かつ <var>redirect count</var> が 0 である場合、以下を実行します。</p>
        <ol>
         <li data-md="">
          <p>ここで <var>expression</var> の <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part-3"><code>path-part</code></a> における末尾文字が U+002F SOLIDUS 文字 (<code>/</code>) である場合、<var>exact match</var> に <code>false</code> を代入し、それ以外の場合は <code>true</code> を代入します。</p>
         <li data-md="">
          <p><var>expression</var> の <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part-4"><code>path-part</code></a> を U+002F SOLIDUS 文字 (<code>/</code>) で <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">strictly splitting</a> した結果を <var>path list</var> に代入します。</p>
         <li data-md="">
          <p>ここで <var>path list</var> が <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-path">path</a></code> よりも多くの要素を含んでいる場合、"<code>Does Not Match</code>" を返します。</p>
         <li data-md="">
          <p>ここで <var>exact match</var> が <code>true</code> であり、かつ <var>path list</var> が <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-path">path</a></code> と同じ要素数を含む場合、"<code>Does Not Match</code>" を返します。</p>
         <li data-md="">
          <p><var>path list</var> に含まれる <var>expression piece</var> のそれぞれについて以下を実行します。</p>
          <ol>
           <li data-md="">
            <p><var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-path">path</a></code> における次の要素を <var>url piece</var> に代入します。</p>
           <li data-md="">
            <p><var>expression piece</var> を <a data-link-type="dfn" href="https://url.spec.whatwg.org/#percent-decode">Percent decode</a> します。</p>
           <li data-md="">
            <p><var>url piece</var> を <a data-link-type="dfn" href="https://url.spec.whatwg.org/#percent-decode">Percent decode</a> します。</p>
           <li data-md="">
            <p>ここで <var>expression piece</var> が <var>url piece</var> に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> で一致しない場合、"<code>Does Not Match</code>" を返します。</p>
          </ol>
        </ol>
       <li data-md="">
        <p>"<code>Matches</code>" を返します。</p>
      </ol>
     <li data-md="">
      <p>ここで <var>expression</var> が "<code>'self'</code>" に <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> し、かつ以下の条件のうち 1 つ以上を満たすならば "<code>Matches</code>" を返します。</p>
      <ol>
       <li data-md="">
        <p><var>origin</var> が <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-origin">origin</a></code> に等しい場合</p>
       <li data-md="">
        <p><var>origin</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> が <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> に等しく、かつ <var>origin</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-port">port</a></code> が <var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-port">port</a></code> か <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> の <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port">default ports</a> に等しく、かつ以下の条件のうちどちらかを満たす</p>
        <ol>
         <li data-md="">
          <p><var>url</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>https</code>" または "<code>wss</code>" である</p>
         <li data-md="">
          <p><var>origin</var> の <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> が "<code>http</code>" である</p>
        </ol>
      </ol>
      <p class="note" role="note">Note: 先程の <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part-7"><code>scheme-part</code></a> に関する処理と同様に、"<code>'self'</code>" のマッチングアルゴリズムにおける安全なスキームへの自動変換は、その変換が安全である限り可能です。この変換は、特定のスキームに対するデフォルトポートか、保護されたリソースのオリジンにおけるポートかで動作しているエンドポイントに限られます。とはいえ、この制限があったとしても、変換が成り立つケースは十分にカバーされるはずです。</p>
     <li data-md="">
      <p>"<code>Does Not Match</code>" を返します。</p>
    </ol>
    <h5 class="heading settled" data-algorithm="request の effective directive を得る" data-level="6.1.11.4" id="effective-directive-for-a-request"><span class="secno">6.1.11.4. </span><span class="content"> <var>request</var> の effective directive を得る </span><a class="self-link" href="#effective-directive-for-a-request"></a></h5>
    <p>各 <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives-3">fetch directive</a> は <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> のタイプを制御します。ある <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) に対し、このアルゴリズムは <code>null</code> を返すか、リクエストの <dfn data-dfn-for="request" data-dfn-type="dfn" data-noexport="" id="request-effective-directive">effective directive<a class="self-link" href="#request-effective-directive"></a></dfn> における <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name-6">name</a> を返します。</p>
    <ol>
     <li data-md="">
      <p><var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> に対応する処理を以下から実行します。</p>
      <dl>
       <dt data-md="">
        <p>""</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> が "<code>fetch</code>" だった場合、<code>connect-src</code> を返します。</p>
         <li data-md="">
          <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> が "<code>manifest</code>" だった場合、<code>manifest-src</code> を返します。</p>
         <li data-md="">
          <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> が "<code>subresource</code>" だった場合、<code>connect-src</code> を返します。</p>
         <li data-md="">
          <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> が "<code>unknown</code>" だった場合、<code>object-src</code> を返します。</p>
         <li data-md="">
          <p>ここで <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> が "<code>document</code>" であり、<em>かつ</em> <var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context">target browsing context</a> が <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing context</a> だった場合、<code>child-src</code> を返します。</p>
        </ol>
       <dt data-md="">
        <p>"<code>audio</code>"</p>
       <dt data-md="">
        <p>"<code>track</code>"</p>
       <dt data-md="">
        <p>"<code>video</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p><code>media-src</code> を返します。</p>
        </ol>
       <dt data-md="">
        <p>"<code>font</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p><code>font-src</code> を返します。</p>
        </ol>
       <dt data-md="">
        <p>"<code>image</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p><code>image-src</code> を返します。</p>
        </ol>
       <dt data-md="">
        <p>"<code>style</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p><code>style-src</code> を返します。</p>
        </ol>
       <dt data-md="">
        <p>"<code>script</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p><var>request</var> の <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> に対応する処理を以下から実行します。</p>
          <dl>
           <dt data-md="">
            <p>"<code>subresource</code>"</p>
           <dd data-md="">
            <ol>
             <li data-md="">
              <p><code>script-src</code> を返します。</p>
            </ol>
           <dt data-md="">
            <p>"<code>serviceworker</code>"</p>
           <dt data-md="">
            <p>"<code>sharedworker</code>"</p>
           <dt data-md="">
            <p>"<code>worker</code>"</p>
           <dd data-md="">
            <ol>
             <li data-md="">
              <p><code>child-src</code> を返します。</p>
            </ol>
          </dl>
        </ol>
      </dl>
     <li data-md="">
      <p><code>null</code> を返します。</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.12" id="fetch-directive-matching-element"><span class="secno">6.1.12. </span><span class="content">Element Matching Algorithms</span><a class="self-link" href="#fetch-directive-matching-element"></a></h4>
    <h5 algorthm="" class="heading settled" data-level="6.1.12.1" id="match-element-to-source-list"><span class="secno">6.1.12.1. </span><span class="content"> Does <var>element</var> match source <var>list</var>? </span><a class="self-link" href="#match-element-to-source-list"></a></h5>
    <p>Given an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>), a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists-10">source list</a> (<var>list</var>), and a string
  (<var>type</var>), this algorithm returns "<code>Matches</code>" or "<code>Does Not Match</code>".</p>
    <ol>
     <li data-md="">
      <p>Let <var>contains nonce or hash</var> be <code>false</code>.</p>
     <li data-md="">
      <p>For each <var>expression</var> in <var>list</var>:</p>
      <ol>
       <li data-md="">
        <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source-4"><code>nonce-source</code></a> or <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source-4"><code>hash-source</code></a> grammar, set <var>contains nonce or hash</var> to <code>true</code>.</p>
      </ol>
     <li data-md="">
      <p>If <var>contains nonce or hash</var> is <code>false</code>, and <var>list</var> contains a <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression-3">source expression</a> which is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> match for
  the string "<code>unsafe-inline</code>", then return "<code>Matches</code>".</p>
     <li data-md="">
      <p>If <var>type</var> is not "<code>script attribute</code>" or "<code>style attribute</code>":</p>
      <ol>
       <li data-md="">
        <p>If <var>type</var> is "<code>script</code>" and <var>element</var> has an attribute whose name is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for the string "<code>&lt;script</code>", or <var>type</var> is "<code>style</code>" and <var>element</var> has an attribute whose name is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for the string "<code>&lt;style</code>", then return "<code>Does Not Match</code>".</p>
       <li data-md="">
        <p>Let <var>content</var> be <a data-link-type="dfn" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-block&apos;s-source">the script block’s source</a> if <var>element</var> is a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> element, or the value of <var>element</var>’s <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#dom-node-textcontent">textContent</a></code> IDL attribute for any other element.</p>
       <li data-md="">
        <p>For each <var>expression</var> in <var>list</var>:</p>
        <ol>
         <li data-md="">
          <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source-5"><code>nonce-source</code></a> grammar,
  and <var>element</var> has a <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/#attr-script-nonce">nonce</a></code> attribute whose value is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> match for <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value-3"><code>base64-value</code></a> part, return "<code>Matches</code>".</p>
         <li data-md="">
          <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source-5"><code>hash-source</code></a> grammar:</p>
          <ol>
           <li data-md="">
            <p>Let <var>algorithm</var> be <code>null</code>.</p>
           <li data-md="">
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm-2"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for "sha256", set <var>algorithm</var> to <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-256</a>.</p>
           <li data-md="">
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm-3"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for "sha384", set <var>algorithm</var> to <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-384</a>.</p>
           <li data-md="">
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm-4"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for "sha512", set <var>algorithm</var> to <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-512</a>.</p>
           <li data-md="">
            <p>If <var>algorithm</var> is not <code>null</code>:</p>
            <ol>
             <li data-md="">
              <p>Let <var>actual</var> be the result of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-4">base64 encoding</a> the
  result of applying <var>algorithm</var> to <var>content</var>.</p>
             <li data-md="">
              <p>If <var>actual</var> is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> match for <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value-4"><code>base64-value</code></a> part, return
  "<code>Matches</code>".</p>
            </ol>
          </ol>
        </ol>
      </ol>
     <li data-md="">
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h3 class="heading settled" data-level="6.2" id="directives-reporting"><span class="secno">6.2. </span><span class="content"> Reporting Directives </span><a class="self-link" href="#directives-reporting"></a></h3>
    <p>Various algorithms in this document hook into the reporting process by
  constructing a <a data-link-type="dfn" href="#violation" id="ref-for-violation-17">violation</a> object via <a href="#create-violation-for-request">§2.3.2 request、policy、directive に対する violation オブジェクトの生成</a> or <a href="#create-violation-for-global">§2.3.1 global、policy、directive に対する violation オブジェクトの生成</a>, and passing that object to <a href="#report-violation">§5.3 violation を報告する</a> to deliver the report.</p>
    <h4 class="heading settled" data-level="6.2.1" id="directive-report-uri"><span class="secno">6.2.1. </span><span class="content"><code>report-uri</code></span><a class="self-link" href="#directive-report-uri"></a></h4>
    <div class="note" role="note">
      Note: The <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri-3"><code>report-uri</code></a> directive is deprecated. Please use the <a data-link-type="dfn" href="#report-to" id="ref-for-report-to-3"><code>report-to</code></a> directive instead. If the latter directive is present,
    this directive will be ignored. To ensure backwards compatibility, we
    suggest specifying both, like this:
     <div class="example" id="example-9d2ef57e">
      <a class="self-link" href="#example-9d2ef57e"></a>
<pre><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy-6">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri-4">report-uri</a> https://endpoint.com; <a data-link-type="dfn" href="#report-to" id="ref-for-report-to-4">report-to</a> groupname
</pre>
     </div>
    </div>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="report-uri" data-noexport="" id="report-uri"><code>report-uri</code><span class="dfn-panel" data-deco=""><b><a href="#report-uri">#report-uri</a></b><b>Referenced in:</b><span><a href="#ref-for-report-uri-1">5.2.
    violation を廃止された方法でシリアライズしたものを取得する </a></span><span><a href="#ref-for-report-uri-2">5.3.
    violation を報告する </a></span><span><a href="#ref-for-report-uri-3">6.2.1. report-uri</a> <a href="#ref-for-report-uri-4">(2)</a></span></span></dfn> directive defines a set of endpoints to which <a data-link-type="dfn" href="#violation-report" id="ref-for-violation-report-1">violation reports</a> will be sent when particular behaviors are prevented.</p>
<pre>directive-name  = "report-uri"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a> )

; The <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a> grammar is defined in Section 4.1 of RFC 3986.
</pre>
    <p>The directive has no effect in and of itself, but only gains meaning in
  combination with other directives.</p>
    <h4 class="heading settled" data-level="6.2.2" id="directive-report-to"><span class="secno">6.2.2. </span><span class="content"><code>report-to</code></span><a class="self-link" href="#directive-report-to"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="report-to" data-noexport="" id="report-to"><code>report-to</code><span class="dfn-panel" data-deco=""><b><a href="#report-to">#report-to</a></b><b>Referenced in:</b><span><a href="#ref-for-report-to-1">5.3.
    violation を報告する </a> <a href="#ref-for-report-to-2">(2)</a></span><span><a href="#ref-for-report-to-3">6.2.1. report-uri</a> <a href="#ref-for-report-to-4">(2)</a></span></span></dfn> directive defines a <a data-link-type="dfn" href="https://mikewest.github.io/error-reporting/#group">reporting
  group</a> to which violation reports ought to be sent <a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a>. The
  directive’s behavior is defined in <a href="#report-violation">§5.3 violation を報告する</a>. The directive’s name
  and value are described by the following ABNF:</p>
<pre>directive-name  = "report-to"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6">token</a>
</pre>
    <h3 class="heading settled" data-level="6.3" id="directives-elsewhere"><span class="secno">6.3. </span><span class="content"> 他の文書で定義されるディレクティブ </span><a class="self-link" href="#directives-elsewhere"></a></h3>
    <p>この文書では主要なディレクティブを定義しており、また他の仕様書によってモジュール的に拡張できるような枠組みを整備しています。この文書が作成された時点で、CSP を拡張する文書として安定しているものは以下の通りです。</p>
    <ul>
     <li data-md="">
      <p><a data-link-type="biblio" href="#biblio-mix">[MIX]</a> では <code>block-all-mixed-content</code> を定義しています</p>
     <li data-md="">
      <p><a data-link-type="biblio" href="#biblio-upgrade-insecure-requests">[UPGRADE-INSECURE-REQUESTS]</a> では <code>upgrade-insecure-requests</code> を定義しています</p>
     <li data-md="">
      <p><a data-link-type="biblio" href="#biblio-csp-document">[CSP-DOCUMENT]</a> では <code>base-uri</code>、<code>form-action</code>、<code>frame-ancestors</code>、<code>plugin-types</code>、<code>sandbox</code> を定義しています。</p>
    </ul>
    <p>CSP を拡張する際は <a href="https://tools.ietf.org/html/draft-west-webappsec-csp-reg">draft-west-webappsec-csp-reg</a> で説明されている手続きに従って内容を登録しなければなりません（MUST）。特に、その文書の 3.2 章で議論されている要件には注意してください。</p>
    <p>Fetch や HTML と連携できるよう、新しいディレクティブは <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check-12">pre-request check</a> と <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check-12">post-request check</a>、<a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization-4">initialization</a> の各フックを用いるべきです（SHOULD）。</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="security-considerations"><span class="secno">7. </span><span class="content">セキュリティに関して考慮すべき事項</span><a class="self-link" href="#security-considerations"></a></h2>
    <h3 class="heading settled" data-level="7.1" id="security-nonces"><span class="secno">7.1. </span><span class="content">nonce の再利用</span><a class="self-link" href="#security-nonces"></a></h3>
    <p>ディレクティブに nonce が指定されている場合、そのディレクティブで指定された他の制限を nonce で回避することが可能です。従って、nonce を推定できないように維持することが肝心であり、さもないとリソースに適用されたポリシーを容易に回避できてしまいます。</p>
    <p>サーバが <a data-link-type="dfn" href="#policy" id="ref-for-policy-45">policy</a> の一部として <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source-6">nonce-source</a> を伝達する場合、サーバはポリシーを送信するごとに固有な値を生成しなければなりません（MUST）。生成された値は（エンコーディング前で）最低 128 ビット 以上の長さを持つべきです（SHOULD）。また、攻撃者による値の予想を困難にするため、値の生成方法は暗号論的に安全な乱数生成器を用いるべきです（SHOULD）。</p>
    <p>補足: インラインのスクリプトやスタイルをホワイトリスト化するために nonce を用いてしまうと、nonce を使わない場合よりも安全性が失われます。なぜなら、nonce を指定したディレクティブの制限を nonce によって回避できるからです。その nonce の値を知っている攻撃者は、任意のタイミングで任意のスクリプトを実行できてしまいます。しかしながら、既存のコードの上に Content Security Policy を構築する場合、<a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline-2">'unsafe-inline'</a> を用いるよりも nonce のほうが防御策として価値があります。もしあなたが開発者として <a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline-3">'unsafe-inline'</a> の利用を検討している場合、代わりに nonce （またはハッシュ値）を用いることを推奨します。</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="authoring-considerations"><span class="secno">8. </span><span class="content">利用に関して考慮すべき事項</span><a class="self-link" href="#authoring-considerations"></a></h2>
    <h3 class="heading settled" data-level="8.1" id="multiple-policies"><span class="secno">8.1. </span><span class="content"> 複数のポリシーによる影響 </span><a class="self-link" href="#multiple-policies"></a></h3>
    <p><em>この章は非規範的です。</em></p>
    <p>複数のポリシーが提示された際の挙動については、それぞれを種類に応じて適用・報告しなければならない旨を以前の章で述べました。これが実際にどう動作すべきなのか明確にするため、以下に例を示します。以下の HTTP ヘッダを送出する Web サイトを考えた際、様々な理由で <code>XMLHttpRequest</code> の動作が分かりにくくなるかもしれません。</p>
    <div class="example" id="example-ef0bfc7a">
     <a class="self-link" href="#example-ef0bfc7a"></a>
<pre>Content-Security-Policy: default-src 'self' http://example.com http://example.net;
                         connect-src 'none';
Content-Security-Policy: connect-src http://example.com/;
                         script-src http://example.com/
</pre>
    </div>
    <p>example.com へのアクセスは許可されるでしょうか？端的に言えば「許可されない」が答えとなります。両方のポリシーが適用されるため、もしその接続が許可されるのであれば、両方のポリシーを無事に通り抜けることが必要となるでしょう。2 番目のポリシーはこの接続を許可しています。とはいえ、1 番目のポリシーには <code>connect-src 'none'</code> が含まれているため、これが適用されて接続はブロックされます。複数のポリシーによる影響として、新たなポリシーを適用した場合は、保護されたリソースの能力を制限すること<em>のみ</em>が可能であるといえます。</p>
    <p>さらに詳しく説明するため、このページに script タグがあった場合を考えます。1 番目のポリシーは <code>default-src</code> ディレクティブの指定により、スクリプトの読込元を <code>'self'</code> と <code>http://example.com</code> と <code>http://example.net</code> に制限します。しかし、2 番目のポリシーでは <code>http://example.com</code> のスクリプトを許可しています。ここで、スクリプトは両方のポリシーの要件を満たした場合にのみ読み込まれます。すなわち、今回の場合でマッチするオリジンは、両方のポリシーが許可している <code>http://example.com</code> のみとなります。</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="implementation-considerations"><span class="secno">9. </span><span class="content">実装に関して考慮すべき事項</span><a class="self-link" href="#implementation-considerations"></a></h2>
    <h3 class="heading settled" data-level="9.1" id="extensions"><span class="secno">9.1. </span><span class="content">ベンダー独自の拡張機能やアドオン</span><a class="self-link" href="#extensions"></a></h3>
    <p>リソースに適用された <a data-link-type="dfn" href="#policy" id="ref-for-policy-46">policy</a> は、ユーザエージェントの機能（アドオン、拡張機能、ブックマークレットなど）の動作に干渉するべきではありません（SHOULD NOT）。<a data-link-type="biblio" href="#biblio-html-design">[HTML-DESIGN]</a> で提唱されている通り、一般にこれらの機能によって Web ページの作成者よりもユーザが優先されます。</p>
    <p>加えて、このような機能に CSP を適用してしまうと、大量の違反レポートがノイズのように発生し、開発者から見た CSP の価値を大きく下げてしまいます。</p>
    <p>例えば Chrome の場合、CSP の検査項目から <code>chrome-extension:</code> スキームを除くことが一定の役割を果たします。すなわちページのポリシーに関係なく、拡張機能からコンテンツを注入できることが保障されます。</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10. </span><span class="content">IANA に関して考慮すべき事項</span><a class="self-link" href="#iana-considerations"></a></h2>
    <p>permanent message header field のレジストリは、以下の登録手続きによって更新されるはずです。<a data-link-type="biblio" href="#biblio-rfc3864">[RFC3864]</a></p>
    <h3 class="heading settled" data-level="10.1" id="iana-csp"><span class="secno">10.1. </span><span class="content"> Content-Security-Policy </span><a class="self-link" href="#iana-csp"></a></h3>
    <dl>
     <dt>Header field name
     <dd>Content-Security-Policy
     <dt>Applicable protocol
     <dd>http
     <dt>Status
     <dd>standard
     <dt>Author/Change controller
     <dd>W3C
     <dt>Specification document
     <dd>This specification (See <a href="#csp-header">§3.1 Content-Security-Policy HTTP レスポンスヘッダフィールド</a>)
    </dl>
   </section>
   <section>
    <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">謝辞</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>偉大なる多くの方々</p>
   </section>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a>
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#grammardef-base64-value">base64-value</a><span>, in §2.2.1</span>
   <li>
    blockedURI
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-blockeduri">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-blockeduri">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#child-src">child-src</a><span>, in §6.1.1</span>
   <li><a href="#violation-column-number">column number</a><span>, in §2.3</span>
   <li>
    columnNumber
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-columnnumber">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-columnnumber">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#connect-src">connect-src</a><span>, in §6.1.2</span>
   <li><a href="#content-security-policy">Content-Security-Policy</a><span>, in §3.1</span>
   <li><a href="#content-security-policy-report-only">Content-Security-Policy-Report-Only</a><span>, in §3.2</span>
   <li><a href="#global-object-csp-list">CSP list</a><span>, in §4.2</span>
   <li><a href="#default-src">default-src</a><span>, in §6.1.3</span>
   <li><a href="#grammardef-directive-name">directive-name</a><span>, in §2.2</span>
   <li><a href="#directives">directives</a><span>, in §2.2</span>
   <li>
    directive set
    <ul>
     <li><a href="#policy-directive-set">dfn for policy</a><span>, in §2.1</span>
     <li><a href="#policy-directive-set0">dfn for policy</a><span>, in §2.1</span>
    </ul>
   <li><a href="#grammardef-directive-value">directive-value</a><span>, in §2.2</span>
   <li><a href="#policy-disposition">disposition</a><span>, in §2.1</span>
   <li>
    documentURI
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-documenturi">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-documenturi">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li>
    effectiveDirective
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-effectivedirective">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-effectivedirective">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li>
    effective directive
    <ul>
     <li><a href="#violation-effective-directive">dfn for violation</a><span>, in §2.3</span>
     <li><a href="#request-effective-directive">dfn for request</a><span>, in §6.1.11.4</span>
    </ul>
   <li><a href="#embedding-document">embedding document</a><span>, in §4.2</span>
   <li><a href="#enforced">enforced</a><span>, in §4.2</span>
   <li><a href="#fetch-directives">Fetch directives</a><span>, in §6.1</span>
   <li><a href="#font-src">font-src</a><span>, in §6.1.4</span>
   <li><a href="#violation-global-object">global object</a><span>, in §2.3</span>
   <li><a href="#grammardef-hash-algorithm">hash-algorithm</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-hash-source">hash-source</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-host-char">host-char</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-host-part">host-part</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-host-source">host-source</a><span>, in §2.2.1</span>
   <li><a href="#img-src">img-src</a><span>, in §6.1.5</span>
   <li><a href="#directive-initialization">initialization</a><span>, in §2.2</span>
   <li><a href="#directive-inline-check">inline check</a><span>, in §2.2</span>
   <li><a href="#grammardef-keyword-source">keyword-source</a><span>, in §2.2.1</span>
   <li><a href="#violation-line-number">line number</a><span>, in §2.3</span>
   <li>
    lineNumber
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-linenumber">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-linenumber">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#manifest-src">manifest-src</a><span>, in §6.1.6</span>
   <li><a href="#matches-a-source-list">matches a source list</a><span>, in §2.2.1</span>
   <li><a href="#media-src">media-src</a><span>, in §6.1.7</span>
   <li><a href="#monitored">monitored</a><span>, in §4.2</span>
   <li><a href="#directive-name">name</a><span>, in §2.2</span>
   <li><a href="#grammardef-nonce-source">nonce-source</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-none">'none'</a><span>, in §2.2.1</span>
   <li><a href="#object-src">object-src</a><span>, in §6.1.8</span>
   <li>
    originalPolicy
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-originalpolicy">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-originalpolicy">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#parse-serialized-policy">parse a serialized CSP</a><span>, in §2.1</span>
   <li><a href="#grammardef-path-part">path-part</a><span>, in §2.2.1</span>
   <li><a href="#policy">policies</a><span>, in §2.1</span>
   <li>
    policy
    <ul>
     <li><a href="#policy">definition of</a><span>, in §2.1</span>
     <li><a href="#violation-policy">dfn for violation</a><span>, in §2.3</span>
    </ul>
   <li><a href="#grammardef-port-part">port-part</a><span>, in §2.2.1</span>
   <li><a href="#directive-post-request-check">post-request check</a><span>, in §2.2</span>
   <li><a href="#directive-pre-request-check">pre-request check</a><span>, in §2.2</span>
   <li>
    referrer
    <ul>
     <li><a href="#violation-referrer">dfn for violation</a><span>, in §2.3</span>
     <li><a href="#dom-securitypolicyviolationevent-referrer">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-referrer">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#report-to">report-to</a><span>, in §6.2.2</span>
   <li><a href="#report-uri">report-uri</a><span>, in §6.2.1</span>
   <li><a href="#violation-resource">resource</a><span>, in §2.3</span>
   <li><a href="#directive-response-check">response check</a><span>, in §2.2</span>
   <li><a href="#grammardef-scheme-part">scheme-part</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-scheme-source">scheme-source</a><span>, in §2.2.1</span>
   <li><a href="#script-src">script-src</a><span>, in §6.1.9</span>
   <li><a href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a><span>, in §5.3</span>
   <li><a href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
   <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">SecurityPolicyViolationEvent(type)</a><span>, in §5.1</span>
   <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">SecurityPolicyViolationEvent(type, eventInitDict)</a><span>, in §5.1</span>
   <li><a href="#grammardef-self">'self'</a><span>, in §2.2.1</span>
   <li><a href="#serialized-csp">serialized CSP</a><span>, in §2.1</span>
   <li><a href="#grammardef-serialized-directive">serialized-directive</a><span>, in §2.2</span>
   <li><a href="#serialized-directive">serialized directive</a><span>, in §2.2</span>
   <li><a href="#grammardef-serialized-policy">serialized-policy</a><span>, in §2.1</span>
   <li><a href="#serialized-source-list">serialized source list</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-serialized-source-list">serialized-source-list</a><span>, in §2.2.1</span>
   <li><a href="#source-expression">source expression</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-source-expression">source-expression</a><span>, in §2.2.1</span>
   <li><a href="#violation-source-file">source file</a><span>, in §2.3</span>
   <li>
    sourceFile
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-sourcefile">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-sourcefile">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#source-lists">source lists</a><span>, in §2.2.1</span>
   <li><a href="#violation-status">status</a><span>, in §2.3</span>
   <li>
    statusCode
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-statuscode">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-statuscode">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#style-src">style-src</a><span>, in §6.1.10</span>
   <li><a href="#grammardef-unsafe-eval">'unsafe-eval'</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-unsafe-inline">'unsafe-inline'</a><span>, in §2.2.1</span>
   <li><a href="#violation-url">url</a><span>, in §2.3</span>
   <li><a href="#directive-value">value</a><span>, in §2.2</span>
   <li>
    violatedDirective
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-violateddirective">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-violateddirective">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#violation">violation</a><span>, in §2.3</span>
   <li><a href="#violation-report">violation report</a><span>, in §5</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio" href="#biblio-cssom">[cssom]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/cssom/#insert-a-css-rule">insert a css rule</a>
     <li><a href="http://www.w3.org/TR/cssom/#parse-a-css-declaration-block">parse a css declaration block</a>
     <li><a href="http://www.w3.org/TR/cssom/#parse-a-css-rule">parse a css rule</a>
     <li><a href="http://www.w3.org/TR/cssom/#parse-a-group-of-selectors">parse a group of selectors</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-whatwg-dom">[WHATWG-DOM]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/dom/#interface-element">Element</a>
     <li><a href="http://www.w3.org/TR/dom/#dom-node-textcontent">textContent</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-es2015">[ES2015]</a> defines the following terms:
    <ul>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-function-objects">Function()</a>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-json.stringify">JSON.stringify()</a>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-body">body</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-cache-mode">cache mode</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode">credentials mode</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-csp-list">csp list</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-current-url">current url</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-fetch">fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-global-object">global object</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>
     <li><a href="https://fetch.spec.whatwg.org/#http-fetch">http fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#http-network-fetch">http-network fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a>
     <li><a href="https://fetch.spec.whatwg.org/#main-fetch">main fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-method">method</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-network-error">network error</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-origin">origin</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-parse">parse a header value</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode">redirect mode</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request">request</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response">response</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context">target browsing context</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-type">type</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-url">url</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-window">window</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy">content-security-policy http-equiv processing instructions</a>
     <li><a href="https://html.spec.whatwg.org/#initialising-a-new-document-object">initialising a new document object</a>
     <li><a href="https://html.spec.whatwg.org/#attr-script-nonce">nonce</a>
     <li><a href="https://html.spec.whatwg.org/#ping">ping</a>
     <li><a href="https://html.spec.whatwg.org/#run-a-worker">run a worker</a>
     <li><a href="https://html.spec.whatwg.org/#the-workers-documents">the worker's documents</a>
     <li><a href="https://html.spec.whatwg.org/#update-a-style-block">update a style block</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html5">[html5]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/html5/dom.html#document">Document</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#dom-window">Window</a>
     <li><a href="http://www.w3.org/TR/html5/text-level-semantics.html#the-a-element">a</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#active-document">active document</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe srcdoc document</a>
     <li><a href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element">applet</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ascii case-insensitive match</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#browsing-context">browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters">collect a sequence of characters</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a>
     <li><a href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">csp list</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#dom-document-2">document</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element">embed</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-fire">fire</a>
     <li><a href="http://www.w3.org/TR/html5/obsolete.html#frame">frame</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#browsing-context-nested-through">nested through</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#opener-browsing-context">opener browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/scripting-1.html#prepare-a-script">prepare a script</a>
     <li><a href="http://www.w3.org/TR/html5/dom.html#dom-document-referrer">referrer</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings object</a>
     <li><a href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#space-characters">space characters</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-commas">split a string on commas</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-spaces">split a string on spaces</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">strictly split a string</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace">strip leading and trailing whitespace</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a>
     <li><a href="http://www.w3.org/TR/html5/scripting-1.html#the-script-block&apos;s-source">the script block's source</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-trusted">trusted</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a> defines the following terms:
    <ul>
     <li><a href="https://mikewest.github.io/error-reporting/#group">group</a>
     <li><a href="https://mikewest.github.io/error-reporting/#queue-report">queue report</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc3986">[rfc3986]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.2.2">ipv4address</a>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc4648">[rfc4648]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc4648#section-4">base64 encoding</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc5234">[rfc5234]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">alpha</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">digit</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">vchar</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc6454">[rfc6454]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc7230">[rfc7230]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.3">ows</a>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.3">rws</a>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.6">token</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc7231">[rfc7231]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7231#section-3">representation</a>
     <li><a href="https://tools.ietf.org/html/rfc7231#section-3">resource representation</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-service-workers">[service-workers]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/service-workers/#service-worker-interface">ServiceWorker</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-sha2">[SHA2]</a> defines the following terms:
    <ul>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-256</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-384</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-512</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-whatwg-url">[WHATWG-URL]</a> defines the following terms:
    <ul>
     <li><a href="https://url.spec.whatwg.org/#url">URL</a>
     <li><a href="https://url.spec.whatwg.org/#default-port">default port</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-host">host</a>
     <li><a href="https://url.spec.whatwg.org/#concept-ipv6">ipv6 address</a>
     <li><a href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-origin">origin</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-path">path</a>
     <li><a href="https://url.spec.whatwg.org/#percent-decode">percent decode</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-port">port</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-parser">url parser</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-serializer">url serializer</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-workers">[workers]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/workers/#worker">Worker</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-css-cascade-4">[css-cascade-4]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-cascade-4/#at-ruledef-import">@import</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-whatwg-dom">[WHATWG-DOM]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker">SharedWorker</a>
     <li><a href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#attr-object-data">data</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-setinterval">setInterval()</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-settimeout">setTimeout()</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-cascade-4">[CSS-CASCADE-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="http://dev.w3.org/csswg/css-cascade/">CSS Cascading and Inheritance Level 4</a>. 14 January 2016. CR. URL: <a href="http://dev.w3.org/csswg/css-cascade/">http://dev.w3.org/csswg/css-cascade/</a>
   <dt id="biblio-cssom">[CSSOM]
   <dd>Simon Pieters; Glenn Adams. <a href="http://www.w3.org/TR/cssom/">CSS Object Model (CSSOM)</a>. 5 December 2013. WD. URL: <a href="http://www.w3.org/TR/cssom/">http://www.w3.org/TR/cssom/</a>
   <dt id="biblio-es2015">[ES2015]
   <dd>Allen Wirfs-Brock. <a href="http://www.ecma-international.org/ecma-262/6.0/index.html">ECMAScript® 2015 Language Specification</a>. URL: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html">http://www.ecma-international.org/ecma-262/6.0/index.html</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-html5">[HTML5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-oob-reporting">[OOB-REPORTING]
   <dd>Ilya Gregorik; Mike West. <a href="https://mikewest.github.io/error-reporting/">Out-of-band Reporting</a>. URL: <a href="https://mikewest.github.io/error-reporting/">https://mikewest.github.io/error-reporting/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>. September 2004. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc3864">https://tools.ietf.org/html/rfc3864</a>
   <dt id="biblio-rfc3986">[RFC3986]
   <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>. January 2005. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a>
   <dt id="biblio-rfc4648">[RFC4648]
   <dd>S. Josefsson. <a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>. October 2006. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-rfc5988">[RFC5988]
   <dd>M. Nottingham. <a href="https://tools.ietf.org/html/rfc5988">Web Linking</a>. October 2010. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5988">https://tools.ietf.org/html/rfc5988</a>
   <dt id="biblio-rfc6454">[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-rfc7230">[RFC7230]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7230">https://tools.ietf.org/html/rfc7230</a>
   <dt id="biblio-rfc7231">[RFC7231]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Alex Russell; Jungkee Song; Jake Archibald. <a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/">Service Workers</a>. 25 June 2015. WD. URL: <a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/">https://slightlyoff.github.io/ServiceWorker/spec/service_worker/</a>
   <dt id="biblio-sha2">[SHA2]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4, Secure Hash Standard</a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-whatwg-dom">[WHATWG-DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-whatwg-url">[WHATWG-URL]
   <dd>Anne van Kesteren; Sam Ruby. <a href="https://url.spec.whatwg.org/">URL Standard</a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-workers">[WORKERS]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/workers.html">Web Workers</a>. 24 September 2015. WD. URL: <a href="https://html.spec.whatwg.org/multipage/workers.html">https://html.spec.whatwg.org/multipage/workers.html</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-appmanifest">[APPMANIFEST]
   <dd>Marcos Caceres; et al. <a href="http://www.w3.org/TR/appmanifest/">Web App Manifest</a>. 27 January 2016. WD. URL: <a href="http://www.w3.org/TR/appmanifest/">http://www.w3.org/TR/appmanifest/</a>
   <dt id="biblio-beacon">[BEACON]
   <dd>Ilya Grigorik; et al. <a href="http://www.w3.org/TR/beacon/">Beacon</a>. 25 February 2016. WD. URL: <a href="http://www.w3.org/TR/beacon/">http://www.w3.org/TR/beacon/</a>
   <dt id="biblio-csp-document">[CSP-DOCUMENT]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-csp/document/">Content Security Policy: Document Features</a>. URL: <a href="https://w3c.github.io/webappsec-csp/document/">https://w3c.github.io/webappsec-csp/document/</a>
   <dt id="biblio-csp2">[CSP2]
   <dd>Mike West; Adam Barth; Daniel Veditz. <a href="http://www.w3.org/TR/CSP2/">Content Security Policy Level 2</a>. 21 July 2015. CR. URL: <a href="http://www.w3.org/TR/CSP2/">http://www.w3.org/TR/CSP2/</a>
   <dt id="biblio-eventsource">[EVENTSOURCE]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/eventsource/">Server-Sent Events</a>. 3 February 2015. REC. URL: <a href="http://www.w3.org/TR/eventsource/">http://www.w3.org/TR/eventsource/</a>
   <dt id="biblio-html-design">[HTML-DESIGN]
   <dd>Anne Van Kesteren; Maciej Stachowiak. <a href="http://www.w3.org/TR/html-design-principles/">HTML Design Principles</a>. URL: <a href="http://www.w3.org/TR/html-design-principles/">http://www.w3.org/TR/html-design-principles/</a>
   <dt id="biblio-mix">[MIX]
   <dd>Mike West. <a href="http://www.w3.org/TR/mixed-content/">Mixed Content</a>. 8 October 2015. CR. URL: <a href="http://www.w3.org/TR/mixed-content/">http://www.w3.org/TR/mixed-content/</a>
   <dt id="biblio-timing">[TIMING]
   <dd>Paul Stone. <a href="http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf">Pixel Perfect Timing Attacks with HTML5</a>. URL: <a href="http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf">http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf</a>
   <dt id="biblio-upgrade-insecure-requests">[UPGRADE-INSECURE-REQUESTS]
   <dd>Mike West. <a href="http://www.w3.org/TR/upgrade-insecure-requests/">Upgrade Insecure Requests</a>. 8 October 2015. CR. URL: <a href="http://www.w3.org/TR/upgrade-insecure-requests/">http://www.w3.org/TR/upgrade-insecure-requests/</a>
   <dt id="biblio-websockets">[WEBSOCKETS]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/websockets/">The WebSocket API</a>. 20 September 2012. CR. URL: <a href="http://www.w3.org/TR/websockets/">http://www.w3.org/TR/websockets/</a>
   <dt id="biblio-xhr">[XHR]
   <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/">XMLHttpRequest Standard</a>. Living Standard. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
   <dt id="biblio-xslt">[XSLT]
   <dd>James Clark. <a href="http://www.w3.org/TR/xslt">XSL Transformations (XSLT) Version 1.0</a>. 16 November 1999. REC. URL: <a href="http://www.w3.org/TR/xslt">http://www.w3.org/TR/xslt</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def">[<a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">Constructor</a>(DOMString <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type">type</a>, optional <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a> <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict">eventInitDict</a>)]
interface <a class="idl-code" data-link-type="interface" href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a> : <a data-link-type="idl-name">Event</a> {
    readonly    attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-securitypolicyviolationevent-documenturi">documentURI</a>;
    readonly    attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-securitypolicyviolationevent-referrer">referrer</a>;
    readonly    attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-securitypolicyviolationevent-blockeduri">blockedURI</a>;
    readonly    attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-securitypolicyviolationevent-violateddirective">violatedDirective</a>;
    readonly    attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-securitypolicyviolationevent-effectivedirective">effectiveDirective</a>;
    readonly    attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-securitypolicyviolationevent-originalpolicy">originalPolicy</a>;
    readonly    attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-securitypolicyviolationevent-sourcefile">sourceFile</a>;
    readonly    attribute unsigned short <a data-readonly="" data-type="unsigned short " href="#dom-securitypolicyviolationevent-statuscode">statusCode</a>;
    readonly    attribute long           <a data-readonly="" data-type="long           " href="#dom-securitypolicyviolationevent-linenumber">lineNumber</a>;
    readonly    attribute long           <a data-readonly="" data-type="long           " href="#dom-securitypolicyviolationevent-columnnumber">columnNumber</a>;
};

dictionary <a href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a> {
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-documenturi">documentURI</a>;
    DOMString      <a data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-referrer">referrer</a>;
    DOMString      <a data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-blockeduri">blockedURI</a>;
    DOMString      <a data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-violateddirective">violatedDirective</a>;
    DOMString      <a data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-effectivedirective">effectiveDirective</a>;
    DOMString      <a data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-originalpolicy">originalPolicy</a>;
    DOMString      <a data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-sourcefile">sourceFile</a>;
    unsigned short <a data-type="unsigned short " href="#dom-securitypolicyviolationeventinit-statuscode">statusCode</a>;
    long           <a data-type="long           " href="#dom-securitypolicyviolationeventinit-linenumber">lineNumber</a>;
    long           <a data-type="long           " href="#dom-securitypolicyviolationeventinit-columnnumber">columnNumber</a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> <code>frame-src</code> を本当に削除したほうがいいのでしょうか？Worker とフレームの脅威モデルは似ていますが、それらの上で実行できる内容は異なります。もしかすると、Worker と フレームのどちらか一方のみを許可するほうが良いのかもしれません。<a href="#issue-beb745b1"> ↵ </a></div>
   <div class="issue"> <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> の内側で <code>sandbox</code> を有効にできるのでしょうか？このサポートを打ち切った場合に考慮すべき脅威はまだ明確に分かっていません（今日現在、Chrome と Safari ではサポートされています）。<a href="#issue-ce23d45e"> ↵ </a></div>
   <div class="issue"> 報告の際に値を取り除く必要はまだあるのでしょうか？ブロックされたリソースにおける元々の URL を用いることで、そのリスクはほとんど排除されたと考えています。つまり、スクリプトが DOM を走査しても、レポートの JSON に含まれている自分自身の情報は何も収集できないはずです。<a href="#issue-1dba5599"> ↵ </a></div>
   <div class="issue"> <a href="https://lists.w3.org/Archives/Public/public-webappsec/2016Feb/0048.html"><code>'unsafe-dynamic'</code></a> を追加すべきでしょうか？<a href="#issue-39406a5f"> ↵ </a></div>
   <div class="issue"> ハッシュ値によるインラインイベントハンドラのホワイトリスト化を可能にすべきでしょうか？ <a href="https://github.com/w3c/webappsec-csp/issues/13">&lt;https://github.com/w3c/webappsec-csp/issues/13></a><a href="#issue-88485c04"> ↵ </a></div>
   <div class="issue"> このような処理は他でも行われているでしょうか？この処理 は <a data-link-type="biblio" href="#biblio-es2015">[ES2015]</a>　で効果的に用いられていますが、それ以外の例をまだ知りません。<a href="#issue-0e2d0de4"> ↵ </a></div>
   <div class="issue"> ステータスコードを正確に得るにはどうすれば良いのでしょうか？実際、このステータスコードはどこにも保存されません。<a href="#issue-6510dc05"> ↵ </a></div>
   <div class="issue"> 制限を緩めて <code>sandbox</code> も利用可にできるでしょうか？<a href="#issue-44b673d0"> ↵ </a></div>
   <div class="issue"> W3C’s HTML で定義されるアルゴリズム "creating a new <code>Document</code> object" は、Fetch との相性が良くありません。<a href="#issue-ba1e08e5"> ↵ </a></div>
   <div class="issue"> ここで、"document を生成する際に用いられたリソースの <code>CSP list</code> を <code>Window</code> オブジェクトの <code>CSP list</code> に代入する" といったモンキーパッチが必要です。<a href="#issue-dd85eabd"> ↵ </a></div>
   <div class="issue"> アルゴリズム <a data-link-type="dfn" href="https://html.spec.whatwg.org/#update-a-style-block">update a <code>style</code> block</a> は W3C’s HTML には存在しません。<a href="#issue-f87a8865"> ↵ </a></div>
   <div class="issue"> <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> と <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a></code> の <code>nonce</code> 属性が WHATWG’s HTML に追加されました（<a href="https://github.com/whatwg/html/commit/882803c4cc8fba2fa5472b76f628d95cc82c421d">whatwg/html@882803c</a>）。しかし、まだ W3C’s HTML には追加されていません。<a href="#issue-d00ffd43"> ↵ </a></div>
   <div class="issue"> <a href="#should-block-inline">§4.2.3 element においてインラインの type に関する挙動は Content Security Policy によってブロックされるべきか？</a> のフックが WHATWG’s HTML に追加されました（<a href="https://github.com/whatwg/html/commit/ee3486eb129bc350b5ca684d0c91dff23453ac1a">whatwg/html@ee3486e</a>）。しかし、まだ W3C’s HTML には追加されていません。<a href="#issue-5cab039f"> ↵ </a></div>
   <div class="issue"> このフックは現在 WHATWG’s HTML で検討中です。 <a href="https://github.com/WHATWG/html/issues/384">&lt;https://github.com/WHATWG/html/issues/384></a><a href="#issue-64efaac2"> ↵ </a></div>
   <div class="issue"> この処理は WHATWG’s HTML に追加されました（<a href="https://github.com/whatwg/html/commit/5064a629f22bef29839ab4dc6f1ceef17f010bc5">whatwg/html@5064a62</a>）。しかし、まだ W3C’s HTML には追加されていません。<a href="#issue-689f5c62"> ↵ </a></div>
   <div class="issue"> TODO.<a href="#issue-95f2d23a"> ↵ </a></div>
   <div class="issue"> TODO.<a href="#issue-95f2d23a0"> ↵ </a></div>
   <div class="issue"> Do something interesting to the execution context in order to lock down <code>eval()</code>, et al. I don’t think ECMA gives us any hooks here, so let’s work
  with them to put something reasonable together.<a href="#issue-2b1bf0aa"> ↵ </a></div>
   <div class="issue"> This needs to be better explained.<a href="#issue-ba1a0a35"> ↵ </a></div>
   <div class="issue"> Do something interesting to the execution context in order to lock down
  interesting CSSOM algorithms. I don’t think CSSOM gives us any hooks here, so
  let’s work with them to put something reasonable together.<a href="#issue-eba1ebc1"> ↵ </a></div>
  </div>
<script>
        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            while(el.parentElement) {
                if(el.tagName == "DFN") {
                    target = "dfn";
                    break;
                }
                if(/H\d/.test(el.tagName) && el.getAttribute('data-dfn-type') != null) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn") {
                // open the panel
                var dfnPanel = el.querySelector(".dfn-panel");
                if(dfnPanel) {
                    dfnPanel.classList.add("on");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
            }

        });
        </script>
